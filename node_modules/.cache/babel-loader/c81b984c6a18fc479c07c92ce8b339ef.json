{"ast":null,"code":"import _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport React, { PureComponent, Component } from 'react';\nimport PropTypes from 'prop-types';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport _extends from '@babel/runtime/helpers/extends';\nimport ReactPlayer from 'react-player';\nimport { sanitizeUrl } from '@braintree/sanitize-url';\nimport Lightbox from 'react-images';\nimport { FileIcon, ImagePreviewer, FilePreviewer, ImageDropzone, FileUploadButton, dataTransferItemsHaveFiles, dataTransferItemsToFiles } from 'react-file-utils';\nimport prettybytes from 'pretty-bytes';\nimport _objectSpread from '@babel/runtime/helpers/objectSpread';\nimport { NimbleEmoji, emojiIndex, Picker } from 'emoji-mart';\nimport anchorme from 'anchorme';\nimport emojiRegex from 'emoji-regex';\nimport ReactMarkdown from 'react-markdown/with-html';\nimport truncate from 'lodash/truncate';\nimport data from 'emoji-mart/data/all.json';\nimport _typeof from '@babel/runtime/helpers/typeof';\nimport getCaretCoordinates from 'textarea-caret';\nimport CustomEvent from 'custom-event';\nimport Textarea from 'react-textarea-autosize';\nimport Immutable from 'seamless-immutable';\nimport { logChatPromiseExecution } from 'stream-chat';\nimport moment from 'moment';\nimport deepequal from 'deep-equal';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport uuidv4 from 'uuid/v4';\nimport Visibility from 'visibilityjs';\nimport debounce from 'lodash/debounce';\nimport throttle from 'lodash/throttle';\n/**\n * Avatar - A round avatar image with fallback to username's first letter\n *\n * @example ./docs/Avatar.md\n * @extends PureComponent\n */\n\nvar Avatar =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Avatar, _React$PureComponent);\n\n  function Avatar() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Avatar);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Avatar)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      errored: false,\n      loaded: false\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getInitials\", function (name) {\n      return name ? name.split(' ').slice(0, 1).map(function (name) {\n        return name.charAt(0);\n      }) : null;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onLoad\", function () {\n      _this.setState({\n        loaded: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onError\", function () {\n      _this.setState({\n        errored: true\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(Avatar, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.image !== this.props.image) {\n        this.setState({\n          loaded: false,\n          errored: false\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          size = _this$props.size,\n          name = _this$props.name,\n          shape = _this$props.shape,\n          image = _this$props.image;\n      var initials = this.getInitials(name);\n      return React.createElement(\"div\", {\n        className: \"str-chat__avatar str-chat__avatar--\".concat(shape),\n        title: name,\n        style: {\n          width: size,\n          height: size,\n          flexBasis: size,\n          lineHeight: size + 'px',\n          fontSize: size / 2\n        }\n      }, image && !this.state.errored ? React.createElement(\"img\", {\n        src: image,\n        alt: initials,\n        className: 'str-chat__avatar-image' + this.state.loaded ? ' str-chat__avatar-image--loaded' : '',\n        style: {\n          width: size,\n          height: size,\n          flexBasis: size,\n          objectFit: 'cover'\n        },\n        onLoad: this.onLoad,\n        onError: this.onError\n      }) : React.createElement(\"div\", {\n        className: \"str-chat__avatar-fallback\"\n      }, initials));\n    }\n  }]);\n\n  return Avatar;\n}(React.PureComponent);\n\n_defineProperty(Avatar, \"propTypes\", {\n  /** image url */\n  image: PropTypes.string,\n\n  /** name of the picture, used for title tag fallback */\n  name: PropTypes.string,\n\n  /** shape of the avatar, circle, rounded or square */\n  shape: PropTypes.oneOf(['circle', 'rounded', 'square']),\n\n  /** size in pixels */\n  size: PropTypes.number\n});\n\n_defineProperty(Avatar, \"defaultProps\", {\n  size: 32,\n  shape: 'circle'\n});\n/**\n * SafeAnchor - In all ways similar to a regular anchor tag.\n * The difference is that it sanitizes the href value and prevents XSS\n * @extends PureComponent\n */\n\n\nvar SafeAnchor =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(SafeAnchor, _React$PureComponent);\n\n  function SafeAnchor() {\n    _classCallCheck(this, SafeAnchor);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(SafeAnchor).apply(this, arguments));\n  }\n\n  _createClass(SafeAnchor, [{\n    key: \"render\",\n    value: function render() {\n      var href = sanitizeUrl(this.props.href);\n      return React.createElement(\"a\", _extends({}, this.props, {\n        href: href\n      }), this.props.children);\n    }\n  }]);\n\n  return SafeAnchor;\n}(React.PureComponent);\n\nvar giphyLogo = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAkCAYAAAB/up84AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABVhJREFUeNrsW6GS20AMdToGBgEGAQYBBgEBBQYFgQcP5hMO9jP6CYWFBwsPBgYUGBQEFAQUGAQYBBgYGHjmutt5O6NupbXXcZJrx5rJXGyv11o96Ukr52avr6/BJG9HZmMBMpvNYnxt1JzNZNoRAYFxM2Z8rT6FuueMcaH6s1KfhBn3U42r1Jg1rrfq+Bt5xgf1Z64+uQFQndNzLc1Ydfwg6F2p6wd1PVXfU+b6Gc9vHGuh8+jrsXVN61Sq64XggNw95tlH9XmP6y3W2OI+qvN3db6mN7/zBFAb8L2aNMJxRsDQC6jIuEyN039LnAvV8QJKRRijZUHmT8iiLpEFDHKJaB1TGN732WuAokEIDQCwhwGjsMEIMNgp6qY9JlsTgyXquCFG1d54IsbOsKAVPLDBcQJjUxB0RJwAltGntNQ46GhzqPnb0y0954RG/1iLQ7SRCkR+guiPtW6GFRg5gAlCrFvbJEZ0ngDAUn0/Y77fDCJFXuiB/AmGDC3PLg0YWLRW5CcJWWPglNxDKS6C59AcZBs/sYxbOQBqHHkuZYCsGCds4SQJDDx3RK3RjUb9EfMUcLQ57BHS64MAIYtYkvEt+d4wCzqr++ipkoTtkihOI2chREfA5KiC0GOAaMig05zoWJPjgMk39jxcPphDR0mSDrtq438g51iq8omQlEnYJfHoiAFxYQGko6bCPSmZ5wS+TRx0Zc5R4CtmHbEVJT+0p1uOYdNE1SMfOKNO0zXWEmItptApsfYa1LV0UZUPIHSCmlRYJhfokNWhX5IcsmIWbEAMCQWerWirhZK57MghNQyzgke3QuQWPUv4EAac9wCuJjmkNmvUNEwiobX+DgdEWoQGgNDPGtTWWhRRWONX5JlnePCZhP1JUCOzPN1O0C2MohP7xuiko8Qy9INUDBg2YPJMlzP8pRv0qYeUdu+Cy+RAKIYmtVqojM5kkS0DwkXlLuY0ICzgAEOlAd8fPe+rYJdppz61TiZ5G4AgcScWz05RcUtAkOwyJMtI4FzNt3suCWKfwLUhdqRC0yA/enB1CZ4vBZ2fhIptJ4x/5PYVavyzQ39N0V8ddnsQ+m3sfX02hjo3bIVJ7d5PhqojZxYdC3NEdv9oQMQWFFjHHqpLEsc9BZyF23c9cG0ZOJjUIN15V1mY8OOAhW0E77yWaP2eoO9VBFG/d6yX6/xuHT2z3AsQ5ImnjrZBF6XcUiKAEl0RlJzZ7ZtnbxmqSgRqfxmyD9k6wNDGzuExecB3Z1/ukBOjQH73MZbspChFp9nQ/EYY9+LaaIYOqlo7JjwISX+LcBwbjAOz2ZKS7BpOcq0o0R2HvZAbHpHPJGc+dm00paQuedmOA4O0WD5fyQ4V08Ip4ATxhYl8CCh76/0QLVyehlBVFyCpYJTcKmPjHoY8XNE2VQ8dbIkdr4Z95npBwcNVahKzNEMBSYSyz46iLm8sLunreG5O+xYTsaMUHYu6bMn79sRCT2+8l6SMV2cCT5e3UspBXbbd9n3nDIN/Q1KP3JDfWLcd8kZwCVX12hjeOlmOIMe+L6FGjJLC4QS5rz6hg/tThjZiU0Pr/g7D65/uCUafKgaUJu0lHjvox/XsjXA+GAOQUogIXV8/v7GoKOGJfYuHxvHjt7t3rEMHD2+E5PoR+5GCLCS+8g6Z2xgGt6anuwGC99MSKAl6RrfUs/ofje+b1PcjlJBlMMk4gKBUe77AqKVP/T1Jj30IQPmCTdkm6NeKb5BkJzCGdCA8XuFGZIOWCBEh/mwGiZ/rFZXk3xHEdkjHb6MknVOhypJe+Sac03XlL4fe3r81mH518q9GyCS3kV8CDADlsrVaJhTLAgAAAABJRU5ErkJggg==\";\n/**\n * Card - Simple Card Layout\n *\n * @example ./docs/Card.md\n * @extends PureComponent\n */\n\nvar Card =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Card, _React$PureComponent);\n\n  function Card() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Card);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Card)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"trimUrl\", function (url) {\n      var trimmedUrl;\n\n      if (url !== undefined || url !== null) {\n        trimmedUrl = url.replace(/^(?:https?:\\/\\/)?(?:www\\.)?/i, '').split('/')[0];\n      }\n\n      return trimmedUrl;\n    });\n\n    return _this;\n  }\n\n  _createClass(Card, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          title = _this$props.title,\n          title_link = _this$props.title_link,\n          text = _this$props.text,\n          type = _this$props.type,\n          image_url = _this$props.image_url,\n          thumb_url = _this$props.thumb_url,\n          og_scrape_url = _this$props.og_scrape_url;\n      var image = thumb_url || image_url;\n\n      if (!title && !title_link && !image) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__message-attachment-card\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__message-attachment-card--content\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__message-attachment-card--text\"\n        }, \"this content could not be displayed\")));\n      }\n\n      if (!title_link && !og_scrape_url) {\n        return null;\n      }\n\n      return React.createElement(\"div\", {\n        className: \"str-chat__message-attachment-card\"\n      }, image && React.createElement(\"div\", {\n        className: \"str-chat__message-attachment-card--header\"\n      }, React.createElement(\"img\", {\n        src: image,\n        alt: image\n      })), React.createElement(\"div\", {\n        className: \"str-chat__message-attachment-card--content\"\n      }, React.createElement(\"div\", {\n        className: \"str-chat__message-attachment-card--flex\"\n      }, title && React.createElement(\"div\", {\n        className: \"str-chat__message-attachment-card--title\"\n      }, title), text && React.createElement(\"div\", {\n        className: \"str-chat__message-attachment-card--text\"\n      }, text), (title_link || og_scrape_url) && React.createElement(SafeAnchor, {\n        href: title_link || og_scrape_url,\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        className: \"str-chat__message-attachment-card--url\"\n      }, this.trimUrl(title_link || og_scrape_url))), type === 'giphy' && React.createElement(\"img\", {\n        className: \"str-chat__message-attachment-card__giphy-logo\",\n        src: giphyLogo,\n        alt: \"giphy logo\"\n      })));\n    }\n  }]);\n\n  return Card;\n}(React.PureComponent);\n\n_defineProperty(Card, \"propTypes\", {\n  /** Title retured by the OG scraper */\n  title: PropTypes.string.isRequired,\n\n  /** Link retured by the OG scraper */\n  title_link: PropTypes.string,\n\n  /** The scraped url, used as a fallback if the OG-data doesnt include a link */\n  og_scrape_url: PropTypes.string,\n\n  /** The url of the full sized image */\n  image_url: PropTypes.string,\n\n  /** The url for thumbnail sized image*/\n  thumb_url: PropTypes.string,\n\n  /** Description retured by the OG scraper */\n  text: PropTypes.string\n});\n/**\n * Image - Small wrapper around an image tag, supports thumbnails\n *\n * @example ./docs/Image.md\n * @extends PureComponent\n */\n\n\nvar Image =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Image, _React$PureComponent);\n\n  function Image() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Image);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Image)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      isOpen: false\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"openLightbox\", function () {\n      _this.setState({\n        isOpen: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"closeLightbox\", function () {\n      _this.setState({\n        isOpen: false\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(Image, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          image_url = _this$props.image_url,\n          thumb_url = _this$props.thumb_url,\n          fallback = _this$props.fallback;\n      return React.createElement(React.Fragment, null, React.createElement(\"img\", {\n        className: \"str-chat__message-attachment--img\",\n        onClick: this.openLightbox,\n        src: thumb_url || image_url,\n        alt: fallback\n      }), React.createElement(Lightbox, {\n        isOpen: this.state.isOpen,\n        onClose: this.closeLightbox,\n        images: [{\n          src: image_url || thumb_url\n        }],\n        backdropClosesModal: true\n      }));\n    }\n  }]);\n\n  return Image;\n}(React.PureComponent);\n\n_defineProperty(Image, \"propTypes\", {\n  /** The full size image url */\n  image_url: PropTypes.string,\n\n  /** The thumb url */\n  thumb_url: PropTypes.string,\n\n  /** The text fallback for the image */\n  fallback: PropTypes.string\n});\n/**\n * AttachmentActions - The actions you can take on an attachment\n *\n * @example ./docs/AttachmentActions.md\n * @extends PureComponent\n */\n\n\nvar AttachmentActions =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(AttachmentActions, _React$PureComponent);\n\n  function AttachmentActions() {\n    _classCallCheck(this, AttachmentActions);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(AttachmentActions).apply(this, arguments));\n  }\n\n  _createClass(AttachmentActions, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      var _this$props = this.props,\n          text = _this$props.text,\n          id = _this$props.id,\n          actions = _this$props.actions,\n          actionHandler = _this$props.actionHandler;\n      return React.createElement(\"div\", {\n        className: \"str-chat__message-attachment-actions\"\n      }, React.createElement(\"form\", {\n        className: \"str-chat__message-attachment-actions-form\"\n      }, React.createElement(\"span\", {\n        key: 0\n      }, text), actions.map(function (action) {\n        return React.createElement(\"button\", {\n          className: \"str-chat__message-attachment-actions-button str-chat__message-attachment-actions-button--\".concat(action.style),\n          key: \"\".concat(id, \"-\").concat(action.value),\n          \"data-value\": action.value,\n          onClick: actionHandler.bind(_this, action.name, action.value)\n        }, action.text);\n      })));\n    }\n  }]);\n\n  return AttachmentActions;\n}(React.PureComponent);\n\n_defineProperty(AttachmentActions, \"propTypes\", {\n  // /** The id of the form input */\n  // id: PropTypes.string.isRequired,\n\n  /** The text for the form input */\n  text: PropTypes.string,\n\n  /** A list of actions */\n  actions: PropTypes.array.isRequired,\n\n  /** The handler to execute after selecting an action */\n  actionHandler: PropTypes.func.isRequired\n});\n/**\n * Attachment - The message attachment\n *\n * @example ./docs/Attachment.md\n * @extends PureComponent\n */\n\n\nvar Attachment =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(Attachment, _PureComponent);\n\n  function Attachment() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Attachment);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Attachment)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"attachmentRef\", React.createRef());\n\n    return _this;\n  }\n\n  _createClass(Attachment, [{\n    key: \"render\",\n    value: function render() {\n      var a = this.props.attachment;\n\n      if (!a) {\n        return null;\n      }\n\n      var type, extra;\n\n      if (a.actions && a.actions.length > 0) {\n        extra = 'actions';\n      }\n\n      if (a.type === 'giphy' || a.type === 'imgur') {\n        type = 'card';\n      } else if (a.type === 'image' && (a.title_link || a.og_scrape_url)) {\n        type = 'card';\n      } else if (a.type === 'image') {\n        type = 'image';\n      } else if (a.type === 'file') {\n        type = 'file';\n      } else if (a.type === 'video' || a.type === 'audio') {\n        type = 'media';\n      } else {\n        type = 'card';\n        extra = 'no-image';\n      }\n\n      if (type === 'card' && !a.title_link && !a.og_scrape_url) {\n        return null;\n      }\n\n      var results = [];\n\n      if (type === 'card') {\n        if (a.actions && a.actions.length) {\n          results.push(React.createElement(\"div\", {\n            style: {\n              maxWidth: 450\n            },\n            key: \"key-image-\".concat(a.id)\n          }, React.createElement(Card, _extends({}, a, {\n            key: \"key-card-\".concat(a.id)\n          })), React.createElement(AttachmentActions, _extends({\n            key: 'key-actions-' + a.id\n          }, a, {\n            actionHandler: this.props.actionHandler\n          }))));\n        } else {\n          results.push(React.createElement(Card, _extends({}, a, {\n            key: \"key-card-\".concat(a.id)\n          })));\n        }\n      } else if (type === 'image') {\n        if (a.actions && a.actions.length) {\n          results.push(React.createElement(\"div\", {\n            style: {\n              maxWidth: 450\n            },\n            key: \"key-image-\".concat(a.id)\n          }, React.createElement(Image, a), React.createElement(AttachmentActions, _extends({\n            key: 'key-actions-' + a.id\n          }, a, {\n            actionHandler: this.props.actionHandler\n          }))));\n        } else {\n          results.push(React.createElement(Image, _extends({}, a, {\n            key: \"key-image-\".concat(a.id)\n          })));\n        }\n      } else if (type === 'file') {\n        results.push(React.createElement(\"div\", {\n          className: \"str-chat__message-attachment-file--item\",\n          key: \"key-file-\".concat(a.id)\n        }, React.createElement(FileIcon, {\n          mimeType: a.mime_type,\n          filename: a.title,\n          big: true,\n          size: 30\n        }), React.createElement(\"div\", {\n          className: \"str-chat__message-attachment-file--item-text\"\n        }, React.createElement(SafeAnchor, {\n          href: a.asset_url,\n          download: true\n        }, a.title), a.file_size && React.createElement(\"span\", null, prettybytes(a.file_size)))));\n      } else if (type === 'media') {\n        if (a.actions && a.actions.length) {\n          results.push(React.createElement(\"div\", {\n            style: {\n              maxWidth: 450\n            },\n            key: \"key-video-\".concat(a.id)\n          }, React.createElement(\"div\", {\n            className: \"str-chat__player-wrapper\"\n          }, React.createElement(ReactPlayer, {\n            className: \"react-player\",\n            url: a.asset_url,\n            width: \"100%\",\n            height: \"100%\",\n            controls: true\n          })), React.createElement(AttachmentActions, _extends({\n            key: 'key-actions-' + a.id\n          }, a, {\n            actionHandler: this.props.actionHandler\n          }))));\n        } else {\n          results.push(React.createElement(\"div\", {\n            className: \"str-chat__player-wrapper\",\n            key: \"key-video-\".concat(a.id)\n          }, React.createElement(ReactPlayer, {\n            className: \"react-player\",\n            url: a.asset_url,\n            width: \"100%\",\n            height: \"100%\",\n            controls: true\n          })));\n        }\n      } else {\n        if (a.actions && a.actions.length) {\n          results.push(React.createElement(\"div\", {\n            style: {\n              maxWidth: 450\n            },\n            key: \"key-image-\".concat(a.id)\n          }, React.createElement(Card, _extends({}, a, {\n            key: \"key-card-\".concat(a.id)\n          })), React.createElement(AttachmentActions, _extends({\n            key: 'key-actions-' + a.id\n          }, a, {\n            actionHandler: this.props.actionHandler\n          }))));\n        } else {\n          results.push(React.createElement(Card, _extends({}, a, {\n            key: \"key-card-\".concat(a.id)\n          })));\n        }\n      }\n\n      return React.createElement(\"div\", {\n        className: \"str-chat__message-attachment str-chat__message-attachment--\".concat(type, \" str-chat__message-attachment--\").concat(type, \"--\").concat(extra),\n        ref: this.attachmentRef\n      }, results);\n    }\n  }]);\n\n  return Attachment;\n}(PureComponent);\n\n_defineProperty(Attachment, \"propTypes\", {\n  /** The attachment to render */\n  attachment: PropTypes.object.isRequired,\n\n  /**\n  The handler function to call when an action is selected on an attachment.\n  Examples include canceling a \\/giphy command or shuffling the results.\n  */\n  actionHandler: PropTypes.func.isRequired\n});\n\nAttachment.propTypes = {};\n/**\n * MessageActionsBox - A component for taking action on a message\n *\n * @example ./docs/MessageActionsBox.md\n * @extends PureComponent\n */\n\nvar MessageActionsBox =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(MessageActionsBox, _React$Component);\n\n  function MessageActionsBox() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MessageActionsBox);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MessageActionsBox)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"actionsBoxRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      reverse: false,\n      rect: null\n    });\n\n    return _this;\n  }\n\n  _createClass(MessageActionsBox, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {}\n  }, {\n    key: \"componentDidUpdate\",\n    value: function () {\n      var _componentDidUpdate = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(prevProps) {\n        var ml;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(!prevProps.open && this.props.open)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                if (!(this.state.rect === null)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _context.next = 4;\n                return this.setState({\n                  rect: this.actionsBoxRef.current.getBoundingClientRect()\n                });\n\n              case 4:\n                ml = this.props.messageListRect;\n\n                if (this.props.mine) {\n                  this.setState({\n                    reverse: this.state.rect.left < ml.left ? true : false\n                  });\n                } else if (!this.props.mine) {\n                  this.setState({\n                    reverse: this.state.rect.right + 5 > ml.right ? true : false\n                  });\n                }\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidUpdate(_x) {\n        return _componentDidUpdate.apply(this, arguments);\n      }\n\n      return componentDidUpdate;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          Message = _this$props.Message,\n          message = _this$props.message;\n      return React.createElement(\"div\", {\n        className: \"str-chat__message-actions-box\\n          \".concat(this.props.open ? 'str-chat__message-actions-box--open' : '', \"\\n          \").concat(this.props.mine ? 'str-chat__message-actions-box--mine' : '', \"\\n          \").concat(this.state.reverse ? 'str-chat__message-actions-box--reverse' : '', \"\\n        \"),\n        ref: this.actionsBoxRef\n      }, React.createElement(\"ul\", {\n        className: \"str-chat__message-actions-list\"\n      }, Message.isMyMessage && !Message.isMyMessage(message) && React.createElement(\"button\", {\n        onClick: Message.handleFlag\n      }, React.createElement(\"li\", {\n        className: \"str-chat__message-actions-list-item\"\n      }, \"Flag\")), Message.isMyMessage && !Message.isMyMessage(message) && React.createElement(\"button\", {\n        onClick: Message.handleMute\n      }, React.createElement(\"li\", {\n        className: \"str-chat__message-actions-list-item\"\n      }, \"Mute\")), Message.canEditMessage && Message.canEditMessage(message) && React.createElement(\"button\", {\n        onClick: Message.handleEdit\n      }, React.createElement(\"li\", {\n        className: \"str-chat__message-actions-list-item\"\n      }, \"Edit Message\")), Message.canDeleteMessage && Message.canDeleteMessage(message) && React.createElement(\"button\", {\n        onClick: Message.handleDelete\n      }, React.createElement(\"li\", {\n        className: \"str-chat__message-actions-list-item\"\n      }, \"Delete\"))));\n    }\n  }]);\n\n  return MessageActionsBox;\n}(React.Component);\n\n_defineProperty(MessageActionsBox, \"propTypes\", {\n  /** If the message actions box should be open or not */\n  open: PropTypes.bool.isRequired,\n\n  /** The message component, most logic is delegated to this component and MessageActionsBox uses the following functions explicitely:\n   *  `handleFlag`, `handleMute`, `handleEdit`, `handleDelete`, `canDeleteMessagec`, `anEditMessage`, `isMyMessage`, `isAdmin`\n   */\n  Message: PropTypes.oneOfType([PropTypes.node, PropTypes.func, PropTypes.object]).isRequired,\n\n  /** The message for which the action box is displayed */\n  message: PropTypes.object.isRequired\n});\n\n_defineProperty(MessageActionsBox, \"defaultProp\", {\n  open: false\n});\n\nvar emojiSetDef = {\n  spriteUrl: 'https://getstream.imgix.net/images/emoji-sprite.png',\n  size: 20,\n  sheetColumns: 2,\n  sheetRows: 3,\n  sheetSize: 64\n};\nvar commonEmoji = {\n  emoticons: [],\n  short_names: [],\n  custom: true\n};\nvar defaultMinimalEmojis = [_objectSpread({\n  id: 'like',\n  name: 'like',\n  colons: ':+1:',\n  sheet_x: 0,\n  sheet_y: 0\n}, commonEmoji, emojiSetDef), _objectSpread({\n  id: 'love',\n  name: 'love',\n  colons: ':heart:',\n  sheet_x: 1,\n  sheet_y: 2\n}, commonEmoji, emojiSetDef), _objectSpread({\n  id: 'haha',\n  name: 'haha',\n  colons: ':joy:',\n  sheet_x: 1,\n  sheet_y: 0\n}, commonEmoji, emojiSetDef), _objectSpread({\n  id: 'wow',\n  name: 'wow',\n  colons: ':astonished:',\n  sheet_x: 0,\n  sheet_y: 2\n}, commonEmoji, emojiSetDef), _objectSpread({\n  id: 'sad',\n  name: 'sad',\n  colons: ':pensive:',\n  sheet_x: 0,\n  sheet_y: 1\n}, commonEmoji, emojiSetDef), _objectSpread({\n  id: 'angry',\n  name: 'angry',\n  colons: ':angry:',\n  sheet_x: 1,\n  sheet_y: 1\n}, commonEmoji, emojiSetDef)];\nvar d = Object.assign({}, data);\nd.emojis = {}; // use this only for small lists like in ReactionSelector\n\nvar emojiData = d;\n\nvar isOnlyEmojis = function isOnlyEmojis(text) {\n  if (!text) return false;\n  var noEmojis = text.replace(emojiRegex(), '');\n  var noSpace = noEmojis.replace(/[\\s\\n]/gm, '');\n  return !noSpace;\n};\n\nvar isPromise = function isPromise(thing) {\n  var promise = thing && typeof thing.then === 'function';\n  return promise;\n};\n\nvar byDate = function byDate(a, b) {\n  return a.created_at - b.created_at;\n}; // https://stackoverflow.com/a/29234240/7625485\n\n\nvar formatArray = function formatArray(dict) {\n  var arr2 = Object.keys(dict);\n  var arr3 = [];\n  arr2.forEach(function (item, i) {\n    return arr3.push(dict[arr2[i]].user.name || dict[arr2[i]].user.id);\n  });\n  var outStr = '';\n\n  if (arr3.length === 1) {\n    outStr = arr3[0] + ' is typing...';\n  } else if (arr3.length === 2) {\n    //joins all with \"and\" but =no commas\n    //example: \"bob and sam\"\n    outStr = arr3.join(' and ') + ' are typing...';\n  } else if (arr3.length > 2) {\n    //joins all with commas, but last one gets \", and\" (oxford comma!)\n    //example: \"bob, joe, and sam\"\n    outStr = arr3.slice(0, -1).join(', ') + ', and ' + arr3.slice(-1) + ' are typing...';\n  }\n\n  return outStr;\n};\n\nvar renderText = function renderText(message) {\n  // take the @ mentions and turn them into markdown?\n  // translate links\n  if (!message) {\n    return;\n  }\n\n  var allowed = ['html', 'root', 'text', 'break', 'paragraph', 'emphasis', 'strong', 'link', 'list', 'listItem', 'code', 'inlineCode', 'blockquote'];\n  var regex = /\\B@[a-z0-9_-]+/gim;\n  message = message.replace(regex, function (x) {\n    return \"**\".concat(x, \"**\");\n  });\n  var urls = anchorme(message, {\n    list: true\n  });\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = urls[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var urlInfo = _step.value;\n      var displayLink = truncate(urlInfo.encoded.replace(/^(www\\.)/, ''), {\n        length: 20,\n        omission: '...'\n      });\n      var mkdown = \"[\".concat(displayLink, \"](\").concat(urlInfo.raw, \")\");\n      message = message.replace(urlInfo.raw, mkdown);\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return React.createElement(ReactMarkdown, {\n    allowedTypes: allowed,\n    source: message,\n    linkTarget: \"_blank\",\n    plugins: [],\n    escapeHtml: true,\n    skipHtml: false\n  });\n}; // https://stackoverflow.com/a/6860916/2570866\n\n\nfunction generateRandomId() {\n  // prettier-ignore\n  return S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4();\n}\n\nfunction S4() {\n  return ((1 + Math.random()) * 0x10000 | 0).toString(16).substring(1);\n}\n\nvar ReactionsList =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ReactionsList, _React$Component);\n\n  function ReactionsList(props) {\n    var _this;\n\n    _classCallCheck(this, ReactionsList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReactionsList).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_renderReactions\", function (reactions) {\n      var reactionsByType = {};\n      reactions.map(function (item) {\n        if (reactions[item.type] === undefined) {\n          return reactionsByType[item.type] = [item];\n        } else {\n          return reactionsByType[item.type] = [].concat(_toConsumableArray(reactionsByType[item.type]), [item]);\n        }\n      });\n\n      var reactionsEmojis = _this.props.reactionOptions.reduce(function (acc, cur) {\n        return _objectSpread({}, acc, _defineProperty({}, cur.id, cur));\n      }, {});\n\n      return Object.keys(reactionsByType).map(function (type) {\n        return reactionsEmojis[type] ? React.createElement(\"li\", {\n          key: reactionsEmojis[type].id\n        }, React.createElement(NimbleEmoji, _extends({\n          emoji: reactionsEmojis[type]\n        }, emojiSetDef, {\n          size: 16,\n          data: emojiData\n        })), ' ', \"\\xA0\") : null;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_getReactionCount\", function () {\n      var reaction_counts = _this.props.reaction_counts;\n      var count = null;\n\n      if (reaction_counts !== null && reaction_counts !== undefined && Object.keys(reaction_counts).length > 0) {\n        count = 0;\n        Object.keys(reaction_counts).map(function (key) {\n          return count += reaction_counts[key];\n        });\n      }\n\n      return count;\n    });\n\n    _this.state = {\n      reverse: false\n    };\n    _this.reactionList = React.createRef();\n    return _this;\n  }\n\n  _createClass(ReactionsList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.mine && this.reactionList && this.props.messageList) {\n        this.setState({\n          reverse: this.reactionList.current.getBoundingClientRect().right + 100 > this.props.messageList.right ? true : false\n        });\n      } else if (!this.props.mine && this.reactionList && this.props.messageList) {\n        this.setState({\n          reverse: this.reactionList.current.getBoundingClientRect().left - 45 < this.props.messageList.left ? true : false\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"str-chat__reaction-list \".concat(this.state.reverse ? 'str-chat__reaction-list--reverse' : ''),\n        onClick: this.props.onClick,\n        ref: this.reactionList\n      }, React.createElement(\"ul\", null, this._renderReactions(this.props.reactions), React.createElement(\"li\", null, React.createElement(\"span\", {\n        className: \"str-chat__reaction-list--counter\"\n      }, this._getReactionCount()))));\n    }\n  }]);\n\n  return ReactionsList;\n}(React.Component);\n\n_defineProperty(ReactionsList, \"propTypes\", {\n  reactions: PropTypes.array,\n\n  /** Provide a list of reaction options [{name: 'angry', emoji: 'angry'}] */\n  reactionOptions: PropTypes.array\n});\n\n_defineProperty(ReactionsList, \"defaultProps\", {\n  reactionOptions: defaultMinimalEmojis,\n  emojiSetDef: emojiSetDef\n});\n\nvar Tooltip =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Tooltip, _React$PureComponent);\n\n  function Tooltip() {\n    _classCallCheck(this, Tooltip);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Tooltip).apply(this, arguments));\n  }\n\n  _createClass(Tooltip, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"str-chat__tooltip\"\n      }, this.props.children);\n    }\n  }]);\n\n  return Tooltip;\n}(React.PureComponent);\n/**\n * LoadingIndicator - Just a simple loading spinner..\n *\n * @example ./docs/LoadingIndicator.md\n * @extends PureComponent\n */\n\n\nvar LoadingIndicator =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(LoadingIndicator, _React$PureComponent);\n\n  function LoadingIndicator() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, LoadingIndicator);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(LoadingIndicator)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"stopRef\", React.createRef());\n\n    return _this;\n  }\n\n  _createClass(LoadingIndicator, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          size = _this$props.size,\n          color = _this$props.color;\n      return React.createElement(\"div\", {\n        className: 'str-chat__loading-indicator ' + color,\n        style: {\n          width: size,\n          height: size\n        }\n      }, React.createElement(\"svg\", {\n        width: size,\n        height: size,\n        viewBox: \"0 0 30 30\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"defs\", null, React.createElement(\"linearGradient\", {\n        x1: \"50%\",\n        y1: \"0%\",\n        x2: \"50%\",\n        y2: \"100%\",\n        id: \"a\"\n      }, React.createElement(\"stop\", {\n        stopColor: \"#FFF\",\n        stopOpacity: \"0\",\n        offset: \"0%\"\n      }), React.createElement(\"stop\", {\n        ref: this.stopRef,\n        offset: \"100%\",\n        stopColor: color,\n        stopOpacity: \"1\",\n        style: {\n          stopColor: color\n        }\n      }))), React.createElement(\"path\", {\n        d: \"M2.518 23.321l1.664-1.11A12.988 12.988 0 0 0 15 28c7.18 0 13-5.82 13-13S22.18 2 15 2V0c8.284 0 15 6.716 15 15 0 8.284-6.716 15-15 15-5.206 0-9.792-2.652-12.482-6.679z\",\n        fill: \"url(#a)\",\n        fillRule: \"evenodd\"\n      })));\n    }\n  }]);\n\n  return LoadingIndicator;\n}(React.PureComponent);\n\n_defineProperty(LoadingIndicator, \"propTypes\", {\n  /** The size of the loading icon */\n  size: PropTypes.number,\n\n  /** Set the color of the LoadingIndicator */\n  color: PropTypes.string\n});\n\n_defineProperty(LoadingIndicator, \"defaultProps\", {\n  size: 15,\n  color: '#006CFF'\n});\n/**\n * Gallery - displays up to 6 images in a simple responsive grid with a lightbox to view the images.\n * @example ./docs/Gallery.md\n * @extends PureComponent\n */\n\n\nvar Gallery =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Gallery, _React$PureComponent);\n\n  function Gallery() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Gallery);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Gallery)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      lightboxIsOpen: false,\n      imageIndex: 0\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"openLightbox\", function (i) {\n      _this.setState({\n        lightboxIsOpen: true,\n        imageIndex: i\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"closeLightbox\", function () {\n      _this.setState({\n        lightboxIsOpen: false,\n        imageIndex: 0\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"gotoPrevLightboxImage\", function () {\n      _this.setState({\n        imageIndex: _this.state.imageIndex - 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"gotoNextLightboxImage\", function () {\n      _this.setState({\n        imageIndex: _this.state.imageIndex + 1\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(Gallery, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var images = this.props.images;\n      var formattedArray = images.map(function (image) {\n        return {\n          src: image.image_url\n        };\n      });\n      return React.createElement(\"div\", {\n        className: \"str-chat__gallery\"\n      }, images.slice(0, 3).map(function (image, i) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__gallery-image\",\n          key: \"gallery-image-\".concat(i),\n          onClick: function onClick() {\n            return _this2.openLightbox(i);\n          }\n        }, React.createElement(\"img\", {\n          src: image.image_url\n        }));\n      }), images.length > 3 && React.createElement(\"div\", {\n        className: \"str-chat__gallery-placeholder\",\n        style: {\n          background: \"url(\".concat(images[3].image_url, \") top left no-repeat\"),\n          backgroundSize: 'cover'\n        },\n        onClick: function onClick() {\n          return _this2.openLightbox(3);\n        }\n      }, React.createElement(\"p\", null, images.length - 3, \" more\")), React.createElement(Lightbox, {\n        images: formattedArray,\n        isOpen: this.state.lightboxIsOpen,\n        onClickPrev: this.gotoPrevLightboxImage,\n        onClickNext: this.gotoNextLightboxImage,\n        onClose: this.closeLightbox,\n        backdropClosesModal: true,\n        currentImage: this.state.imageIndex\n      }));\n    }\n  }]);\n\n  return Gallery;\n}(React.PureComponent);\n\n_defineProperty(Gallery, \"propTypes\", {\n  images: PropTypes.array.isRequired\n});\n/**\n * ReactionSelector - A component for selecting a reaction. Examples are love, wow, like etc.\n *\n * @example ./docs/ReactionSelector.md\n * @extends PureComponent\n */\n\n\nvar ReactionSelector =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ReactionSelector, _PureComponent);\n\n  function ReactionSelector(props) {\n    var _this;\n\n    _classCallCheck(this, ReactionSelector);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReactionSelector).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"showTooltip\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(e, users) {\n        var target;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                target = e.target.getBoundingClientRect();\n                _context2.next = 3;\n                return _this.setState(function () {\n                  return {\n                    showTooltip: true,\n                    users: users\n                  };\n                },\n                /*#__PURE__*/\n                _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee() {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          _context.next = 2;\n                          return _this.setTooltipPosition(target);\n\n                        case 2:\n                          _context.next = 4;\n                          return _this.setArrowPosition(target);\n\n                        case 4:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee, this);\n                })));\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"hideTooltip\", function () {\n      _this.setState(function () {\n        return {\n          showTooltip: false,\n          users: [],\n          arrowPosition: 0,\n          position: 0,\n          positionCaculated: false\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getUsersPerReaction\", function (reactions, type) {\n      var filtered = reactions && reactions.filter(function (item) {\n        return item.type === type;\n      });\n      return filtered;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getLatestUser\", function (reactions, type) {\n      var filtered = _this.getUsersPerReaction(reactions, type);\n\n      if (filtered && filtered[0] && filtered[0].user) {\n        return filtered[0].user;\n      } else {\n        return 'NotFound';\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getUserNames\", function (reactions, type) {\n      var filtered = _this.getUsersPerReaction(reactions, type);\n\n      var users = filtered && filtered.map(function (item) {\n        return item.user || 'NotFound';\n      });\n      return users;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getContainerDimensions\", function () {\n      return _this.reactionSelector.current.getBoundingClientRect();\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getToolTipDimensions\", function () {\n      return _this.reactionSelectorTooltip.current.getBoundingClientRect();\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"setTooltipPosition\",\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(target) {\n        var container, tooltip, position;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return _this.getContainerDimensions();\n\n              case 2:\n                container = _context3.sent;\n                _context3.next = 5;\n                return _this.getToolTipDimensions();\n\n              case 5:\n                tooltip = _context3.sent;\n\n                if (tooltip.width === container.width || tooltip.x < container.x) {\n                  position = 0;\n                } else {\n                  position = target.left + target.width / 2 - container.left - tooltip.width / 2;\n                }\n\n                _context3.next = 9;\n                return _this.setState(function () {\n                  return {\n                    position: position\n                  };\n                });\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"setArrowPosition\",\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(target) {\n        var tooltip, position;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                tooltip = _this.reactionSelectorTooltip.current.getBoundingClientRect();\n                position = target.x - tooltip.x + target.width / 2;\n                _context4.next = 4;\n                return _this.setState(function () {\n                  return {\n                    arrowPosition: position,\n                    positionCaculated: true\n                  };\n                });\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      return function (_x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderReactionItems\", function () {\n      var _this$props = _this.props,\n          reaction_counts = _this$props.reaction_counts,\n          latest_reactions = _this$props.latest_reactions;\n\n      var lis = _this.props.reactionOptions.map(function (reaction) {\n        var users = _this.getUserNames(latest_reactions, reaction.id);\n\n        var latestUser = _this.getLatestUser(latest_reactions, reaction.id);\n\n        var count = reaction_counts && reaction_counts[reaction.id];\n        return React.createElement(\"li\", {\n          key: \"item-\".concat(reaction.id),\n          className: \"str-chat__message-reactions-list-item\",\n          \"data-text\": reaction.id,\n          onClick: _this.props.handleReaction.bind(_assertThisInitialized(_assertThisInitialized(_this)), reaction.id)\n        }, count && _this.props.detailedView && React.createElement(React.Fragment, null, React.createElement(\"div\", {\n          className: \"latest-user\",\n          onMouseEnter: function onMouseEnter(e) {\n            return _this.showTooltip(e, users);\n          },\n          onMouseLeave: _this.hideTooltip\n        }, latestUser !== 'NotFound' ? React.createElement(Avatar, {\n          image: latestUser.image,\n          alt: latestUser.id,\n          size: 20,\n          name: latestUser.id\n        }) : React.createElement(\"div\", {\n          className: \"latest-user-not-found\"\n        }))), React.createElement(NimbleEmoji, _extends({\n          emoji: reaction\n        }, emojiSetDef, {\n          data: emojiData\n        })), count && _this.props.detailedView && React.createElement(\"span\", {\n          className: \"str-chat__message-reactions-list-item__count\"\n        }, count || ''));\n      });\n\n      return lis;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderUsers\", function (users) {\n      return users.map(function (user, i) {\n        var text = user.name || user.id;\n\n        if (i + 1 < users.length) {\n          text += ', ';\n        }\n\n        return React.createElement(\"span\", {\n          className: \"latest-user-username\",\n          key: \"key-\".concat(i, \"-\").concat(user)\n        }, text);\n      });\n    });\n\n    _this.state = {\n      reverse: false,\n      elRect: null,\n      showTooltip: false,\n      users: [],\n      position: 0,\n      arrowPosition: 0,\n      positionCalculated: false\n    };\n    _this.reactionSelector = React.createRef();\n    _this.reactionSelectorInner = React.createRef();\n    _this.reactionSelectorTooltip = React.createRef();\n    return _this;\n  }\n\n  _createClass(ReactionSelector, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.mine && this.props.messageList && this.props.messageList.right <= this.reactionSelector.current.getBoundingClientRect().right) {\n        this.setState({\n          reverse: true\n        });\n      }\n\n      if (!this.props.mine && this.props.messageList && this.props.messageList.left >= this.reactionSelector.current.getBoundingClientRect().left) {\n        this.setState({\n          reverse: true\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"str-chat__reaction-selector \".concat(this.state.reverse ? 'str-chat__reaction-selector--reverse' : ''),\n        ref: this.reactionSelector\n      }, this.props.detailedView && React.createElement(\"div\", {\n        className: \"str-chat__reaction-selector-tooltip\",\n        ref: this.reactionSelectorTooltip,\n        style: {\n          visibility: this.state.showTooltip ? 'visible' : 'hidden',\n          left: this.state.position,\n          opacity: this.state.showTooltip && this.state.positionCaculated ? 1 : 0.01\n        }\n      }, React.createElement(\"div\", {\n        className: \"arrow\",\n        style: {\n          left: this.state.arrowPosition\n        }\n      }), this.renderUsers(this.state.users)), React.createElement(\"ul\", {\n        className: \"str-chat__message-reactions-list\"\n      }, this.renderReactionItems()));\n    }\n  }]);\n\n  return ReactionSelector;\n}(PureComponent);\n\n_defineProperty(ReactionSelector, \"propTypes\", {\n  /** Object containgin latest reactions */\n  latest_reactions: PropTypes.array.isRequired,\n\n  /** Object containing the reaction counts */\n  reaction_counts: PropTypes.object,\n\n  /** Callback to handle the reaction */\n  handleReaction: PropTypes.func.isRequired,\n\n  /** Set the direction to either left or right */\n  direction: PropTypes.oneOf(['left', 'right']),\n\n  /** Enable the avatar display */\n  detailedView: PropTypes.bool,\n\n  /** Provide a list of reaction options [{name: 'angry', emoji: 'angry'}] */\n  reactionOptions: PropTypes.array\n});\n\n_defineProperty(ReactionSelector, \"defaultProps\", {\n  direction: 'left',\n  detailedView: true,\n  reactionOptions: defaultMinimalEmojis,\n  emojiSetDef: emojiSetDef\n});\n\nvar MessageRepliesCountButton =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(MessageRepliesCountButton, _React$PureComponent);\n\n  function MessageRepliesCountButton() {\n    _classCallCheck(this, MessageRepliesCountButton);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(MessageRepliesCountButton).apply(this, arguments));\n  }\n\n  _createClass(MessageRepliesCountButton, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          reply_count = _this$props.reply_count,\n          labelSingle = _this$props.labelSingle,\n          labelPlural = _this$props.labelPlural;\n\n      if (reply_count && reply_count !== 0) {\n        return React.createElement(\"button\", {\n          className: \"str-chat__message-replies-count-button\",\n          onClick: this.props.onClick\n        }, React.createElement(\"svg\", {\n          width: \"18\",\n          height: \"15\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M.56 10.946H.06l-.002-.498L.025.92a.5.5 0 1 1 1-.004l.032 9.029H9.06v-4l9 4.5-9 4.5v-4H.56z\",\n          fillRule: \"nonzero\"\n        })), reply_count, \" \", reply_count === 1 ? labelSingle : labelPlural);\n      }\n\n      return null;\n    }\n  }]);\n\n  return MessageRepliesCountButton;\n}(React.PureComponent);\n\n_defineProperty(MessageRepliesCountButton, \"propTypes\", {\n  labelSingle: PropTypes.string,\n  labelPlural: PropTypes.string,\n  reply_count: PropTypes.number,\n  onClick: PropTypes.func\n});\n\n_defineProperty(MessageRepliesCountButton, \"defaultProps\", {\n  labelSingle: 'reply',\n  labelPlural: 'replies',\n  reply_count: 0\n});\n\nvar Modal =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Modal, _React$PureComponent);\n\n  function Modal() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Modal);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Modal)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"innerRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleClick\", function (e) {\n      if (!_this.innerRef.current.contains(e.target)) {\n        _this.props.onClose();\n\n        document.removeEventListener('keyPress', _this.handleEscKey, false);\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(Modal, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.addEventListener('keyPress', this.handleEscKey, false);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener('keyPress', this.handleEscKey, false);\n    }\n  }, {\n    key: \"handleEscKey\",\n    value: function handleEscKey(e) {\n      if (e.keyCode === 27) {\n        this.props.onClose();\n        document.removeEventListener('keyPress', this.handleEscKey, false);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var openClasses = this.props.open ? 'str-chat__modal--open' : 'str-chat__modal--closed';\n      return React.createElement(\"div\", {\n        className: \"str-chat__modal \".concat(openClasses),\n        onClick: this.handleClick\n      }, React.createElement(\"div\", {\n        className: \"str-chat__modal__close-button\"\n      }, \"Close\", React.createElement(\"svg\", {\n        width: \"10\",\n        height: \"10\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M9.916 1.027L8.973.084 5 4.058 1.027.084l-.943.943L4.058 5 .084 8.973l.943.943L5 5.942l3.973 3.974.943-.943L5.942 5z\",\n        fillRule: \"evenodd\"\n      }))), React.createElement(\"div\", {\n        className: \"str-chat__modal__inner\",\n        ref: this.innerRef\n      }, this.props.children));\n    }\n  }]);\n\n  return Modal;\n}(React.PureComponent);\n\nvar ChatContext = React.createContext({\n  client: null\n});\n\nfunction withChatContext(OriginalComponent) {\n  var ContextAwareComponent = function ContextComponent(props) {\n    return React.createElement(ChatContext.Consumer, null, function (context) {\n      var mergedProps = _objectSpread({}, context, props);\n\n      return React.createElement(OriginalComponent, mergedProps);\n    });\n  };\n\n  ContextAwareComponent.displayName = OriginalComponent.displayName || OriginalComponent.name || 'Component';\n  ContextAwareComponent.displayName = ContextAwareComponent.displayName.replace('Base', '');\n  return ContextAwareComponent;\n}\n\nvar ChannelContext = React.createContext({});\n\nfunction withChannelContext(OriginalComponent) {\n  var ContextAwareComponent = function ContextComponent(props) {\n    return React.createElement(ChannelContext.Consumer, null, function (channelContext) {\n      return React.createElement(OriginalComponent, _extends({}, channelContext, props));\n    });\n  };\n\n  ContextAwareComponent.displayName = OriginalComponent.displayName || OriginalComponent.name || 'Component';\n  ContextAwareComponent.displayName = ContextAwareComponent.displayName.replace('Base', '');\n  return ContextAwareComponent;\n}\n\nvar KEY_CODES = {\n  ESC: 27,\n  UP: 38,\n  DOWN: 40,\n  ENTER: 13,\n  TAB: 9,\n  SPACE: 32\n}; // This is self-made key shortcuts manager, used for caching key strokes\n\nvar Listener = function Listener() {\n  var _this = this;\n\n  _classCallCheck(this, Listener);\n\n  _defineProperty(this, \"startListen\", function () {\n    if (!_this.refCount) {\n      // prevent multiple listeners in case of multiple TextareaAutocomplete components on page\n      document.addEventListener('keydown', _this.f);\n    }\n\n    _this.refCount++;\n  });\n\n  _defineProperty(this, \"stopListen\", function () {\n    _this.refCount--;\n\n    if (!_this.refCount) {\n      // prevent disable listening in case of multiple TextareaAutocomplete components on page\n      document.removeEventListener('keydown', _this.f);\n    }\n  });\n\n  _defineProperty(this, \"add\", function (keyCodes, fn) {\n    var keyCode = keyCodes;\n    if (_typeof(keyCode) !== 'object') keyCode = [keyCode];\n    _this.listeners[_this.index] = {\n      keyCode: keyCode,\n      fn: fn\n    };\n    _this.index += 1;\n    return _this.index;\n  });\n\n  _defineProperty(this, \"remove\", function (id) {\n    delete _this.listeners[id];\n  });\n\n  _defineProperty(this, \"removeAll\", function () {\n    _this.listeners = {};\n    _this.index = 0;\n  });\n\n  this.index = 0;\n  this.listeners = {};\n  this.refCount = 0;\n\n  this.f = function (e) {\n    var code = e.keyCode || e.which;\n    Object.values(_this.listeners).forEach(function (_ref) {\n      var keyCode = _ref.keyCode,\n          fn = _ref.fn;\n      if (keyCode.includes(code)) fn(e);\n    });\n  };\n};\n\nvar Listeners = new Listener();\n\nvar Item =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Item, _React$Component);\n\n  function Item() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Item);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Item)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"selectItem\", function () {\n      var _this$props = _this.props,\n          item = _this$props.item,\n          onSelectHandler = _this$props.onSelectHandler;\n      onSelectHandler(item);\n    });\n\n    return _this;\n  }\n\n  _createClass(Item, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          Component$$1 = _this$props2.component,\n          style = _this$props2.style,\n          onClickHandler = _this$props2.onClickHandler,\n          item = _this$props2.item,\n          selected = _this$props2.selected,\n          className = _this$props2.className,\n          innerRef = _this$props2.innerRef;\n      return React.createElement(\"li\", {\n        className: \"rta__item \".concat(className || ''),\n        style: style\n      }, React.createElement(\"div\", {\n        className: \"rta__entity \".concat(selected === true ? 'rta__entity--selected' : ''),\n        role: \"button\",\n        tabIndex: 0,\n        onClick: onClickHandler,\n        onFocus: this.selectItem,\n        onMouseEnter: this.selectItem\n        /* $FlowFixMe */\n        ,\n        ref: innerRef\n      }, React.createElement(Component$$1, {\n        selected: selected,\n        entity: item\n      })));\n    }\n  }]);\n\n  return Item;\n}(React.Component);\n\nvar List =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(List, _React$Component);\n\n  function List() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, List);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(List)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      selectedItem: null\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"cachedValues\", null);\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onPressEnter\", function (e) {\n      if (e && e.preventDefault) {\n        e.preventDefault();\n      }\n\n      var values = _this.props.values;\n\n      _this.modifyText(values[_this.getPositionInList()]);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getPositionInList\", function () {\n      var values = _this.props.values;\n      var selectedItem = _this.state.selectedItem;\n      if (!selectedItem) return 0;\n      return values.findIndex(function (a) {\n        return _this.getId(a) === _this.getId(selectedItem);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getId\", function (item) {\n      var textToReplace = _this.props.getTextToReplace(item);\n\n      if (textToReplace.key) {\n        return textToReplace.key;\n      }\n\n      if (typeof item === 'string' || !item.key) {\n        return textToReplace.text;\n      }\n\n      return item.key;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"listeners\", []);\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"itemsRef\", {});\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"modifyText\", function (value) {\n      if (!value) return;\n      var _this$props = _this.props,\n          onSelect = _this$props.onSelect,\n          getTextToReplace = _this$props.getTextToReplace;\n      onSelect(getTextToReplace(value));\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"selectItem\", function (item) {\n      var keyboard = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      _this.setState({\n        selectedItem: item\n      }, function () {\n        if (keyboard) {\n          _this.props.dropdownScroll(_this.itemsRef[_this.getId(item)]);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"scroll\", function (e) {\n      if (e && e.preventDefault) {\n        e.preventDefault();\n      }\n\n      var values = _this.props.values;\n      var code = e.keyCode || e.which;\n\n      var oldPosition = _this.getPositionInList();\n\n      var newPosition;\n\n      switch (code) {\n        case KEY_CODES.DOWN:\n          newPosition = oldPosition + 1;\n          break;\n\n        case KEY_CODES.UP:\n          newPosition = oldPosition - 1;\n          break;\n\n        default:\n          newPosition = oldPosition;\n          break;\n      }\n\n      newPosition = (newPosition % values.length + values.length) % values.length; // eslint-disable-line\n\n      _this.selectItem(values[newPosition], [KEY_CODES.DOWN, KEY_CODES.UP].includes(code));\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"isSelected\", function (item) {\n      var selectedItem = _this.state.selectedItem;\n      if (!selectedItem) return false;\n      return _this.getId(selectedItem) === _this.getId(item);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderHeader\", function (value) {\n      if (value[0] === '/') {\n        return \"Commands matching <strong>\".concat(value.replace('/', ''), \"</strong>\");\n      }\n\n      if (value[0] === ':') {\n        return \"Emoji matching <strong>\".concat(value.replace(':', ''), \"</strong>\");\n      }\n\n      if (value[0] === '@') {\n        return \"People matching <strong>\".concat(value.replace('@', ''), \"</strong>\");\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(List, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.listeners.push(Listeners.add([KEY_CODES.DOWN, KEY_CODES.UP], this.scroll), Listeners.add([KEY_CODES.ENTER, KEY_CODES.TAB], this.onPressEnter));\n      var values = this.props.values;\n      if (values && values[0]) this.selectItem(values[0]);\n    }\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(_ref) {\n      var _this2 = this;\n\n      var values = _ref.values;\n      var newValues = values.map(function (val) {\n        return _this2.getId(val);\n      }).join('');\n\n      if (this.cachedValues !== newValues && values && values[0]) {\n        this.selectItem(values[0]);\n        this.cachedValues = newValues;\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var listener;\n\n      while (this.listeners.length) {\n        listener = this.listeners.pop();\n        Listeners.remove(listener);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          values = _this$props2.values,\n          component = _this$props2.component,\n          style = _this$props2.style,\n          itemClassName = _this$props2.itemClassName,\n          className = _this$props2.className,\n          itemStyle = _this$props2.itemStyle;\n      return React.createElement(\"ul\", {\n        className: \"rta__list \".concat(className || ''),\n        style: style\n      }, React.createElement(\"li\", {\n        className: \"rta__list-header\",\n        dangerouslySetInnerHTML: {\n          __html: this.renderHeader(this.props.value)\n        }\n      }), values.map(function (item) {\n        return React.createElement(Item, {\n          key: _this3.getId(item),\n          innerRef: function innerRef(ref) {\n            _this3.itemsRef[_this3.getId(item)] = ref;\n          },\n          selected: _this3.isSelected(item),\n          item: item,\n          className: itemClassName,\n          style: itemStyle,\n          onClickHandler: _this3.onPressEnter,\n          onSelectHandler: _this3.selectItem,\n          component: component\n        });\n      }));\n    }\n  }]);\n\n  return List;\n}(React.Component); //\n\n\nfunction defaultScrollToItem(container, item) {\n  var itemHeight = parseInt(getComputedStyle(item).getPropertyValue('height'), 10);\n  var containerHight = parseInt(getComputedStyle(container).getPropertyValue('height'), 10) - itemHeight;\n  var itemOffsetTop = item.offsetTop;\n  var actualScrollTop = container.scrollTop;\n\n  if (itemOffsetTop < actualScrollTop + containerHight && actualScrollTop < itemOffsetTop) {\n    return;\n  } // eslint-disable-next-line\n\n\n  container.scrollTop = itemOffsetTop;\n}\n\nvar DEFAULT_CARET_POSITION = 'next';\n\nvar errorMessage = function errorMessage(message) {\n  return console.error(\"RTA: dataProvider fails: \".concat(message, \"\\n    \\nCheck the documentation or create issue if you think it's bug. https://github.com/webscopeio/react-textarea-autocomplete/issues\"));\n};\n\nvar ReactTextareaAutocomplete =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ReactTextareaAutocomplete, _React$Component);\n\n  function ReactTextareaAutocomplete(_props) {\n    var _this;\n\n    _classCallCheck(this, ReactTextareaAutocomplete);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReactTextareaAutocomplete).call(this, _props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getSelectionPosition\", function () {\n      if (!_this.textareaRef) return null;\n      return {\n        selectionStart: _this.textareaRef.selectionStart,\n        selectionEnd: _this.textareaRef.selectionEnd\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getSelectedText\", function () {\n      if (!_this.textareaRef) return null;\n      var _this$textareaRef = _this.textareaRef,\n          selectionStart = _this$textareaRef.selectionStart,\n          selectionEnd = _this$textareaRef.selectionEnd;\n      if (selectionStart === selectionEnd) return null;\n      return _this.state.value.substr(selectionStart, selectionEnd - selectionStart);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"setCaretPosition\", function () {\n      var position = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      if (!_this.textareaRef) return;\n\n      _this.textareaRef.focus();\n\n      _this.textareaRef.setSelectionRange(position, position);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getCaretPosition\", function () {\n      if (!_this.textareaRef) {\n        return 0;\n      }\n\n      var position = _this.textareaRef.selectionEnd;\n      return position;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_onEnter\", function (event) {\n      var trigger = _this.state.currentTrigger;\n\n      if (!_this.textareaRef) {\n        return;\n      }\n\n      var hasFocus = _this.textareaRef.matches(':focus'); // don't submit if the element has focus or the shift key is pressed\n\n\n      if (!hasFocus || event.shiftKey === true) {\n        return;\n      }\n\n      if (!trigger) {\n        // trigger a submit\n        _this._replaceWord();\n\n        if (_this.textareaRef) {\n          _this.textareaRef.selectionEnd = 0;\n        }\n\n        _this.props.handleSubmit(event);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_onSpace\", function () {\n      if (!_this.props.replaceWord) {\n        return;\n      }\n\n      if (!_this.textareaRef) {\n        return;\n      }\n\n      var hasFocus = _this.textareaRef.matches(':focus'); // don't change characters if the element doesn't have focus\n\n\n      if (!hasFocus) {\n        return;\n      }\n\n      _this._replaceWord();\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_replaceWord\", function () {\n      var lastWordRegex = /([^\\s]+)(\\s*)$/;\n      var value = _this.state.value;\n      var match = lastWordRegex.exec(value.slice(0, _this.getCaretPosition()));\n      var lastWord = match && match[1];\n\n      if (!lastWord) {\n        return;\n      }\n\n      var spaces = match[2];\n\n      var newWord = _this.props.replaceWord(lastWord);\n\n      if (newWord == null) {\n        return;\n      }\n\n      var textBeforeWord = value.slice(0, _this.getCaretPosition() - match[0].length);\n      var textAfterCaret = value.slice(_this.getCaretPosition(), -1);\n      var newText = textBeforeWord + newWord + spaces + textAfterCaret;\n\n      _this.setState({\n        value: newText\n      }, function () {\n        // fire onChange event after successful selection\n        var e = new CustomEvent('change', {\n          bubbles: true\n        });\n\n        _this.textareaRef.dispatchEvent(e);\n\n        if (_this.props.onChange) _this.props.onChange(e);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_onSelect\", function (newToken) {\n      var _this$state = _this.state,\n          selectionEnd = _this$state.selectionEnd,\n          currentTrigger = _this$state.currentTrigger,\n          textareaValue = _this$state.value;\n      var _this$props = _this.props,\n          onChange = _this$props.onChange,\n          trigger = _this$props.trigger;\n      if (!currentTrigger) return;\n\n      var computeCaretPosition = function computeCaretPosition(position, token, startToken) {\n        switch (position) {\n          case 'start':\n            return startToken;\n\n          case 'next':\n          case 'end':\n            return startToken + token.length;\n\n          default:\n            if (!Number.isInteger(position)) {\n              throw new Error('RTA: caretPosition should be \"start\", \"next\", \"end\" or number.');\n            }\n\n            return position;\n        }\n      };\n\n      var textToModify = textareaValue.slice(0, selectionEnd);\n      var startOfTokenPosition = textToModify.search(\n      /**\n       * It's important to escape the currentTrigger char for chars like [, (,...\n       */\n      new RegExp(\"\\\\\".concat(currentTrigger, \"[^\\\\\".concat(currentTrigger).concat(trigger[currentTrigger].allowWhitespace ? '' : '\\\\s', \"]\"), \"*$\"))); // we add space after emoji is selected if a caret position is next\n\n      var newTokenString = newToken.caretPosition === 'next' ? \"\".concat(newToken.text, \" \") : newToken.text;\n      var newCaretPosition = computeCaretPosition(newToken.caretPosition, newTokenString, startOfTokenPosition);\n      var modifiedText = textToModify.substring(0, startOfTokenPosition) + newTokenString; // set the new textarea value and after that set the caret back to its position\n\n      _this.setState({\n        value: textareaValue.replace(textToModify, modifiedText),\n        dataLoading: false\n      }, function () {\n        // fire onChange event after successful selection\n        var e = new CustomEvent('change', {\n          bubbles: true\n        });\n\n        _this.textareaRef.dispatchEvent(e);\n\n        if (onChange) onChange(e);\n\n        _this.setCaretPosition(newCaretPosition);\n      });\n\n      _this._closeAutocomplete();\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_getTextToReplace\", function () {\n      var _this$state2 = _this.state,\n          currentTrigger = _this$state2.currentTrigger,\n          actualToken = _this$state2.actualToken;\n\n      var triggerSettings = _this._getCurrentTriggerSettings();\n\n      if (!currentTrigger || !triggerSettings) return null;\n      var output = triggerSettings.output;\n      return function (item) {\n        if (_typeof(item) === 'object' && (!output || typeof output !== 'function')) {\n          throw new Error('Output functor is not defined! If you are using items as object you have to define \"output\" function. https://github.com/webscopeio/react-textarea-autocomplete#trigger-type');\n        }\n\n        if (output) {\n          var textToReplace = output(item, currentTrigger);\n\n          if (!textToReplace || typeof textToReplace === 'number') {\n            throw new Error(\"Output functor should return string or object in shape {text: string, caretPosition: string | number}.\\nGot \\\"\".concat(String(textToReplace), \"\\\". Check the implementation for trigger \\\"\").concat(currentTrigger, \"\\\" and its token \\\"\").concat(actualToken, \"\\\"\\n\\nSee https://github.com/webscopeio/react-textarea-autocomplete#trigger-type for more informations.\\n\"));\n          }\n\n          if (typeof textToReplace === 'string') {\n            return {\n              text: textToReplace,\n              caretPosition: DEFAULT_CARET_POSITION\n            };\n          }\n\n          if (!textToReplace.text) {\n            throw new Error(\"Output \\\"text\\\" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger \\\"\".concat(currentTrigger, \"\\\" and its token \\\"\").concat(actualToken, \"\\\"\\n\"));\n          }\n\n          if (!textToReplace.caretPosition) {\n            throw new Error(\"Output \\\"caretPosition\\\" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger \\\"\".concat(currentTrigger, \"\\\" and its token \\\"\").concat(actualToken, \"\\\"\\n\"));\n          }\n\n          return textToReplace;\n        }\n\n        if (typeof item !== 'string') {\n          throw new Error('Output item should be string\\n');\n        }\n\n        return {\n          text: \"\".concat(currentTrigger).concat(item).concat(currentTrigger),\n          caretPosition: DEFAULT_CARET_POSITION\n        };\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_getCurrentTriggerSettings\", function () {\n      var currentTrigger = _this.state.currentTrigger;\n      if (!currentTrigger) return null;\n      return _this.props.trigger[currentTrigger];\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_getValuesFromProvider\", function () {\n      var _this$state3 = _this.state,\n          currentTrigger = _this$state3.currentTrigger,\n          actualToken = _this$state3.actualToken;\n\n      var triggerSettings = _this._getCurrentTriggerSettings();\n\n      if (!currentTrigger || !triggerSettings) {\n        return;\n      }\n\n      var dataProvider = triggerSettings.dataProvider,\n          component = triggerSettings.component;\n\n      if (typeof dataProvider !== 'function') {\n        throw new Error('Trigger provider has to be a function!');\n      }\n\n      _this.setState({\n        dataLoading: true\n      }); // Modified: send the full text to support / style commands\n\n\n      var providedData = dataProvider(actualToken, _this.state.value);\n\n      if (!(providedData instanceof Promise)) {\n        providedData = Promise.resolve(providedData);\n      }\n\n      providedData.then(function (data$$1) {\n        if (!Array.isArray(data$$1)) {\n          throw new Error('Trigger provider has to provide an array!');\n        }\n\n        if (typeof component !== 'function') {\n          throw new Error('Component should be defined!');\n        } // throw away if we resolved old trigger\n\n\n        if (currentTrigger !== _this.state.currentTrigger) return; // if we haven't resolved any data let's close the autocomplete\n\n        if (!data$$1.length) {\n          _this._closeAutocomplete();\n\n          return;\n        }\n\n        _this.setState({\n          dataLoading: false,\n          data: data$$1,\n          component: component\n        });\n      }).catch(function (e) {\n        return errorMessage(e.message);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_getSuggestions\", function () {\n      var _this$state4 = _this.state,\n          currentTrigger = _this$state4.currentTrigger,\n          data$$1 = _this$state4.data;\n      if (!currentTrigger || !data$$1 || data$$1 && !data$$1.length) return null;\n      return data$$1;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_createRegExp\", function () {\n      var trigger = _this.props.trigger; // negative lookahead to match only the trigger + the actual token = \"bladhwd:adawd:word test\" => \":word\"\n      // https://stackoverflow.com/a/8057827/2719917\n\n      _this.tokenRegExp = new RegExp(\"([\".concat(Object.keys(trigger).join(''), \"])(?:(?!\\\\1)[^\\\\s])*$\"));\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_closeAutocomplete\", function () {\n      _this.setState({\n        data: null,\n        dataLoading: false,\n        currentTrigger: null,\n        top: null,\n        left: null\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_cleanUpProps\", function () {\n      var props = _objectSpread({}, _this.props);\n\n      var notSafe = ['loadingComponent', 'containerStyle', 'minChar', 'scrollToItem', 'ref', 'innerRef', 'onChange', 'onCaretPositionChange', 'className', 'value', 'trigger', 'listStyle', 'itemStyle', 'containerStyle', 'loaderStyle', 'className', 'containerClassName', 'listClassName', 'itemClassName', 'loaderClassName', 'closeOnClickOutside', 'dropdownStyle', 'dropdownClassName', 'movePopupAsYouType', 'handleSubmit', 'replaceWord', 'grow']; // eslint-disable-next-line\n\n      for (var prop in props) {\n        if (notSafe.includes(prop)) delete props[prop];\n      }\n\n      return props;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_changeHandler\", function (e) {\n      var _this$props2 = _this.props,\n          trigger = _this$props2.trigger,\n          onChange = _this$props2.onChange,\n          minChar = _this$props2.minChar,\n          onCaretPositionChange = _this$props2.onCaretPositionChange,\n          movePopupAsYouType = _this$props2.movePopupAsYouType;\n      var _this$state5 = _this.state,\n          top = _this$state5.top,\n          left = _this$state5.left;\n      var textarea = e.target;\n      var selectionEnd = textarea.selectionEnd,\n          selectionStart = textarea.selectionStart;\n      var value = textarea.value;\n\n      if (onChange) {\n        e.persist();\n        onChange(e);\n      }\n\n      if (onCaretPositionChange) {\n        var caretPosition = _this.getCaretPosition();\n\n        onCaretPositionChange(caretPosition);\n      }\n\n      _this.setState({\n        value: value\n      });\n\n      var tokenMatch = _this.tokenRegExp.exec(value.slice(0, selectionEnd));\n\n      var lastToken = tokenMatch && tokenMatch[0];\n      var currentTrigger = lastToken && Object.keys(trigger).find(function (a) {\n        return a === lastToken[0];\n      }) || null;\n      /*\n       if we lost the trigger token or there is no following character we want to close\n       the autocomplete\n      */\n\n      if ((!lastToken || lastToken.length <= minChar) && ( // check if our current trigger disallows whitespace\n      _this.state.currentTrigger && !trigger[_this.state.currentTrigger].allowWhitespace || !_this.state.currentTrigger)) {\n        _this._closeAutocomplete();\n\n        return;\n      }\n      /**\n       * This code has to be sync that is the reason why we obtain the currentTrigger\n       * from currentTrigger not this.state.currentTrigger\n       *\n       * Check if the currently typed token has to be afterWhitespace, or not.\n       */\n\n\n      if (currentTrigger && value[tokenMatch.index - 1] && trigger[currentTrigger].afterWhitespace && !value[tokenMatch.index - 1].match(/\\s/)) {\n        _this._closeAutocomplete();\n\n        return;\n      }\n      /**\n        If our current trigger allows whitespace\n        get the correct token for DataProvider, so we need to construct new RegExp\n       */\n\n\n      if (_this.state.currentTrigger && trigger[_this.state.currentTrigger].allowWhitespace) {\n        tokenMatch = new RegExp(\"\\\\\".concat(_this.state.currentTrigger, \"[^\").concat(_this.state.currentTrigger, \"]*$\")).exec(value.slice(0, selectionEnd));\n        lastToken = tokenMatch && tokenMatch[0];\n\n        if (!lastToken) {\n          _this._closeAutocomplete();\n\n          return;\n        }\n\n        currentTrigger = Object.keys(trigger).find(function (a) {\n          return a === lastToken[0];\n        }) || null;\n      }\n\n      var actualToken = lastToken.slice(1); // if trigger is not configured step out from the function, otherwise proceed\n\n      if (!currentTrigger) {\n        return;\n      }\n\n      if (movePopupAsYouType || top === null && left === null || // if we have single char - trigger it means we want to re-position the autocomplete\n      lastToken.length === 1) {\n        var _getCaretCoordinates = getCaretCoordinates(textarea, selectionEnd),\n            newTop = _getCaretCoordinates.top,\n            newLeft = _getCaretCoordinates.left;\n\n        _this.setState({\n          // make position relative to textarea\n          top: newTop - _this.textareaRef.scrollTop || 0,\n          left: newLeft\n        });\n      }\n\n      _this.setState({\n        selectionEnd: selectionEnd,\n        selectionStart: selectionStart,\n        currentTrigger: currentTrigger,\n        actualToken: actualToken\n      }, function () {\n        try {\n          _this._getValuesFromProvider();\n        } catch (err) {\n          errorMessage(err.message);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_selectHandler\", function (e) {\n      var _this$props3 = _this.props,\n          onCaretPositionChange = _this$props3.onCaretPositionChange,\n          onSelect = _this$props3.onSelect;\n\n      if (onCaretPositionChange) {\n        var caretPosition = _this.getCaretPosition();\n\n        onCaretPositionChange(caretPosition);\n      }\n\n      if (onSelect) {\n        e.persist();\n        onSelect(e);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_onClickAndBlurHandler\", function (e) {\n      var _this$props4 = _this.props,\n          closeOnClickOutside = _this$props4.closeOnClickOutside,\n          onBlur = _this$props4.onBlur; // If this is a click: e.target is the textarea, and e.relatedTarget is the thing\n      // that was actually clicked. If we clicked inside the autoselect dropdown, then\n      // that's not a blur, from the autoselect's point of view, so then do nothing.\n\n      var el = e.relatedTarget;\n\n      if (_this.dropdownRef && el instanceof Node && _this.dropdownRef.contains(el)) {\n        return;\n      }\n\n      if (closeOnClickOutside) {\n        _this._closeAutocomplete();\n      }\n\n      if (onBlur) {\n        e.persist();\n        onBlur(e);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_onScrollHandler\", function () {\n      _this._closeAutocomplete();\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_dropdownScroll\", function (item) {\n      var scrollToItem = _this.props.scrollToItem;\n      if (!scrollToItem) return;\n\n      if (scrollToItem === true) {\n        defaultScrollToItem(_this.dropdownRef, item);\n        return;\n      }\n\n      if (typeof scrollToItem !== 'function' || scrollToItem.length !== 2) {\n        throw new Error('`scrollToItem` has to be boolean (true for default implementation) or function with two parameters: container, item.');\n      }\n\n      scrollToItem(_this.dropdownRef, item);\n    });\n\n    var _this$props5 = _this.props,\n        loadingComponent = _this$props5.loadingComponent,\n        _trigger = _this$props5.trigger,\n        _value = _this$props5.value; // TODO: it would be better to have the parent control state...\n    // if (value) this.state.value = value;\n\n    _this._createRegExp();\n\n    if (!loadingComponent) {\n      throw new Error('RTA: loadingComponent is not defined');\n    }\n\n    if (!_trigger) {\n      throw new Error('RTA: trigger is not defined');\n    }\n\n    _this.state = {\n      top: null,\n      left: null,\n      currentTrigger: null,\n      actualToken: '',\n      data: null,\n      value: _value || '',\n      dataLoading: false,\n      selectionEnd: 0,\n      selectionStart: 0,\n      component: null,\n      listenerIndex: 0\n    };\n    return _this;\n  }\n\n  _createClass(ReactTextareaAutocomplete, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      Listeners.add(KEY_CODES.ESC, function () {\n        return _this2._closeAutocomplete();\n      });\n      Listeners.add(KEY_CODES.SPACE, function () {\n        return _this2._onSpace();\n      });\n      var listenerIndex = Listeners.add(KEY_CODES.ENTER, function (e) {\n        return _this2._onEnter(e);\n      });\n      this.setState({\n        listenerIndex: listenerIndex\n      });\n      Listeners.startListen();\n    }\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(nextProps) {\n      this._update(nextProps);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      Listeners.stopListen();\n      Listeners.remove(this.state.listenerIndex);\n    }\n  }, {\n    key: \"_update\",\n    // TODO: This is an anti pattern in react, should come up with a better way\n    value: function _update(_ref) {\n      var value = _ref.value,\n          trigger = _ref.trigger;\n      var oldValue = this.state.value;\n      var oldTrigger = this.props.trigger;\n      if (value !== oldValue || !oldValue) this.setState({\n        value: value\n      });\n      /**\n       * check if trigger chars are changed, if so, change the regexp accordingly\n       */\n\n      if (Object.keys(trigger).join('') !== Object.keys(oldTrigger).join('')) {\n        this._createRegExp();\n      }\n    }\n    /**\n     * Close autocomplete, also clean up trigger (to avoid slow promises)\n     */\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props6 = this.props,\n          Loader = _this$props6.loadingComponent,\n          style = _this$props6.style,\n          className = _this$props6.className,\n          itemStyle = _this$props6.itemStyle,\n          listClassName = _this$props6.listClassName,\n          itemClassName = _this$props6.itemClassName,\n          dropdownClassName = _this$props6.dropdownClassName,\n          dropdownStyle = _this$props6.dropdownStyle,\n          containerStyle = _this$props6.containerStyle,\n          containerClassName = _this$props6.containerClassName,\n          loaderStyle = _this$props6.loaderStyle,\n          loaderClassName = _this$props6.loaderClassName;\n      var _this$state6 = this.state,\n          dataLoading = _this$state6.dataLoading,\n          currentTrigger = _this$state6.currentTrigger,\n          component = _this$state6.component,\n          value = _this$state6.value;\n\n      var suggestionData = this._getSuggestions();\n\n      var textToReplace = this._getTextToReplace();\n\n      var maxRows = 10;\n\n      if (!this.props.grow) {\n        maxRows = 1;\n      }\n\n      return React.createElement(\"div\", {\n        className: \"rta \".concat(dataLoading === true ? 'rta--loading' : '', \" \").concat(containerClassName || ''),\n        style: containerStyle\n      }, (dataLoading || suggestionData) && currentTrigger && React.createElement(\"div\", {\n        ref: function ref(_ref2) {\n          // $FlowFixMe\n          _this3.dropdownRef = _ref2;\n        },\n        style: _objectSpread({}, dropdownStyle),\n        className: \"rta__autocomplete \".concat(dropdownClassName || '')\n      }, suggestionData && component && textToReplace && React.createElement(List, {\n        value: value,\n        values: suggestionData,\n        component: component,\n        className: listClassName,\n        itemClassName: itemClassName,\n        itemStyle: itemStyle,\n        getTextToReplace: textToReplace,\n        onSelect: this._onSelect,\n        dropdownScroll: this._dropdownScroll\n      }), dataLoading && React.createElement(\"div\", {\n        className: \"rta__loader \".concat(suggestionData !== null ? 'rta__loader--suggestion-data' : 'rta__loader--empty-suggestion-data', \" \").concat(loaderClassName || ''),\n        style: loaderStyle\n      }, React.createElement(Loader, {\n        data: suggestionData\n      }))), React.createElement(Textarea, _extends({}, this._cleanUpProps(), {\n        inputRef: function inputRef(ref) {\n          _this3.props.innerRef && _this3.props.innerRef(ref);\n          _this3.textareaRef = ref;\n        },\n        maxRows: maxRows,\n        className: \"rta__textarea \".concat(className || ''),\n        onChange: this._changeHandler,\n        onSelect: this._selectHandler,\n        onScroll: this._onScrollHandler,\n        onClick: // The textarea itself is outside the autoselect dropdown.\n        this._onClickAndBlurHandler,\n        onBlur: this._onClickAndBlurHandler,\n        onFocus: this.props.onFocus,\n        value: value,\n        style: style\n      })));\n    }\n  }]);\n\n  return ReactTextareaAutocomplete;\n}(React.Component);\n\n_defineProperty(ReactTextareaAutocomplete, \"defaultProps\", {\n  closeOnClickOutside: true,\n  movePopupAsYouType: false,\n  value: '',\n  minChar: 1,\n  scrollToItem: true\n});\n\nvar triggerPropsCheck = function triggerPropsCheck(_ref3) {\n  var trigger = _ref3.trigger;\n  if (!trigger) return Error('Invalid prop trigger. Prop missing.');\n  var triggers = Object.entries(trigger);\n\n  for (var i = 0; i < triggers.length; i += 1) {\n    var _triggers$i = _slicedToArray(triggers[i], 2),\n        triggerChar = _triggers$i[0],\n        settings = _triggers$i[1];\n\n    if (typeof triggerChar !== 'string' || triggerChar.length !== 1) {\n      return Error('Invalid prop trigger. Keys of the object has to be string / one character.');\n    } // $FlowFixMe\n\n\n    var triggerSetting = settings;\n    var component = triggerSetting.component,\n        dataProvider = triggerSetting.dataProvider,\n        output = triggerSetting.output,\n        afterWhitespace = triggerSetting.afterWhitespace,\n        allowWhitespace = triggerSetting.allowWhitespace;\n\n    if (!component || typeof component !== 'function') {\n      return Error('Invalid prop trigger: component should be defined.');\n    }\n\n    if (!dataProvider || typeof dataProvider !== 'function') {\n      return Error('Invalid prop trigger: dataProvider should be defined.');\n    }\n\n    if (output && typeof output !== 'function') {\n      return Error('Invalid prop trigger: output should be a function.');\n    }\n\n    if (afterWhitespace && allowWhitespace) {\n      return Error('Invalid prop trigger: afterWhitespace and allowWhitespace can be used together');\n    }\n  }\n\n  return null;\n};\n\nReactTextareaAutocomplete.propTypes = {\n  loadingComponent: PropTypes.func.isRequired,\n  minChar: PropTypes.number,\n  onChange: PropTypes.func,\n  onSelect: PropTypes.func,\n  onBlur: PropTypes.func,\n  onCaretPositionChange: PropTypes.func,\n  className: PropTypes.string,\n  containerStyle: PropTypes.object,\n  containerClassName: PropTypes.string,\n  closeOnClickOutside: PropTypes.bool,\n  style: PropTypes.object,\n  listStyle: PropTypes.object,\n  itemStyle: PropTypes.object,\n  loaderStyle: PropTypes.object,\n  dropdownStyle: PropTypes.object,\n  listClassName: PropTypes.string,\n  itemClassName: PropTypes.string,\n  loaderClassName: PropTypes.string,\n  dropdownClassName: PropTypes.string,\n  value: PropTypes.string,\n  trigger: triggerPropsCheck //eslint-disable-line\n\n};\n\nvar EmoticonItem =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(EmoticonItem, _PureComponent);\n\n  function EmoticonItem() {\n    _classCallCheck(this, EmoticonItem);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(EmoticonItem).apply(this, arguments));\n  }\n\n  _createClass(EmoticonItem, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"str-chat__emoji-item\"\n      }, React.createElement(\"span\", {\n        className: \"str-chat__emoji-item--entity\"\n      }, this.props.entity.native), React.createElement(\"span\", {\n        className: \"str-chat__emoji-item--name\"\n      }, this.props.entity.name), React.createElement(\"span\", {\n        className: \"str-chat__emoji-item--char\"\n      }, this.props.entity.char));\n    }\n  }]);\n\n  return EmoticonItem;\n}(PureComponent);\n\nvar UserItem =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(UserItem, _PureComponent);\n\n  function UserItem() {\n    _classCallCheck(this, UserItem);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(UserItem).apply(this, arguments));\n  }\n\n  _createClass(UserItem, [{\n    key: \"render\",\n    value: function render() {\n      var u = this.props.entity;\n      return React.createElement(\"div\", {\n        className: \"str-chat__user-item\"\n      }, React.createElement(Avatar, {\n        size: 20,\n        image: u.image\n      }), React.createElement(\"div\", null, React.createElement(\"strong\", null, u.name), \" \", u.id));\n    }\n  }]);\n\n  return UserItem;\n}(PureComponent);\n\nvar CommandItem =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(CommandItem, _PureComponent);\n\n  function CommandItem() {\n    _classCallCheck(this, CommandItem);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(CommandItem).apply(this, arguments));\n  }\n\n  _createClass(CommandItem, [{\n    key: \"render\",\n    value: function render() {\n      var c = this.props.entity;\n      return React.createElement(\"div\", {\n        className: \"str-chat__slash-command\"\n      }, React.createElement(\"span\", {\n        className: \"str-chat__slash-command-header\"\n      }, React.createElement(\"strong\", null, c.name), \" \", c.args), React.createElement(\"br\", null), React.createElement(\"span\", {\n        className: \"str-chat__slash-command-description\"\n      }, c.description));\n    }\n  }]);\n\n  return CommandItem;\n}(PureComponent);\n/**\n * Textarea component with included autocomplete options. You can set your own commands and\n * @example ./docs/ChatAutoComplete.md\n */\n\n\nvar ChatAutoComplete =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ChatAutoComplete, _PureComponent);\n\n  function ChatAutoComplete() {\n    _classCallCheck(this, ChatAutoComplete);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ChatAutoComplete).apply(this, arguments));\n  }\n\n  _createClass(ChatAutoComplete, [{\n    key: \"getTriggers\",\n    value: function getTriggers() {\n      var _this = this;\n\n      return {\n        ':': {\n          dataProvider: function dataProvider(q) {\n            if (q.length === 0 || q.charAt(0).match(/[^a-zA-Z0-9+-]/)) {\n              return [];\n            }\n\n            var emojis = emojiIndex.search(q) || [];\n            return emojis.slice(0, 10);\n          },\n          component: EmoticonItem,\n          output: function output(entity) {\n            return {\n              key: entity.id,\n              text: \"\".concat(entity.native),\n              caretPosition: 'next'\n            };\n          }\n        },\n        '@': {\n          dataProvider: function dataProvider(q) {\n            var matchingUsers = _this.props.users.filter(function (user) {\n              return user.id.toLowerCase().indexOf(q.toLowerCase()) !== -1 || user && user.id.toLowerCase().indexOf(q.toLowerCase()) !== -1;\n            });\n\n            return matchingUsers.slice(0, 10);\n          },\n          component: UserItem,\n          output: function output(entity) {\n            return {\n              key: entity.id,\n              text: \"@\".concat(entity.id),\n              caretPosition: 'next'\n            };\n          }\n        },\n        '/': {\n          dataProvider: function dataProvider(q, text) {\n            if (text.indexOf('/') !== 0) {\n              return [];\n            }\n\n            var selectedCommands = _this.props.commands.filter(function (c) {\n              return c.name.indexOf(q) !== -1;\n            }); // sort alphabetically unless the you're matching the first char\n\n\n            selectedCommands.sort(function (a, b) {\n              var nameA = a.name.toLowerCase();\n              var nameB = b.name.toLowerCase();\n\n              if (nameA.indexOf(q) === 0) {\n                nameA = \"0\".concat(nameA);\n              }\n\n              if (nameB.indexOf(q) === 0) {\n                nameB = \"0\".concat(nameB);\n              }\n\n              if (nameA < nameB) {\n                return -1;\n              }\n\n              if (nameA > nameB) {\n                return 1;\n              }\n\n              return 0;\n            });\n            return selectedCommands.slice(0, 10);\n          },\n          component: CommandItem,\n          output: function output(entity) {\n            return {\n              key: entity.id,\n              text: \"/\".concat(entity.name),\n              caretPosition: 'next'\n            };\n          }\n        }\n      };\n    }\n  }, {\n    key: \"emojiReplace\",\n    value: function emojiReplace(word) {\n      var found = emojiIndex.search(word) || [];\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = found.slice(0, 10)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var emoji = _step.value;\n\n          if (emoji.emoticons.includes(word)) {\n            return emoji.native;\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var innerRef = this.props.innerRef;\n      return React.createElement(ReactTextareaAutocomplete, {\n        loadingComponent: LoadingIndicator,\n        trigger: this.getTriggers(),\n        replaceWord: this.emojiReplace,\n        minChar: 0,\n        innerRef: innerRef && function (ref) {\n          innerRef.current = ref;\n        },\n        onFocus: this.props.onFocus,\n        rows: this.props.rows,\n        className: \"str-chat__textarea__textarea\",\n        containerClassName: \"str-chat__textarea\",\n        dropdownClassName: \"str-chat__emojisearch\",\n        listClassName: \"str-chat__emojisearch__list\",\n        itemClassName: \"str-chat__emojisearch__item\",\n        placeholder: this.props.placeholder,\n        onChange: this.props.onChange,\n        handleSubmit: this.props.handleSubmit,\n        onPaste: this.props.onPaste,\n        value: this.props.value,\n        grow: this.props.grow,\n        disabled: this.props.disabled\n      });\n    }\n  }]);\n\n  return ChatAutoComplete;\n}(PureComponent);\n\n_defineProperty(ChatAutoComplete, \"propTypes\", {\n  /** The number of rows you want the textarea to have */\n  rows: PropTypes.number,\n\n  /** Grow the number of rows of the textarea while you're typing */\n  grow: PropTypes.bool,\n\n  /** Make the textarea disabled */\n  disabled: PropTypes.bool,\n\n  /** The value of the textarea */\n  value: PropTypes.string,\n\n  /** Function to run on pasting within the textarea */\n  onPaste: PropTypes.func,\n\n  /** Function that runs on submit */\n  handleSubmit: PropTypes.func,\n\n  /** Function that runs on change */\n  onChange: PropTypes.func,\n\n  /** Placeholder for the textare */\n  placeholder: PropTypes.string,\n\n  /** What loading component to use for the auto complete when loading results. */\n  LoadingIndicator: PropTypes.node,\n\n  /** function to set up your triggers for autocomplete(eg. '@' for mentions, '/' for commands) */\n  trigger: PropTypes.func,\n\n  /** Minimum number of Character */\n  minChar: PropTypes.number\n});\n\n_defineProperty(ChatAutoComplete, \"defaultProps\", {\n  rows: 3\n});\n/**\n * MessageInputLarge - Large Message Input to be used for the MessageInput.\n * @example ./docs/MessageInputLarge.md\n */\n\n\nvar MessageInputLarge =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(MessageInputLarge, _PureComponent);\n\n  function MessageInputLarge() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MessageInputLarge);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MessageInputLarge)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderUploads\", function () {\n      return React.createElement(React.Fragment, null, _this.props.imageOrder.length > 0 && React.createElement(ImagePreviewer, {\n        imageUploads: _this.props.imageOrder.map(function (id) {\n          return _this.props.imageUploads[id];\n        }),\n        handleRemove: _this.props.removeImage,\n        handleRetry: _this.props.uploadImage,\n        handleFiles: _this.props.uploadNewFiles\n      }), _this.props.fileOrder.length > 0 && React.createElement(FilePreviewer, {\n        uploads: _this.props.fileOrder.map(function (id) {\n          return _this.props.fileUploads[id];\n        }),\n        handleRemove: _this.props.removeFile,\n        handleRetry: _this.props.uploadFile,\n        handleFiles: _this.props.uploadNewFiles\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderEmojiPicker\", function () {\n      if (_this.props.emojiPickerIsOpen) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__input--emojipicker\",\n          ref: _this.props.emojiPickerRef\n        }, React.createElement(Picker, {\n          emoji: \"point_up\",\n          title: \"Pick your emoji\\u2026\",\n          onSelect: _this.props.onSelectEmoji,\n          color: \"#006CFF\",\n          showPreview: false\n        }));\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(MessageInputLarge, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        style: {\n          position: 'relative',\n          zIndex: 100,\n          width: '100%'\n        }\n      }, React.createElement(ImageDropzone, {\n        handleFiles: this.props.uploadNewFiles\n      }, React.createElement(\"div\", {\n        className: \"str-chat__input\"\n      }, this.renderUploads(), this.renderEmojiPicker(), React.createElement(ChatAutoComplete, {\n        users: this.props.getUsers(),\n        commands: this.props.getCommands(),\n        innerRef: this.props.textareaRef,\n        handleSubmit: function handleSubmit(e) {\n          return _this2.props.handleSubmit(e);\n        },\n        onChange: this.props.handleChange,\n        value: this.props.text,\n        rows: 1,\n        placeholder: \"Type your message\",\n        onPaste: this.props.onPaste,\n        grow: this.props.grow,\n        disabled: this.props.disabled\n      }), React.createElement(\"span\", {\n        className: \"str-chat__input-emojiselect\",\n        onClick: this.props.openEmojiPicker\n      }, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\",\n        fillRule: \"evenodd\"\n      }))), React.createElement(FileUploadButton, {\n        multiple: true,\n        handleFiles: this.props.uploadNewFiles\n      }, React.createElement(\"span\", {\n        className: \"str-chat__input-fileupload\"\n      }, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M7 .5c3.59 0 6.5 2.91 6.5 6.5s-2.91 6.5-6.5 6.5S.5 10.59.5 7 3.41.5 7 .5zm0 12c3.031 0 5.5-2.469 5.5-5.5S10.031 1.5 7 1.5A5.506 5.506 0 0 0 1.5 7c0 3.034 2.469 5.5 5.5 5.5zM7.506 3v3.494H11v1.05H7.506V11h-1.05V7.544H3v-1.05h3.456V3h1.05z\",\n        fillRule: \"nonzero\"\n      }))))), React.createElement(\"div\", null, React.createElement(\"div\", {\n        className: \"str-chat__input-footer\"\n      }, this.props.watcher_count && React.createElement(\"span\", null, this.props.watcher_count, \" online\"), React.createElement(\"span\", {\n        className: \"str-chat__input-footer--typing\"\n      }, formatArray(this.props.typing))))));\n    }\n  }]);\n\n  return MessageInputLarge;\n}(PureComponent);\n\n_defineProperty(MessageInputLarge, \"propTypes\", {\n  /** Set focus to the text input if this is enabled */\n  focus: PropTypes.bool.isRequired,\n\n  /** Grow the textarea while you're typing */\n  grow: PropTypes.bool.isRequired,\n\n  /** Make the textarea disabled */\n  disabled: PropTypes.bool\n});\n/**\n * MessageInput - Input a new message, support for all the rich features such as image uploads, @mentions, emoticons etc.\n * @example ./docs/MessageInput.md\n * @extends PureComponent\n */\n\n\nvar MessageInput =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(MessageInput, _PureComponent);\n\n  function MessageInput(props) {\n    var _this;\n\n    _classCallCheck(this, MessageInput);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MessageInput).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"openEmojiPicker\", function () {\n      if (!_this.state.showEmojiPicker) {\n        _this.setState(function () {\n          return {\n            emojiPickerIsOpen: true\n          };\n        }, function () {\n          document.addEventListener('click', _this.closeEmojiPicker, false);\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"closeEmojiPicker\", function (e) {\n      if (_this.emojiPickerRef.current && !_this.emojiPickerRef.current.contains(e.target)) {\n        _this.setState({\n          emojiPickerIsOpen: false\n        }, function () {\n          document.removeEventListener('click', _this.closeEmojiPicker, false);\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onSelectEmoji\", function (emoji) {\n      return _this.insertText(emoji.native);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"insertText\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(textToInsert) {\n        var newCursorPosition, textareaElement;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return _this.setState(function (prevState) {\n                  var prevText = prevState.text;\n                  var textareaElement = _this.textareaRef.current;\n\n                  if (!textareaElement) {\n                    return {\n                      text: prevText + textToInsert\n                    };\n                  } // Insert emoji at previous cursor position\n\n\n                  var selectionStart = textareaElement.selectionStart,\n                      selectionEnd = textareaElement.selectionEnd;\n                  newCursorPosition = selectionStart + textToInsert.length;\n                  return {\n                    text: prevText.slice(0, selectionStart) + textToInsert + prevText.slice(selectionEnd)\n                  };\n                });\n\n              case 2:\n                textareaElement = _this.textareaRef.current;\n\n                if (!(!textareaElement || newCursorPosition == null)) {\n                  _context.next = 5;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 5:\n                // Update cursorPosition\n                textareaElement.selectionStart = newCursorPosition;\n                textareaElement.selectionEnd = newCursorPosition;\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getCommands\", function () {\n      var config = _this.props.channel.getConfig();\n\n      var allCommands = config.commands;\n      return allCommands;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getUsers\", function () {\n      var users;\n\n      if (!_this.props.members || !_this.props.watchers) {\n        users = [];\n      } else {\n        var _users;\n\n        users = Object.values(_this.props.members);\n\n        (_users = users).push.apply(_users, _toConsumableArray(Object.values(_this.props.watchers)));\n      } // make sure we don't list users twice\n\n\n      var userMap = {};\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = users[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var user = _step.value;\n\n          if (user) {\n            userMap[user.id] = user;\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return Object.values(userMap);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleChange\", function (event) {\n      event.preventDefault();\n\n      if (!event || !event.target) {\n        return '';\n      }\n\n      var text = event.target.value;\n\n      _this.setState({\n        text: text\n      });\n\n      if (text) {\n        logChatPromiseExecution(_this.props.channel.keystroke(), 'start typing event');\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleSubmit\", function (event) {\n      event.preventDefault();\n      var editing = !!_this.props.message;\n\n      var trimmedMessage = _this.state.text.trim();\n\n      var isEmptyMessage = trimmedMessage === '' || trimmedMessage === '>' || trimmedMessage === '``````' || trimmedMessage === '``' || trimmedMessage === '**' || trimmedMessage === '____' || trimmedMessage === '__' || trimmedMessage === '****';\n      var hasFiles = _this.state.imageOrder.length > 0 || _this.state.fileOrder.length > 0;\n\n      if (isEmptyMessage && !hasFiles) {\n        return;\n      }\n\n      var text = _this.state.text; // the channel component handles the actual sending of the message\n\n      var attachments = _toConsumableArray(_this.state.attachments);\n\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = _this.state.imageOrder[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var _id2 = _step2.value;\n          var image = _this.state.imageUploads[_id2];\n\n          if (!image || image.state === 'failed') {\n            continue;\n          }\n\n          if (image.state === 'uploading') {\n            // TODO: show error to user that they should wait until image is uploaded\n            return;\n          }\n\n          attachments.push({\n            type: 'image',\n            image_url: image.url,\n            fallback: image.file.name\n          });\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = _this.state.fileOrder[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var _id3 = _step3.value;\n          var upload = _this.state.fileUploads[_id3];\n\n          if (!upload || upload.state === 'failed') {\n            continue;\n          }\n\n          if (upload.state === 'uploading') {\n            // TODO: show error to user that they should wait until image is uploaded\n            return;\n          }\n\n          attachments.push({\n            type: 'file',\n            asset_url: upload.url,\n            title: upload.file.name,\n            mime_type: upload.file.type,\n            file_size: upload.file.size\n          });\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n\n      if (editing) {\n        var id = _this.props.message.id;\n        var updatedMessage = {\n          id: id\n        };\n        updatedMessage.text = text;\n        updatedMessage.attachments = attachments; // TODO: Remove this line and show an error when submit fails\n\n        _this.props.clearEditingState();\n\n        var updateMessagePromise = _this.props.client.updateMessage(updatedMessage).then(function () {\n          _this.props.clearEditingState();\n        });\n\n        logChatPromiseExecution(updateMessagePromise, 'update message');\n      } else {\n        var sendMessagePromise = _this.props.sendMessage({\n          text: text,\n          attachments: attachments,\n          parent: _this.props.parent\n        });\n\n        logChatPromiseExecution(sendMessagePromise, 'send message');\n\n        _this.setState({\n          text: '',\n          imageUploads: Immutable({}),\n          imageOrder: [],\n          fileUploads: Immutable({}),\n          fileOrder: []\n        });\n      }\n\n      logChatPromiseExecution(_this.props.channel.stopTyping(), 'stop typing');\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_uploadNewFiles\", function (files) {\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = files[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var file = _step4.value;\n\n          if (file.type.startsWith('image/')) {\n            _this._uploadNewImage(file);\n          } else if (file instanceof File) {\n            _this._uploadNewFile(file);\n          }\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_uploadNewImage\",\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(file) {\n        var id, reader;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                id = generateRandomId();\n                _context2.next = 3;\n                return _this.setState(function (prevState) {\n                  return {\n                    imageOrder: prevState.imageOrder.concat(id),\n                    imageUploads: prevState.imageUploads.setIn([id], {\n                      id: id,\n                      file: file,\n                      state: 'uploading'\n                    })\n                  };\n                });\n\n              case 3:\n                if (FileReader) {\n                  // TODO: Possibly use URL.createObjectURL instead. However, then we need\n                  // to release the previews when not used anymore though.\n                  reader = new FileReader();\n\n                  reader.onload = function (event) {\n                    _this.setState(function (prevState) {\n                      return {\n                        imageUploads: prevState.imageUploads.setIn([id, 'previewUri'], event.target.result)\n                      };\n                    });\n                  };\n\n                  reader.readAsDataURL(file);\n                }\n\n                return _context2.abrupt(\"return\", _this._uploadImage(id));\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_uploadNewFile\",\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(file) {\n        var id;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                id = generateRandomId();\n                _context3.next = 3;\n                return _this.setState(function (prevState) {\n                  return {\n                    fileOrder: prevState.fileOrder.concat(id),\n                    fileUploads: prevState.fileUploads.setIn([id], {\n                      id: id,\n                      file: file,\n                      state: 'uploading'\n                    })\n                  };\n                });\n\n              case 3:\n                return _context3.abrupt(\"return\", _this._uploadFile(id));\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_uploadImage\",\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(id) {\n        var img, file, response, alreadyRemoved;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                img = _this.state.imageUploads[id];\n\n                if (img) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\");\n\n              case 3:\n                file = img.file;\n                _context4.next = 6;\n                return _this.setState(function (prevState) {\n                  return {\n                    imageUploads: prevState.imageUploads.setIn([id, 'state'], 'uploading')\n                  };\n                });\n\n              case 6:\n                response = {};\n                response = {};\n                _context4.prev = 8;\n\n                if (!_this.props.doImageUploadRequest) {\n                  _context4.next = 15;\n                  break;\n                }\n\n                _context4.next = 12;\n                return _this.props.doImageUploadRequest(file, _this.props.channel);\n\n              case 12:\n                response = _context4.sent;\n                _context4.next = 18;\n                break;\n\n              case 15:\n                _context4.next = 17;\n                return _this.props.channel.sendImage(file);\n\n              case 17:\n                response = _context4.sent;\n\n              case 18:\n                _context4.next = 28;\n                break;\n\n              case 20:\n                _context4.prev = 20;\n                _context4.t0 = _context4[\"catch\"](8);\n                console.warn(_context4.t0);\n                alreadyRemoved = false;\n                _context4.next = 26;\n                return _this.setState(function (prevState) {\n                  var image = prevState.imageUploads[id];\n\n                  if (!image) {\n                    alreadyRemoved = true;\n                    return {};\n                  }\n\n                  return {\n                    imageUploads: prevState.imageUploads.setIn([id, 'state'], 'failed')\n                  };\n                });\n\n              case 26:\n                if (!alreadyRemoved) {\n                  _this.props.errorHandler(_context4.t0, 'upload-image', {\n                    feedGroup: _this.props.feedGroup,\n                    userId: _this.props.userId\n                  });\n                }\n\n                return _context4.abrupt(\"return\");\n\n              case 28:\n                _this.setState(function (prevState) {\n                  return {\n                    imageUploads: prevState.imageUploads.setIn([id, 'state'], 'finished').setIn([id, 'url'], response.file)\n                  };\n                });\n\n              case 29:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[8, 20]]);\n      }));\n\n      return function (_x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_uploadFile\",\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(id) {\n        var upload, file, response, alreadyRemoved;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                upload = _this.state.fileUploads[id];\n\n                if (upload) {\n                  _context5.next = 3;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\");\n\n              case 3:\n                file = upload.file;\n                _context5.next = 6;\n                return _this.setState(function (prevState) {\n                  return {\n                    imageUploads: prevState.imageUploads.setIn([id, 'state'], 'uploading')\n                  };\n                });\n\n              case 6:\n                response = {};\n                response = {};\n                _context5.prev = 8;\n\n                if (!_this.props.doFileUploadRequest) {\n                  _context5.next = 15;\n                  break;\n                }\n\n                _context5.next = 12;\n                return _this.props.doFileUploadRequest(file, _this.props.channel);\n\n              case 12:\n                response = _context5.sent;\n                _context5.next = 18;\n                break;\n\n              case 15:\n                _context5.next = 17;\n                return _this.props.channel.sendFile(file);\n\n              case 17:\n                response = _context5.sent;\n\n              case 18:\n                _context5.next = 27;\n                break;\n\n              case 20:\n                _context5.prev = 20;\n                _context5.t0 = _context5[\"catch\"](8);\n                console.warn(_context5.t0);\n                alreadyRemoved = false;\n                _context5.next = 26;\n                return _this.setState(function (prevState) {\n                  var image = prevState.imageUploads[id];\n\n                  if (!image) {\n                    alreadyRemoved = true;\n                    return {};\n                  }\n\n                  return {\n                    fileUploads: prevState.fileUploads.setIn([id, 'state'], 'failed')\n                  };\n                });\n\n              case 26:\n                if (!alreadyRemoved) {\n                  _this.props.errorHandler(_context5.t0, 'upload-file', {\n                    feedGroup: _this.props.feedGroup,\n                    userId: _this.props.userId\n                  });\n                }\n\n              case 27:\n                _this.setState(function (prevState) {\n                  return {\n                    fileUploads: prevState.fileUploads.setIn([id, 'state'], 'finished').setIn([id, 'url'], response.file)\n                  };\n                });\n\n              case 28:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[8, 20]]);\n      }));\n\n      return function (_x5) {\n        return _ref5.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_removeImage\", function (id) {\n      // TODO: cancel upload if still uploading\n      _this.setState(function (prevState) {\n        var img = prevState.imageUploads[id];\n\n        if (!img) {\n          return {};\n        }\n\n        return {\n          imageUploads: prevState.imageUploads.set(id, undefined),\n          // remove\n          imageOrder: prevState.imageOrder.filter(function (_id) {\n            return id !== _id;\n          })\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_removeFile\", function (id) {\n      // TODO: cancel upload if still uploading\n      _this.setState(function (prevState) {\n        var upload = prevState.fileUploads[id];\n\n        if (!upload) {\n          return {};\n        }\n\n        return {\n          fileUploads: prevState.fileUploads.set(id, undefined),\n          // remove\n          fileOrder: prevState.fileOrder.filter(function (_id) {\n            return id !== _id;\n          })\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_onPaste\",\n    /*#__PURE__*/\n    function () {\n      var _ref6 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(event) {\n        var items, plainTextPromise, _iteratorNormalCompletion5, _didIteratorError5, _iteratorError5, _loop, _iterator5, _step5, _ret, fileLikes, s;\n\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                // TODO: Move this handler to package with ImageDropzone\n                items = event.clipboardData.items;\n\n                if (dataTransferItemsHaveFiles(items)) {\n                  _context6.next = 3;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\");\n\n              case 3:\n                event.preventDefault(); // Get a promise for the plain text in case no files are\n                // found. This needs to be done here because chrome cleans\n                // up the DataTransferItems after resolving of a promise.\n\n                _iteratorNormalCompletion5 = true;\n                _didIteratorError5 = false;\n                _iteratorError5 = undefined;\n                _context6.prev = 7;\n\n                _loop = function _loop() {\n                  var item = _step5.value;\n\n                  if (item.kind === 'string' && item.type === 'text/plain') {\n                    plainTextPromise = new Promise(function (resolve) {\n                      item.getAsString(function (s) {\n                        resolve(s);\n                      });\n                    });\n                    return \"break\";\n                  }\n                };\n\n                _iterator5 = items[Symbol.iterator]();\n\n              case 10:\n                if (_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done) {\n                  _context6.next = 17;\n                  break;\n                }\n\n                _ret = _loop();\n\n                if (!(_ret === \"break\")) {\n                  _context6.next = 14;\n                  break;\n                }\n\n                return _context6.abrupt(\"break\", 17);\n\n              case 14:\n                _iteratorNormalCompletion5 = true;\n                _context6.next = 10;\n                break;\n\n              case 17:\n                _context6.next = 23;\n                break;\n\n              case 19:\n                _context6.prev = 19;\n                _context6.t0 = _context6[\"catch\"](7);\n                _didIteratorError5 = true;\n                _iteratorError5 = _context6.t0;\n\n              case 23:\n                _context6.prev = 23;\n                _context6.prev = 24;\n\n                if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n                  _iterator5.return();\n                }\n\n              case 26:\n                _context6.prev = 26;\n\n                if (!_didIteratorError5) {\n                  _context6.next = 29;\n                  break;\n                }\n\n                throw _iteratorError5;\n\n              case 29:\n                return _context6.finish(26);\n\n              case 30:\n                return _context6.finish(23);\n\n              case 31:\n                _context6.next = 33;\n                return dataTransferItemsToFiles(items);\n\n              case 33:\n                fileLikes = _context6.sent;\n\n                if (!fileLikes.length) {\n                  _context6.next = 37;\n                  break;\n                }\n\n                _this._uploadNewFiles(fileLikes);\n\n                return _context6.abrupt(\"return\");\n\n              case 37:\n                if (!plainTextPromise) {\n                  _context6.next = 42;\n                  break;\n                }\n\n                _context6.next = 40;\n                return plainTextPromise;\n\n              case 40:\n                s = _context6.sent;\n\n                _this.insertText(s);\n\n              case 42:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[7, 19, 23, 31], [24,, 26, 30]]);\n      }));\n\n      return function (_x6) {\n        return _ref6.apply(this, arguments);\n      };\n    }());\n\n    var imageOrder = [];\n    var imageUploads = {};\n    var fileOrder = [];\n    var fileUploads = {};\n    var _attachments = [];\n    var _text = '';\n\n    if (props.message) {\n      _text = props.message.text;\n      var _iteratorNormalCompletion6 = true;\n      var _didIteratorError6 = false;\n      var _iteratorError6 = undefined;\n\n      try {\n        for (var _iterator6 = props.message.attachments[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n          var attach = _step6.value;\n\n          if (attach.type === 'image') {\n            var id = generateRandomId();\n            imageOrder.push(id);\n            imageUploads[id] = {\n              id: id,\n              url: attach.image_url,\n              state: 'finished',\n              file: {\n                name: attach.fallback\n              }\n            };\n          } else if (attach.type === 'file') {\n            var _id4 = generateRandomId();\n\n            fileOrder.push(_id4);\n            fileUploads[_id4] = {\n              id: _id4,\n              url: attach.asset_url,\n              state: 'finished',\n              file: {\n                name: attach.title,\n                type: attach.mime_type,\n                size: attach.file_size\n              }\n            };\n          } else {\n            _attachments.push(attach);\n          }\n        }\n      } catch (err) {\n        _didIteratorError6 = true;\n        _iteratorError6 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion6 && _iterator6.return != null) {\n            _iterator6.return();\n          }\n        } finally {\n          if (_didIteratorError6) {\n            throw _iteratorError6;\n          }\n        }\n      }\n    }\n\n    _this.state = {\n      text: _text,\n      attachments: _attachments,\n      imageOrder: imageOrder,\n      imageUploads: Immutable(imageUploads),\n      fileOrder: fileOrder,\n      fileUploads: Immutable(fileUploads),\n      emojiPickerIsOpen: false,\n      filePanelIsOpen: false\n    };\n    _this.textareaRef = React.createRef();\n    _this.emojiPickerRef = React.createRef();\n    _this.panelRef = React.createRef();\n    return _this;\n  }\n\n  _createClass(MessageInput, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.focus) {\n        this.textareaRef.current.focus();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener('click', this.closeEmojiPicker, false);\n      document.removeEventListener('click', this.hideFilePanel, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var Input = this.props.Input;\n      var handlers = {\n        uploadNewFiles: this._uploadNewFiles,\n        removeImage: this._removeImage,\n        uploadImage: this._uploadImage,\n        removeFile: this._removeFile,\n        uploadFile: this._uploadFile,\n        emojiPickerRef: this.emojiPickerRef,\n        panelRef: this.panelRef,\n        textareaRef: this.textareaRef,\n        onSelectEmoji: this.onSelectEmoji,\n        getUsers: this.getUsers,\n        getCommands: this.getCommands,\n        handleSubmit: this.handleSubmit,\n        handleChange: this.handleChange,\n        onPaste: this._onPaste,\n        openEmojiPicker: this.openEmojiPicker\n      };\n      return React.createElement(Input, _extends({}, this.props, this.state, handlers));\n    }\n  }]);\n\n  return MessageInput;\n}(PureComponent);\n\n_defineProperty(MessageInput, \"propTypes\", {\n  /** Set focus to the text input if this is enabled */\n  focus: PropTypes.bool.isRequired,\n\n  /** Disable input */\n  disabled: PropTypes.bool.isRequired,\n\n  /** Grow the textarea while you're typing */\n  grow: PropTypes.bool.isRequired,\n\n  /** Via Context: the channel that we're sending the message to */\n  channel: PropTypes.object.isRequired,\n\n  /** Via Context: the users currently typing, passed from the Channel component */\n  typing: PropTypes.object.isRequired,\n  // /** Set textarea to be disabled */\n  // disabled: PropTypes.bool,\n\n  /** The parent message object when replying on a thread */\n  parent: PropTypes.object,\n\n  /** The component handling how the input is rendered */\n  Input: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** Override image upload request */\n  doImageUploadRequest: PropTypes.func,\n\n  /** Override file upload request */\n  doFileUploadRequest: PropTypes.func\n});\n\n_defineProperty(MessageInput, \"defaultProps\", {\n  focus: false,\n  disabled: false,\n  grow: true,\n  Input: MessageInputLarge\n});\n\nMessageInput = withChannelContext(MessageInput);\n/**\n * @example ./docs/EditMessageForm.md\n */\n\nvar EditMessageForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(EditMessageForm, _React$Component);\n\n  function EditMessageForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, EditMessageForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(EditMessageForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderUploads\", function () {\n      return React.createElement(React.Fragment, null, _this.props.imageOrder.length > 0 && React.createElement(ImagePreviewer, {\n        imageUploads: _this.props.imageOrder.map(function (id) {\n          return _this.props.imageUploads[id];\n        }),\n        handleRemove: _this.props.removeImage,\n        handleRetry: _this.props.uploadImage,\n        handleFiles: _this.props.uploadNewFiles\n      }), _this.props.fileOrder.length > 0 && React.createElement(FilePreviewer, {\n        uploads: _this.props.fileOrder.map(function (id) {\n          return _this.props.fileUploads[id];\n        }),\n        handleRemove: _this.props.removeFile,\n        handleRetry: _this.props.uploadFile,\n        handleFiles: _this.props.uploadNewFiles\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderEmojiPicker\", function () {\n      if (_this.props.emojiPickerIsOpen) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__small-message-input-emojipicker\",\n          ref: _this.props.emojiPickerRef\n        }, React.createElement(Picker, {\n          emoji: \"point_up\",\n          title: \"Pick your emoji\\u2026\",\n          onSelect: _this.props.onSelectEmoji,\n          color: \"#006CFF\",\n          showPreview: false\n        }));\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(EditMessageForm, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"str-chat__edit-message-form\"\n      }, React.createElement(ImageDropzone, {\n        handleFiles: this.props.uploadNewFiles\n      }, React.createElement(\"form\", {\n        onSubmit: this.props.handleSubmit\n      }, this.renderEmojiPicker(), this.renderUploads(), this.props.emojiPickerIsOpen && React.createElement(\"div\", {\n        className: \"str-chat__input--emojipicker\",\n        ref: this.props.emojiPickerRef\n      }, React.createElement(Picker, {\n        emoji: \"point_up\",\n        title: \"Pick your emoji\\u2026\",\n        onSelect: this.props.onSelectEmoji,\n        color: \"#006CFF\"\n      })), React.createElement(ChatAutoComplete, {\n        users: this.props.getUsers(),\n        commands: this.props.getCommands(),\n        innerRef: this.props.textareaRef,\n        handleSubmit: this.props.handleSubmit,\n        onChange: this.props.handleChange,\n        value: this.props.text,\n        rows: 1,\n        onPaste: this.props.onPaste,\n        grow: this.props.grow\n      }), React.createElement(\"div\", {\n        className: \"str-chat__message-team-form-footer\"\n      }, React.createElement(\"div\", {\n        className: \"str-chat__edit-message-form-options\"\n      }, React.createElement(\"span\", {\n        className: \"str-chat__input-emojiselect\",\n        onClick: this.props.openEmojiPicker\n      }, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\",\n        fillRule: \"evenodd\"\n      }))), React.createElement(FileUploadButton, {\n        multiple: true,\n        handleFiles: this.props.uploadNewFiles\n      }, React.createElement(\"span\", {\n        className: \"str-chat__input-fileupload\"\n      }, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M7 .5c3.59 0 6.5 2.91 6.5 6.5s-2.91 6.5-6.5 6.5S.5 10.59.5 7 3.41.5 7 .5zm0 12c3.031 0 5.5-2.469 5.5-5.5S10.031 1.5 7 1.5A5.506 5.506 0 0 0 1.5 7c0 3.034 2.469 5.5 5.5 5.5zM7.506 3v3.494H11v1.05H7.506V11h-1.05V7.544H3v-1.05h3.456V3h1.05z\",\n        fillRule: \"nonzero\"\n      }))))), React.createElement(\"div\", null, React.createElement(\"button\", {\n        onClick: this.props.clearEditingState\n      }, \"Cancel\"), React.createElement(\"button\", {\n        type: \"submit\"\n      }, \"Send\"))))));\n    }\n  }]);\n\n  return EditMessageForm;\n}(React.Component);\n\n_defineProperty(EditMessageForm, \"propTypes\", {\n  /** Set focus to the text input if this is enabled */\n  focus: PropTypes.bool,\n\n  /** Grow the textarea while you're typing */\n  grow: PropTypes.bool,\n\n  /** Disable the textarea */\n  disabled: PropTypes.bool\n});\n\n_defineProperty(EditMessageForm, \"defaultProps\", {\n  grow: true,\n  focus: false,\n  disabled: false\n});\n/**\n * MessageSimple - Render component, should be used together with the Message component\n *\n * @example ./docs/MessageSimple.md\n * @extends PureComponent\n */\n\n\nvar MessageSimple =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(MessageSimple, _PureComponent);\n\n  function MessageSimple() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MessageSimple);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MessageSimple)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      isFocused: false,\n      actionsBoxOpen: false,\n      showDetailedReactions: false\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"messageActionsRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"reactionSelectorRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_onClickOptionsAction\", function () {\n      _this.setState({\n        actionsBoxOpen: true\n      }, function () {\n        return document.addEventListener('click', _this.hideOptions, false);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_hideOptions\", function () {\n      _this.setState({\n        actionsBoxOpen: false\n      });\n\n      document.removeEventListener('click', _this.hideOptions, false);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_clickReactionList\", function () {\n      _this.setState(function () {\n        return {\n          showDetailedReactions: true\n        };\n      }, function () {\n        document.addEventListener('click', _this._closeDetailedReactions);\n        document.addEventListener('touchend', _this._closeDetailedReactions);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_closeDetailedReactions\", function (e) {\n      if (!_this.reactionSelectorRef.current.reactionSelector.current.contains(e.target)) {\n        _this.setState(function () {\n          return {\n            showDetailedReactions: false\n          };\n        }, function () {\n          document.removeEventListener('click', _this._closeDetailedReactions);\n          document.removeEventListener('touchend', _this._closeDetailedReactions);\n        });\n      } else {\n        return {};\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"formatArray\", function (arr) {\n      var outStr = '';\n      var slicedArr = arr.map(function (item) {\n        return item.name || item.id;\n      }).slice(0, 5);\n      var restLength = arr.length - slicedArr.length;\n      var lastStr = restLength > 0 ? ' and ' + restLength + ' more' : '';\n\n      if (slicedArr.length === 1) {\n        outStr = slicedArr[0] + ' ';\n      } else if (slicedArr.length === 2) {\n        //joins all with \"and\" but =no commas\n        //example: \"bob and sam\"\n        outStr = slicedArr.join(' and ') + ' ';\n      } else if (slicedArr.length > 2) {\n        //joins all with commas, but last one gets \", and\" (oxford comma!)\n        //example: \"bob, joe, and sam\"\n        outStr = slicedArr.join(', ') + lastStr;\n      }\n\n      return outStr;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderStatus\", function () {\n      var message = _this.props;\n\n      if (!_this.isMine() || _this.props.message.type === 'error') {\n        return null;\n      }\n\n      var justReadByMe = message.readBy.length === 1 && message.readBy[0].id === _this.props.client.user.id;\n\n      if (_this.props.message.status === 'sending') {\n        return React.createElement(\"span\", {\n          className: \"str-chat__message-simple-status\"\n        }, React.createElement(Tooltip, null, \"Sending...\"), React.createElement(LoadingIndicator, null));\n      } else if (message.readBy.length !== 0 && !_this.props.threadList && !justReadByMe) {\n        return React.createElement(\"span\", {\n          className: \"str-chat__message-simple-status\"\n        }, React.createElement(Tooltip, null, _this.formatArray(message.readBy)), React.createElement(Avatar, {\n          name: _this.props.readBy[0].id,\n          image: _this.props.readBy[0].image,\n          size: 15\n        }), message.readBy.length > 1 && React.createElement(\"span\", {\n          className: \"str-chat__message-simple-status-number\"\n        }, message.readBy.length));\n      } else if (_this.props.message.status === 'received' && _this.props.message.id === _this.props.lastReceivedId && !_this.props.threadList) {\n        return React.createElement(\"span\", {\n          className: \"str-chat__message-simple-status\"\n        }, React.createElement(Tooltip, null, \"Delivered\"), React.createElement(\"svg\", {\n          width: \"16\",\n          height: \"16\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm3.72 6.633a.955.955 0 1 0-1.352-1.352L6.986 8.663 5.633 7.31A.956.956 0 1 0 4.28 8.663l2.029 2.028a.956.956 0 0 0 1.353 0l4.058-4.058z\",\n          fill: \"#006CFF\",\n          fillRule: \"evenodd\"\n        })));\n      } else {\n        return null;\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(MessageSimple, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (!this.props.message.deleted_at) {\n        document.removeEventListener('click', this._closeDetailedReactions);\n        document.removeEventListener('touchend', this._closeDetailedReactions);\n      }\n    }\n  }, {\n    key: \"isMine\",\n    value: function isMine() {\n      return this.props.Message.isMyMessage(this.props.message);\n    }\n  }, {\n    key: \"renderOptions\",\n    value: function renderOptions() {\n      if (this.props.message.type === 'error' || this.props.initialMessage) {\n        return;\n      }\n\n      var _this$props = this.props,\n          message = _this$props.message,\n          Message = _this$props.Message;\n\n      if (this.isMine()) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__message-simple__actions\"\n        }, React.createElement(\"div\", {\n          onClick: this._onClickOptionsAction,\n          className: \"str-chat__message-simple__actions__action str-chat__message-simple__actions__action--options\"\n        }, React.createElement(MessageActionsBox, {\n          Message: this.props.Message,\n          open: this.state.actionsBoxOpen,\n          message: this.props.message,\n          messageListRect: this.props.messageListRect,\n          mine: this.isMine()\n        }), React.createElement(\"svg\", {\n          width: \"11\",\n          height: \"4\",\n          viewBox: \"0 0 11 4\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M1.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z\",\n          fillRule: \"nonzero\"\n        }))), !this.props.threadList && React.createElement(\"div\", {\n          onClick: this.props.openThread,\n          className: \"str-chat__message-simple__actions__action str-chat__message-simple__actions__action--thread\"\n        }, React.createElement(\"svg\", {\n          width: \"14\",\n          height: \"10\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M8.516 3c4.78 0 4.972 6.5 4.972 6.5-1.6-2.906-2.847-3.184-4.972-3.184v2.872L3.772 4.994 8.516.5V3zM.484 5l4.5-4.237v1.78L2.416 5l2.568 2.125v1.828L.484 5z\",\n          fillRule: \"evenodd\"\n        }))), React.createElement(\"div\", {\n          className: \"str-chat__message-simple__actions__action str-chat__message-simple__actions__action--reactions\",\n          onClick: this._clickReactionList\n        }, React.createElement(\"svg\", {\n          width: \"16\",\n          height: \"14\",\n          viewBox: \"0 0 16 14\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\",\n          fillRule: \"evenodd\"\n        }))));\n      } else {\n        return React.createElement(\"div\", {\n          className: \"str-chat__message-simple__actions\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__message-simple__actions__action str-chat__message-simple__actions__action--reactions\",\n          onClick: this._clickReactionList\n        }, React.createElement(\"svg\", {\n          width: \"14\",\n          height: \"14\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\",\n          fillRule: \"evenodd\"\n        }))), !this.props.threadList && React.createElement(\"div\", {\n          onClick: this.props.openThread,\n          className: \"str-chat__message-simple__actions__action str-chat__message-simple__actions__action--thread\"\n        }, React.createElement(\"svg\", {\n          width: \"14\",\n          height: \"10\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M8.516 3c4.78 0 4.972 6.5 4.972 6.5-1.6-2.906-2.847-3.184-4.972-3.184v2.872L3.772 4.994 8.516.5V3zM.484 5l4.5-4.237v1.78L2.416 5l2.568 2.125v1.828L.484 5z\",\n          fillRule: \"evenodd\"\n        }))), (Message.canEditMessage(message) || Message.canDeleteMessage(message)) && React.createElement(\"div\", {\n          onClick: this._onClickOptionsAction,\n          className: \"str-chat__message-simple__actions__action str-chat__message-simple__actions__action--options\"\n        }, React.createElement(MessageActionsBox, {\n          Message: Message,\n          open: this.state.actionsBoxOpen,\n          message: message,\n          messageListRect: this.props.messageListRect,\n          mine: this.isMine()\n        }), React.createElement(\"svg\", {\n          width: \"11\",\n          height: \"4\",\n          viewBox: \"0 0 11 4\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M1.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z\",\n          fillRule: \"nonzero\"\n        }))));\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var message = this.props.message;\n      var Attachment$$1 = this.props.Attachment;\n      var when = moment(message.created_at).calendar();\n      var messageClasses = this.isMine() ? 'str-chat__message str-chat__message--me str-chat__message-simple str-chat__message-simple--me' : 'str-chat__message str-chat__message-simple';\n      var hasAttachment = Boolean(message && message.attachments && message.attachments.length);\n      var images = hasAttachment && message.attachments.filter(function (item) {\n        return item.type === 'image';\n      });\n      var hasReactions = Boolean(message.latest_reactions && message.latest_reactions.length);\n\n      if (message.type === 'message.read' || message.type === 'message.date') {\n        return null;\n      }\n\n      if (message.deleted_at) {\n        return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n          key: message.id,\n          className: \"\".concat(messageClasses, \" str-chat__message--deleted \").concat(message.type, \" \")\n        }, React.createElement(\"div\", {\n          className: \"str-chat__message--deleted-inner\"\n        }, message.user.id === this.props.client.user.id ? 'You' : message.user.name || message.user.id, ' ', \"deleted this message...\"), !this.props.threadList && message.reply_count !== 0 && React.createElement(\"div\", {\n          className: \"str-chat__message-simple-reply-button\"\n        }, React.createElement(MessageRepliesCountButton, {\n          onClick: this.props.openThread,\n          reply_count: message.reply_count\n        }))));\n      }\n\n      return React.createElement(React.Fragment, null, this.props.editing && React.createElement(Modal, {\n        open: this.props.editing,\n        onClose: this.props.clearEditingState\n      }, React.createElement(MessageInput, {\n        Input: EditMessageForm,\n        message: this.props.message,\n        clearEditingState: this.props.clearEditingState,\n        updateMessage: this.props.updateMessage\n      })), React.createElement(\"div\", {\n        key: message.id,\n        className: \"\\n\\t\\t\\t\\t\\t\\t\".concat(messageClasses, \"\\n\\t\\t\\t\\t\\t\\tstr-chat__message--\").concat(message.type, \"\\n\\t\\t\\t\\t\\t\\tstr-chat__message--\").concat(message.status, \"\\n\\t\\t\\t\\t\\t\\t\").concat(message.text ? 'str-chat__message--has-text' : 'has-no-text', \"\\n\\t\\t\\t\\t\\t\\t\").concat(hasAttachment ? 'str-chat__message--has-attachment' : '', \"\\n\\t\\t\\t\\t\\t\\t\").concat(hasReactions ? 'str-chat__message--with-reactions' : '', \"\\n\\t\\t\\t\\t\\t\").trim(),\n        onMouseLeave: this._hideOptions,\n        ref: this.messageRef\n      }, this.renderStatus(), React.createElement(Avatar, {\n        image: message.user.image,\n        name: message.user.name || message.user.id\n      }), React.createElement(\"div\", {\n        className: \"str-chat__message-inner\",\n        onClick: message.status === 'failed' ? this.props.retrySendMessage.bind(this, message) : null\n      }, !message.text && React.createElement(React.Fragment, null, this.renderOptions(), hasReactions > 0 && !this.state.showDetailedReactions && React.createElement(ReactionsList, {\n        mine: this.isMine(),\n        messageList: this.props.messageListRect,\n        position: this.isMine() ? 'right' : 'left',\n        reactions: message.latest_reactions,\n        reaction_counts: message.reaction_counts,\n        onClick: this._clickReactionList\n      }), this.state.showDetailedReactions && React.createElement(ReactionSelector, {\n        mine: this.isMine(),\n        handleReaction: this.props.handleReaction,\n        actionsEnabled: this.props.actionsEnabled,\n        detailedView: true,\n        reaction_counts: message.reaction_counts,\n        latest_reactions: message.latest_reactions,\n        messageList: this.props.messageListRect,\n        ref: this.reactionSelectorRef\n      })), React.createElement(\"div\", null, hasAttachment && images.length <= 1 && message.attachments.map(function (attachment, index) {\n        return React.createElement(Attachment$$1, {\n          key: \"\".concat(message.id, \"-\").concat(index),\n          attachment: attachment,\n          actionHandler: _this2.props.handleAction\n        });\n      })), images.length > 1 && React.createElement(Gallery, {\n        images: images\n      }), message.text && React.createElement(\"div\", {\n        className: \"str-chat__message-text\"\n      }, React.createElement(\"div\", {\n        className: \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tstr-chat__message-text-inner str-chat__message-simple-text-inner\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\".concat(this.state.isFocused ? 'str-chat__message-text-inner--focused' : '', \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\").concat(hasAttachment ? 'str-chat__message-text-inner--has-attachment' : '', \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\").concat(isOnlyEmojis(message.text) ? 'str-chat__message-simple-text-inner--is-emoji' : '', \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\").trim()\n      }, message.type === 'error' && React.createElement(\"div\", {\n        className: \"str-chat__simple-message--error-message\"\n      }, \"Error \\xB7 Unsent\"), message.status === 'failed' && React.createElement(\"div\", {\n        className: \"str-chat__simple-message--error-message\"\n      }, \"Message Failed \\xB7 Click to try again\"), renderText(message.text), hasReactions > 0 && !this.state.showDetailedReactions && React.createElement(ReactionsList, {\n        mine: this.isMine(),\n        messageList: this.props.messageListRect,\n        position: this.isMine() ? 'right' : 'left',\n        reactions: message.latest_reactions,\n        reaction_counts: message.reaction_counts,\n        onClick: this._clickReactionList\n      }), this.state.showDetailedReactions && React.createElement(ReactionSelector, {\n        mine: this.isMine(),\n        handleReaction: this.props.handleReaction,\n        actionsEnabled: this.props.actionsEnabled,\n        detailedView: true,\n        reaction_counts: message.reaction_counts,\n        latest_reactions: message.latest_reactions,\n        messageList: this.props.messageListRect,\n        ref: this.reactionSelectorRef\n      })), message.text && this.renderOptions()), !this.props.threadList && message.reply_count !== 0 && React.createElement(\"div\", {\n        className: \"str-chat__message-simple-reply-button\"\n      }, React.createElement(MessageRepliesCountButton, {\n        onClick: this.props.openThread,\n        reply_count: message.reply_count\n      })), React.createElement(\"div\", {\n        className: \"str-chat__message-data str-chat__message-simple-data\"\n      }, !this.isMine() ? React.createElement(\"span\", {\n        className: \"str-chat__message-simple-name\"\n      }, message.user.name || message.user.id) : null, React.createElement(\"span\", {\n        className: \"str-chat__message-simple-timestamp\"\n      }, when)))));\n    }\n  }]);\n\n  return MessageSimple;\n}(PureComponent);\n\n_defineProperty(MessageSimple, \"propTypes\", {\n  /** The message object */\n  message: PropTypes.object,\n\n  /** The attachment component */\n  Attachment: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** The message component, most logic is delegated to this component */\n  Message: PropTypes.oneOfType([PropTypes.node, PropTypes.func, PropTypes.object]).isRequired\n});\n\n_defineProperty(MessageSimple, \"defaultProps\", {\n  Attachment: Attachment\n});\n/**\n * Message - A high level component which implements all the logic required for a message.\n * The actual rendering of the message is delegated via the \"Message\" property\n *\n * @example ./docs/Message.md\n * @extends Component\n */\n\n\nvar Message =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Message, _Component);\n\n  function Message(props) {\n    var _this;\n\n    _classCallCheck(this, Message);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Message).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"isMyMessage\", function (message) {\n      return _this.props.client.user.id === message.user.id;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"isAdmin\", function () {\n      return _this.props.client.user.role === 'admin';\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"canEditMessage\", function (message) {\n      return _this.isMyMessage(message) || _this.isAdmin();\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"canDeleteMessage\", function (message) {\n      return _this.isMyMessage(message) || _this.isAdmin();\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleFlag\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var message;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n                message = _this.props.message;\n                _context.next = 4;\n                return _this.props.client.flagMessage(message.id);\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleMute\",\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(event) {\n        var message;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                event.preventDefault();\n                message = _this.props.message;\n                _context2.next = 4;\n                return _this.props.client.flagMessage(message.user.id);\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleEdit\", function () {\n      _this.props.setEditingState(_this.props.message);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleDelete\",\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(event) {\n        var message, data$$1;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                event.preventDefault();\n                message = _this.props.message;\n                _context3.next = 4;\n                return _this.props.client.deleteMessage(message.id);\n\n              case 4:\n                data$$1 = _context3.sent;\n\n                _this.props.updateMessage(data$$1.message);\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleReaction\",\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(reactionType, event) {\n        var userExistingReaction, currentUser, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _reaction, originalMessage, updatedMessage, reactionChangePromise, messageID, tmpReaction, reaction;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (event !== undefined && event.preventDefault) {\n                  event.preventDefault();\n                }\n\n                userExistingReaction = null;\n                currentUser = _this.props.client.userID;\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context4.prev = 6;\n\n                for (_iterator = _this.props.message.own_reactions[Symbol.iterator](); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  _reaction = _step.value; // own user should only ever contain the current user id\n                  // just in case we check to prevent bugs with message updates from breaking reactions\n\n                  if (currentUser === _reaction.user.id && _reaction.type === reactionType) {\n                    userExistingReaction = _reaction;\n                  } else if (currentUser !== _reaction.user.id) {\n                    console.warn(\"message.own_reactions contained reactions from a different user, this indicates a bug\");\n                  }\n                }\n\n                _context4.next = 14;\n                break;\n\n              case 10:\n                _context4.prev = 10;\n                _context4.t0 = _context4[\"catch\"](6);\n                _didIteratorError = true;\n                _iteratorError = _context4.t0;\n\n              case 14:\n                _context4.prev = 14;\n                _context4.prev = 15;\n\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                  _iterator.return();\n                }\n\n              case 17:\n                _context4.prev = 17;\n\n                if (!_didIteratorError) {\n                  _context4.next = 20;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 20:\n                return _context4.finish(17);\n\n              case 21:\n                return _context4.finish(14);\n\n              case 22:\n                originalMessage = _this.props.message;\n                updatedMessage = originalMessage.asMutable();\n                /*\n                - Add the reaction to the local state\n                - Make the API call in the background\n                - If it fails, revert to the old message...\n                 */\n\n                if (userExistingReaction) {\n                  // remove the reaction..\n                  updatedMessage.latest_reactions = updatedMessage.latest_reactions.filter(function (value) {\n                    return value !== userExistingReaction;\n                  });\n                  updatedMessage.own_reactions = updatedMessage.own_reactions.filter(function (value) {\n                    return value !== userExistingReaction;\n                  });\n                  reactionChangePromise = _this.props.channel.deleteReaction(_this.props.message.id, userExistingReaction.type);\n                } else {\n                  // add the reaction\n                  messageID = _this.props.message.id;\n                  tmpReaction = {\n                    type: reactionType,\n                    created_at: new Date(),\n                    user: _this.props.client.user\n                  };\n                  reaction = {\n                    type: reactionType\n                  };\n                  updatedMessage.latest_reactions = updatedMessage.latest_reactions.concat([tmpReaction]);\n                  updatedMessage.own_reactions = updatedMessage.own_reactions.concat([tmpReaction]);\n                  reactionChangePromise = _this.props.channel.sendReaction(messageID, reaction);\n                }\n\n                _context4.prev = 25; // immediately apply the state change\n\n                _this.props.updateMessage(updatedMessage); // only wait for the API call after the state is updated\n\n\n                _context4.next = 29;\n                return reactionChangePromise;\n\n              case 29:\n                _context4.next = 34;\n                break;\n\n              case 31:\n                _context4.prev = 31;\n                _context4.t1 = _context4[\"catch\"](25); // revert to the original message if the API call fails\n\n                _this.props.updateMessage(originalMessage);\n\n              case 34:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[6, 10, 14, 22], [15,, 17, 21], [25, 31]]);\n      }));\n\n      return function (_x4, _x5) {\n        return _ref4.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleAction\",\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(name, value, event) {\n        var messageID, formData, data$$1;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                event.preventDefault();\n                messageID = _this.props.message.id;\n                formData = {};\n                formData[name] = value;\n                _context5.next = 6;\n                return _this.props.channel.sendAction(messageID, formData);\n\n              case 6:\n                data$$1 = _context5.sent;\n\n                if (data$$1 && data$$1.message) {\n                  _this.props.updateMessage(data$$1.message);\n                } else {\n                  _this.props.removeMessage(_this.props.message);\n                }\n\n              case 8:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      return function (_x6, _x7, _x8) {\n        return _ref5.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleRetry\",\n    /*#__PURE__*/\n    function () {\n      var _ref6 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(message) {\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return _this.props.retrySendMessage(message);\n\n              case 2:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      return function (_x9) {\n        return _ref6.apply(this, arguments);\n      };\n    }());\n\n    _this.state = {\n      loading: false\n    };\n    return _this;\n  }\n\n  _createClass(Message, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps) {\n      // since there are many messages its important to only rerender messages when needed.\n      var shouldUpdate = nextProps.message !== this.props.message;\n\n      if (!shouldUpdate && !deepequal(nextProps.readBy, this.props.readBy)) {\n        shouldUpdate = true;\n      } // group style often changes for the last 3 messages...\n\n\n      if (!shouldUpdate && !deepequal(nextProps.groupStyles, this.props.groupStyles)) {\n        shouldUpdate = true;\n      } // if lastreceivedId changesm, message should update.\n\n\n      if (!shouldUpdate && !deepequal(nextProps.lastReceivedId, this.props.lastReceivedId)) {\n        shouldUpdate = true;\n      } // editing is the last one which can trigger a change..\n\n\n      if (!shouldUpdate && nextProps.editing !== this.props.editing) {\n        shouldUpdate = true;\n      } // editing is the last one which can trigger a change..\n\n\n      if (!shouldUpdate && nextProps.messageListRect !== this.props.messageListRect) {\n        shouldUpdate = true;\n      }\n\n      return shouldUpdate;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var message = this.props.message;\n      var actionsEnabled = message.type === 'regular' && message.status === 'received';\n      var Component$$1 = this.props.Message;\n      return React.createElement(Component$$1, _extends({}, this.props, {\n        actionsEnabled: actionsEnabled,\n        Message: this,\n        handleReaction: this.handleReaction,\n        handleFlag: this.handleFlag,\n        handleMute: this.handleMute,\n        handleAction: this.handleAction,\n        handleReply: this.handleReply,\n        handleRetry: this.handleRetry,\n        openThread: this.props.openThread && this.props.openThread.bind(this, message)\n      }));\n    }\n  }]);\n\n  return Message;\n}(Component);\n\n_defineProperty(Message, \"propTypes\", {\n  /** The message object */\n  message: PropTypes.object.isRequired,\n\n  /** The client connection object for connecting to Stream */\n  client: PropTypes.object.isRequired,\n\n  /** The current channel this message is displayed in */\n  channel: PropTypes.object.isRequired,\n\n  /** A list of users that have read this message **/\n  readBy: PropTypes.array,\n\n  /** groupStyles, a list of styles to apply to this message. ie. top, bottom, single etc */\n  groupStyles: PropTypes.array,\n\n  /** Editing, if the message is currently being edited */\n  editing: PropTypes.bool,\n\n  /** The message rendering component, the Message component delegates its rendering logic to this component */\n  Message: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** Allows you to overwrite the attachment component */\n  Attachment: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n});\n\n_defineProperty(Message, \"defaultProps\", {\n  Message: MessageSimple,\n  readBy: [],\n  groupStyles: [],\n  Attachment: Attachment,\n  editing: false\n});\n\nvar ReverseInfiniteScroll =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ReverseInfiniteScroll, _Component);\n\n  function ReverseInfiniteScroll(props) {\n    var _this;\n\n    _classCallCheck(this, ReverseInfiniteScroll);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReverseInfiniteScroll).call(this, props));\n    _this.scrollListener = _this.scrollListener.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.scrollEventCount = 0;\n    return _this;\n  }\n\n  _createClass(ReverseInfiniteScroll, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.pageLoaded = this.props.pageStart;\n      this.attachScrollListener();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.detachScrollListener();\n      this.detachMousewheelListener();\n    } // Set a defaut loader for all your `InfiniteScroll` components\n\n  }, {\n    key: \"setDefaultLoader\",\n    value: function setDefaultLoader(loader) {\n      this.defaultLoader = loader;\n    }\n  }, {\n    key: \"detachMousewheelListener\",\n    value: function detachMousewheelListener() {\n      var scrollEl = window;\n\n      if (this.props.useWindow === false) {\n        scrollEl = this.scrollComponent.parentNode;\n      }\n\n      scrollEl.removeEventListener('mousewheel', this.mousewheelListener, this.props.useCapture);\n    }\n  }, {\n    key: \"detachScrollListener\",\n    value: function detachScrollListener() {\n      var scrollEl = window;\n\n      if (this.props.useWindow === false) {\n        scrollEl = this.getParentElement(this.scrollComponent);\n      }\n\n      scrollEl.removeEventListener('scroll', this.scrollListener, this.props.useCapture);\n      scrollEl.removeEventListener('resize', this.scrollListener, this.props.useCapture);\n    }\n  }, {\n    key: \"getParentElement\",\n    value: function getParentElement(el) {\n      return el && el.parentNode;\n    }\n  }, {\n    key: \"filterProps\",\n    value: function filterProps(props) {\n      return props;\n    }\n  }, {\n    key: \"attachScrollListener\",\n    value: function attachScrollListener() {\n      if (!this.props.hasMore || this.props.isLoading || !this.getParentElement(this.scrollComponent)) {\n        return;\n      }\n\n      var scrollEl = window;\n\n      if (this.props.useWindow === false) {\n        scrollEl = this.getParentElement(this.scrollComponent);\n      }\n\n      scrollEl.addEventListener('mousewheel', this.mousewheelListener, this.props.useCapture);\n      scrollEl.addEventListener('scroll', this.scrollListener, this.props.useCapture);\n      scrollEl.addEventListener('resize', this.scrollListener, this.props.useCapture);\n\n      if (this.props.initialLoad) {\n        this.scrollListener();\n      }\n    }\n  }, {\n    key: \"mousewheelListener\",\n    value: function mousewheelListener(e) {\n      // Prevents Chrome hangups\n      // See: https://stackoverflow.com/questions/47524205/random-high-content-download-time-in-chrome/47684257#47684257\n      if (e.deltaY === 1) {\n        e.preventDefault();\n      }\n    }\n  }, {\n    key: \"scrollListener\",\n    value: function scrollListener() {\n      var el = this.scrollComponent;\n      var parentNode = this.getParentElement(el);\n      this.scrollEventCount += 1;\n      var offset;\n      var reverseOffset = parentNode.scrollTop;\n      var standardOffset = el.scrollHeight - parentNode.scrollTop - parentNode.clientHeight;\n\n      if (this.props.isReverse) {\n        offset = reverseOffset;\n      } else {\n        offset = standardOffset;\n      }\n\n      if (this.props.listenToScroll) {\n        this.props.listenToScroll(standardOffset, reverseOffset);\n      } // a reverse infinite scroll element always starts out at position 0\n      // this counter prevent you from loading content before the user even scrolled\n\n\n      if (this.scrollEventCount < 2) {\n        return;\n      } // prevent crazy repeat requests in case you don't have more\n\n\n      if (!this.props.hasMore || this.props.isLoading) {\n        return;\n      } // Here we make sure the element is visible as well as checking the offset\n\n\n      if (offset < Number(this.props.threshold) && el && el.offsetParent !== null) {\n        //this.detachScrollListener();\n        // Call loadMore after detachScrollListener to allow for non-async loadMore functions\n        if (typeof this.props.loadMore === 'function') {\n          this.props.loadMore(this.pageLoaded += 1);\n        }\n      }\n    }\n  }, {\n    key: \"calculateOffset\",\n    value: function calculateOffset(el, scrollTop) {\n      if (!el) {\n        return 0;\n      }\n\n      return this.calculateTopPosition(el) + (el.offsetHeight - scrollTop - window.innerHeight);\n    }\n  }, {\n    key: \"calculateTopPosition\",\n    value: function calculateTopPosition(el) {\n      if (!el) {\n        return 0;\n      }\n\n      return el.offsetTop + this.calculateTopPosition(el.offsetParent);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var renderProps = this.filterProps(this.props);\n\n      var children = renderProps.children,\n          element = renderProps.element,\n          hasMore = renderProps.hasMore,\n          initialLoad = renderProps.initialLoad,\n          isReverse = renderProps.isReverse,\n          loader = renderProps.loader,\n          loadMore = renderProps.loadMore,\n          pageStart = renderProps.pageStart,\n          ref = renderProps.ref,\n          threshold = renderProps.threshold,\n          useCapture = renderProps.useCapture,\n          useWindow = renderProps.useWindow,\n          listenToScroll = renderProps.listenToScroll,\n          isLoading = renderProps.isLoading,\n          props = _objectWithoutProperties(renderProps, [\"children\", \"element\", \"hasMore\", \"initialLoad\", \"isReverse\", \"loader\", \"loadMore\", \"pageStart\", \"ref\", \"threshold\", \"useCapture\", \"useWindow\", \"listenToScroll\", \"isLoading\"]);\n\n      props.ref = function (node) {\n        _this2.scrollComponent = node;\n\n        if (ref) {\n          ref(node);\n        }\n      };\n\n      var childrenArray = [children];\n\n      if (isLoading) {\n        if (loader) {\n          isReverse ? childrenArray.unshift(loader) : childrenArray.push(loader);\n        } else if (this.defaultLoader) {\n          isReverse ? childrenArray.unshift(this.defaultLoader) : childrenArray.push(this.defaultLoader);\n        }\n      }\n\n      return React.createElement(element, props, childrenArray);\n    }\n  }]);\n\n  return ReverseInfiniteScroll;\n}(Component);\n\n_defineProperty(ReverseInfiniteScroll, \"propTypes\", {\n  children: PropTypes.node.isRequired,\n  element: PropTypes.node,\n  hasMore: PropTypes.bool,\n  initialLoad: PropTypes.bool,\n  isReverse: PropTypes.bool,\n  loader: PropTypes.node,\n  loadMore: PropTypes.func.isRequired,\n  pageStart: PropTypes.number,\n  ref: PropTypes.func,\n  threshold: PropTypes.number,\n  useCapture: PropTypes.bool,\n  useWindow: PropTypes.bool,\n  className: PropTypes.string\n});\n\n_defineProperty(ReverseInfiniteScroll, \"defaultProps\", {\n  element: 'div',\n  hasMore: false,\n  initialLoad: true,\n  pageStart: 0,\n  ref: null,\n  threshold: 250,\n  useWindow: true,\n  isReverse: true,\n  useCapture: false,\n  loader: null,\n  className: 'str-chat__reverse-infinite-scroll'\n});\n\nvar MessageNotification =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(MessageNotification, _PureComponent);\n\n  function MessageNotification() {\n    _classCallCheck(this, MessageNotification);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(MessageNotification).apply(this, arguments));\n  }\n\n  _createClass(MessageNotification, [{\n    key: \"render\",\n    value: function render() {\n      if (!this.props.showNotification) {\n        return null;\n      } else {\n        return React.createElement(\"button\", {\n          className: \"str-chat__message-notification\",\n          onClick: this.props.onClick\n        }, this.props.children);\n      }\n    }\n  }]);\n\n  return MessageNotification;\n}(PureComponent);\n\n_defineProperty(MessageNotification, \"propTypes\", {\n  /** If we should show the notification or not */\n  showNotification: PropTypes.bool,\n\n  /** Onclick handler */\n  onClick: PropTypes.func.isRequired\n});\n\n_defineProperty(MessageNotification, \"defaultProps\", {\n  showNotification: true\n});\n/**\n * DateSeparator - A simple date seperator\n *\n * @example ./docs/DateSeparator.md\n * @extends PureComponent\n */\n\n\nvar DateSeparator =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(DateSeparator, _React$PureComponent);\n\n  function DateSeparator() {\n    _classCallCheck(this, DateSeparator);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(DateSeparator).apply(this, arguments));\n  }\n\n  _createClass(DateSeparator, [{\n    key: \"render\",\n    value: function render() {\n      var position = this.props.position;\n\n      if (!Date.parse(this.props.date)) {\n        return null;\n      }\n\n      return React.createElement(\"div\", {\n        className: \"str-chat__date-separator\"\n      }, (position === 'right' || position === 'center') && React.createElement(\"hr\", {\n        className: \"str-chat__date-separator-line\"\n      }), React.createElement(\"div\", {\n        className: \"str-chat__date-separator-date\"\n      }, this.props.formatDate ? this.props.formatDate(this.props.date) : moment(this.props.date.toISOString()).calendar(null, {\n        lastDay: '[Yesterday]',\n        sameDay: '[Today]',\n        nextDay: '[Tomorrow]',\n        lastWeek: '[Last] dddd',\n        nextWeek: 'dddd',\n        sameElse: 'L'\n      })), (position === 'left' || position === 'center') && React.createElement(\"hr\", {\n        className: \"str-chat__date-separator-line\"\n      }));\n    }\n  }]);\n\n  return DateSeparator;\n}(React.PureComponent);\n\n_defineProperty(DateSeparator, \"propTypes\", {\n  /** The date to format */\n  date: PropTypes.instanceOf(Date),\n\n  /** Set the position of the date in the separator */\n  position: PropTypes.oneOf(['left', 'center', 'right']),\n\n  /** Override the default formatting of the date. This is a function that has access to the original date object. Returns a string or Node  */\n  formatDate: PropTypes.func\n});\n\n_defineProperty(DateSeparator, \"defaultProps\", {\n  position: 'right'\n});\n/**\n * MessageList - The message list components renders a list of messages\n *\n * @example ./docs/MessageList.md\n * @extends PureComponent\n */\n\n\nvar MessageList =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(MessageList, _PureComponent);\n\n  function MessageList(props) {\n    var _this;\n\n    _classCallCheck(this, MessageList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MessageList).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"connectionChanged\", function (event) {\n      if (_this.state.online !== event.online) {\n        _this.setState({\n          online: event.online\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"keypress\", function (event) {\n      if (event.keyCode === KEY_CODES.ESC && _this.state.editing) {\n        _this.clearEditingState();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"scrollToBottom\", function () {\n      _this._scrollToRef(_this.bottomRef, _this.messageList);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_scrollToRef\", function (el, parent) {\n      function scrollDown() {\n        if (el && el.current && parent && parent.current) {\n          this.scrollToTarget(el.current, parent.current);\n        }\n      }\n\n      scrollDown.call(_assertThisInitialized(_assertThisInitialized(_this))); // scroll down after images load again\n\n      setTimeout(scrollDown.call(_assertThisInitialized(_assertThisInitialized(_this))), 100);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"scrollToTarget\", function (target, containerEl) {\n      // Moved up here for readability:\n      var isElement = target && target.nodeType === 1,\n          isNumber = Object.prototype.toString.call(target) === '[object Number]';\n\n      if (isElement) {\n        containerEl.scrollTop = target.offsetTop;\n      } else if (isNumber) {\n        containerEl.scrollTop = target;\n      } else if (target === 'bottom') {\n        containerEl.scrollTop = containerEl.scrollHeight - containerEl.offsetHeight;\n      } else if (target === 'top') {\n        containerEl.scrollTop = 0;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"setEditingState\", function (message) {\n      _this.setState({\n        editing: message.id\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"clearEditingState\", function (e) {\n      if (e) {\n        e.preventDefault();\n      }\n\n      _this.setState({\n        editing: ''\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"insertDates\", function (messages) {\n      var newMessages = [];\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = messages.entries()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var _step$value = _slicedToArray(_step.value, 2),\n              i = _step$value[0],\n              message = _step$value[1];\n\n          if (message.type === 'message.read' || message.deleted_at) {\n            newMessages.push(message);\n            continue;\n          }\n\n          var messageDate = message.created_at.getDay();\n          var prevMessageDate = messageDate;\n\n          if (i > 0) {\n            prevMessageDate = messages[i - 1].created_at.getDay();\n          }\n\n          if (i === 0) {\n            newMessages.push({\n              type: 'message.date',\n              date: message.created_at\n            }, message);\n          } else if (messageDate !== prevMessageDate) {\n            newMessages.push({\n              type: 'message.date',\n              date: message.created_at\n            }, message);\n          } else {\n            newMessages.push(message);\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return newMessages;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"goToNewMessages\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _this.scrollToBottom();\n\n            case 2:\n              _this.setState({\n                newMessagesNotification: false\n              });\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    })));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getReadStates\", function (messages) {\n      // create object with empty array for each message id\n      var readData = {};\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = messages[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var message = _step2.value;\n          readData[message.id] = [];\n        } // get all the read events\n\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      var readEvents = Object.values(_this.props.read); // match readevents with lastMessageId with the correct id\n\n      for (var _i = 0; _i < readEvents.length; _i++) {\n        var event = readEvents[_i];\n\n        if (event.lastMessageID) {\n          readData[event.lastMessageID] = [].concat(_toConsumableArray(readData[event.lastMessageID]), [event.user]);\n        }\n      }\n\n      return readData;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"userScrolledUp\", function () {\n      return _this.scrollOffset > 310;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"listenToScroll\", function (offset) {\n      _this.scrollOffset = offset;\n\n      if (_this.state.newMessagesNotification && !_this.userScrolledUp()) {\n        _this.setState({\n          newMessagesNotification: false\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getLastReceived\", function (messages) {\n      var l = messages.length;\n      var lastReceivedId = null;\n\n      for (var i = l; i > 0; i--) {\n        if (messages[i] !== undefined && messages[i].status !== undefined && messages[i].status === 'received') {\n          lastReceivedId = messages[i].id;\n          break;\n        }\n      }\n\n      return lastReceivedId;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getGroupStyles\", function (m) {\n      var l = m.length;\n      var messageGroupStyles = {};\n\n      var messages = _toConsumableArray(m);\n\n      for (var i = 0; i < l; i++) {\n        var previousMessage = messages[i - 1];\n        var message = messages[i];\n        var nextMessage = messages[i + 1];\n        var groupStyles = [];\n\n        if (message.type === 'message.date') {\n          continue;\n        }\n\n        var userId = message.user.id;\n        var isTopMessage = !previousMessage || previousMessage.type === 'message.date' || previousMessage.attachments.length !== 0 || userId !== previousMessage.user.id || previousMessage.type === 'error' || previousMessage.deleted_at;\n        var isBottomMessage = !nextMessage || nextMessage.type === 'message.date' || nextMessage.attachments.length !== 0 || userId !== nextMessage.user.id || nextMessage.type === 'error' || nextMessage.deleted_at;\n\n        if (isTopMessage) {\n          groupStyles.push('top');\n        }\n\n        if (isBottomMessage) {\n          if (isTopMessage || message.deleted_at || message.type === 'error') {\n            groupStyles.splice(0, groupStyles.length);\n            groupStyles.push('single');\n          } else {\n            groupStyles.push('bottom');\n          }\n        }\n\n        if (!isTopMessage && !isBottomMessage) {\n          if (message.deleted_at || message.type === 'error') {\n            groupStyles.splice(0, groupStyles.length);\n            groupStyles.push('single');\n          } else {\n            groupStyles.splice(0, groupStyles.length);\n            groupStyles.push('middle');\n          }\n        }\n\n        if (message.attachments.length !== 0) {\n          groupStyles.splice(0, groupStyles.length);\n          groupStyles.push('single');\n        }\n\n        if (_this.props.noGroupByUser) {\n          groupStyles.splice(0, groupStyles.length);\n          groupStyles.push('single');\n        }\n\n        messageGroupStyles[message.id] = groupStyles;\n      }\n\n      return messageGroupStyles;\n    });\n\n    _this.state = {\n      newMessagesNotification: false,\n      editing: '',\n      online: true\n    };\n    _this.bottomRef = React.createRef();\n    _this.messageList = React.createRef();\n    _this.messageRefs = {};\n    return _this;\n  }\n\n  _createClass(MessageList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // start at the bottom\n      this.scrollToBottom();\n      var messageListRect = this.messageList.current.getBoundingClientRect();\n      this.setState({\n        messageListRect: messageListRect\n      });\n      this.props.client.on('connection.changed', this.connectionChanged);\n      document.addEventListener('keydown', this.keypress);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.client.off('connection.changed', this.connectionChanged);\n      document.removeEventListener('keydown', this.keypress);\n    }\n  }, {\n    key: \"getSnapshotBeforeUpdate\",\n    value: function getSnapshotBeforeUpdate(prevProps) {\n      if (this.props.threadList) {\n        return null;\n      } // Are we adding new items to the list?\n      // Capture the scroll position so we can adjust scroll later.\n\n\n      if (prevProps.messages.length < this.props.messages.length) {\n        var list = this.messageList.current;\n        var pos = list.scrollHeight - list.scrollTop;\n        return pos;\n      }\n\n      return null;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      var _this2 = this; // If we have a snapshot value, we've just added new items.\n      // Adjust scroll so these new items don't push the old ones out of view.\n      // (snapshot here is the value returned from getSnapshotBeforeUpdate)\n\n\n      if (snapshot !== null) {\n        var list = this.messageList.current;\n\n        var scrollDown = function scrollDown() {\n          list.scrollTop = list.scrollHeight - snapshot;\n        };\n\n        scrollDown(); // scroll down after images load again\n\n        var scrollDownAgain = function scrollDownAgain() {\n          _this2.scrollToTarget(_this2.bottomRef.current, _this2.messageList.current);\n        };\n\n        setTimeout(scrollDownAgain, 500);\n      } // handle new messages being sent/received\n\n\n      var currentLastMessage = this.props.messages[this.props.messages.length - 1];\n      var previousLastMessage = prevProps.messages[prevProps.messages.length - 1];\n\n      if (!previousLastMessage || !currentLastMessage) {\n        return;\n      }\n\n      var hasNewMessage = currentLastMessage.id !== previousLastMessage.id;\n      var userScrolledUp = this.userScrolledUp();\n      var isOwner = currentLastMessage.user.id === this.props.client.userID;\n      var scrollToBottom = false; // always scroll down when it's your own message that you added...\n\n      if (hasNewMessage && isOwner) {\n        scrollToBottom = true;\n      } else if (hasNewMessage && !userScrolledUp) {\n        scrollToBottom = true;\n      }\n\n      if (scrollToBottom) {\n        this.scrollToBottom();\n      } // Check the scroll position... if you're scrolled up show a little notification\n\n\n      if (!scrollToBottom && hasNewMessage && !this.state.newMessagesNotification) {\n        this.setState({\n          newMessagesNotification: true\n        });\n      } // remove the scroll notification if we already scrolled down...\n\n\n      if (scrollToBottom && this.state.newMessagesNotification) {\n        this.setState({\n          newMessagesNotification: false\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var allMessages = _toConsumableArray(this.props.messages);\n\n      allMessages = this.insertDates(allMessages);\n      var messageGroupStyles = this.getGroupStyles(allMessages);\n      var TypingIndicator = this.props.TypingIndicator;\n      var DateSeparator$$1 = this.props.dateSeparator; // sort by date\n\n      allMessages.sort(function (a, b) {\n        return a.created_at - b.created_at;\n      }); // get the readData\n\n      var readData = this.getReadStates(allMessages);\n      var lastReceivedId = this.getLastReceived(allMessages);\n      var elements = []; // loop over the messages\n\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = allMessages[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var message = _step3.value;\n\n          if (message.id) {\n            this.messageRefs[message.id] = React.createRef();\n          }\n\n          if (message.type === 'message.date') {\n            if (this.props.threadList) {\n              continue;\n            }\n\n            elements.push(React.createElement(\"li\", {\n              key: message.date.toISOString() + '-i'\n            }, React.createElement(DateSeparator$$1, {\n              date: message.date\n            })));\n          } else if (message.type !== 'message.read') {\n            var groupStyles = messageGroupStyles[message.id];\n\n            if (!groupStyles) {\n              groupStyles = [];\n            }\n\n            var readBy = readData[message.id] || [];\n            elements.push(React.createElement(\"li\", {\n              className: \"str-chat__li str-chat__li--\".concat(groupStyles),\n              key: message.id || message.created_at,\n              ref: this.messageRefs[message.id]\n            }, React.createElement(Message, {\n              client: this.props.client,\n              openThread: this.props.openThread,\n              members: this.props.members,\n              watchers: this.props.watchers,\n              message: message,\n              groupStyles: groupStyles,\n              readBy: readBy,\n              lastReceivedId: lastReceivedId === message.id ? lastReceivedId : null,\n              editing: !!(this.state.editing && this.state.editing === message.id),\n              channel: this.props.channel,\n              threadList: this.props.threadList,\n              clearEditingState: this.clearEditingState,\n              setEditingState: this.setEditingState,\n              messageListRect: this.state.messageListRect,\n              retrySendMessage: this.props.retrySendMessage,\n              updateMessage: this.props.updateMessage,\n              removeMessage: this.props.removeMessage,\n              Message: this.props.Message,\n              Attachment: this.props.Attachment\n            })));\n          }\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n\n      return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        className: \"str-chat__list \".concat(this.props.threadList ? 'str-chat__list--thread' : ''),\n        ref: this.messageList\n      }, React.createElement(ReverseInfiniteScroll, {\n        loadMore: this.props.loadMore,\n        hasMore: this.props.hasMore,\n        isLoading: this.props.loadingMore,\n        listenToScroll: this.listenToScroll,\n        useWindow: false,\n        loader: React.createElement(Center, {\n          key: \"loadingindicator\"\n        }, React.createElement(LoadingIndicator, {\n          size: 20\n        }))\n      }, React.createElement(\"ul\", {\n        className: \"str-chat__ul\"\n      }, elements), this.props.TypingIndicator && React.createElement(TypingIndicator, {\n        typing: this.props.typing,\n        client: this.props.client\n      }), React.createElement(\"div\", {\n        key: \"bottom\",\n        ref: this.bottomRef\n      }))), React.createElement(\"div\", {\n        className: \"str-chat__list-notifications\"\n      }, React.createElement(Notification, {\n        active: !this.state.online\n      }, \"Connection failure, reconnecting now...\"), React.createElement(MessageNotification, {\n        showNotification: this.state.newMessagesNotification,\n        onClick: function onClick() {\n          return _this3.goToNewMessages();\n        }\n      }, \"New Messages!\")));\n    }\n  }]);\n\n  return MessageList;\n}(PureComponent);\n\n_defineProperty(MessageList, \"propTypes\", {\n  /** The attachment component to render, defaults to Attachment */\n  Attachment: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** A list of immutable messages */\n  messages: PropTypes.array.isRequired,\n\n  /** Via Context: The channel object */\n  channel: PropTypes.object.isRequired,\n\n  /** Via Context: The function to update a message, handled by the Channel component */\n  updateMessage: PropTypes.func.isRequired,\n\n  /** Via Context: The function is called when the list scrolls */\n  listenToScroll: PropTypes.func,\n\n  /** Typing indicator component to render  */\n  TypingIndicator: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** Date separator component to render  */\n  dateSeparator: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** Turn off grouping of messages by user */\n  noGroupByUser: PropTypes.bool\n});\n\n_defineProperty(MessageList, \"defaultProps\", {\n  dateSeparator: DateSeparator,\n  noGroupByUser: false\n});\n\nMessageList = withChannelContext(MessageList);\n\nvar Center = function Center(_ref2) {\n  var children = _ref2.children;\n  return React.createElement(\"div\", {\n    style: {\n      width: 100 + '%',\n      display: 'flex',\n      justifyContent: 'center'\n    }\n  }, children);\n};\n\nvar Notification = function Notification(_ref3) {\n  var children = _ref3.children,\n      active = _ref3.active;\n\n  if (active) {\n    return React.createElement(\"div\", {\n      className: \"str-chat__connection-issue\"\n    }, children);\n  }\n\n  return null;\n};\n/**\n * Chat - Wrapper component for Chat. The needs to be placed around any other chat components.\n * This Chat component provides the ChatContext to all other components.\n *\n * The ChatContext provides the following props:\n *\n * - client (the client connection)\n * - channels (the list of channels)\n * - setActiveChannel (a function to set the currently active channel)\n * - channel (the currently active channel)\n *\n * It also exposes the withChatContext HOC which you can use to consume the ChatContext\n *\n * @example ./docs/Chat.md\n * @extends PureComponent\n */\n\n\nvar colors = ['light', 'dark'];\nvar baseUseCases = ['messaging', 'team', 'commerce', 'gaming', 'livestream'];\nvar themes = [];\n\nfor (var _i = 0; _i < colors.length; _i++) {\n  var color = colors[_i];\n\n  for (var _i2 = 0; _i2 < baseUseCases.length; _i2++) {\n    var useCase = baseUseCases[_i2];\n    themes.push(\"\".concat(useCase, \" \").concat(color));\n  }\n}\n\nvar Chat =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(Chat, _PureComponent);\n\n  function Chat(props) {\n    var _this;\n\n    _classCallCheck(this, Chat);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Chat).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"setActiveChannel\", function (channel, e) {\n      if (e !== undefined && e.preventDefault) {\n        e.preventDefault();\n      }\n\n      _this.setState(function () {\n        return {\n          channel: channel\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getContext\", function () {\n      return {\n        client: _this.props.client,\n        channels: _this.state.channels,\n        channel: _this.state.channel,\n        setActiveChannel: _this.setActiveChannel,\n        theme: _this.props.theme\n      };\n    });\n\n    _this.state = {\n      // currently active channel\n      channel: {},\n      // list of channels\n      channels: [],\n      // create new Channel state\n      channelStart: false // false\n\n    };\n    return _this;\n  }\n\n  _createClass(Chat, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(ChatContext.Provider, {\n        value: this.getContext()\n      }, this.props.children);\n    }\n  }]);\n\n  return Chat;\n}(PureComponent);\n\n_defineProperty(Chat, \"propTypes\", {\n  /** The StreamChat client object */\n  client: PropTypes.object.isRequired,\n\n  /** The theme 'messaging', 'team', 'commerce', 'gaming', 'livestream' plus either 'light' or 'dark' */\n  theme: PropTypes.oneOf(themes)\n});\n\n_defineProperty(Chat, \"defaultProps\", {\n  theme: 'messaging light'\n});\n/**\n * Channel - Wrapper component for a channel. It needs to be place inside of the Chat component.\n * ChannelHeader, MessageList, Thread and MessageInput should be used as children of the Channel component.\n *\n * @example ./docs/Channel.md\n * @extends PureComponent\n */\n\n\nvar Channel =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(Channel, _PureComponent);\n\n  function Channel(props) {\n    var _this;\n\n    _classCallCheck(this, Channel);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Channel).call(this, props));\n    _this.state = {\n      error: false\n    };\n    return _this;\n  }\n\n  _createClass(Channel, [{\n    key: \"render\",\n    value: function render() {\n      if (!this.props.channel.cid) {\n        return null; // <div>Select a channel</div>;\n      } // We use a wrapper to make sure the key variable is set.\n      // this ensures that if you switch channel the component is recreated\n\n\n      return React.createElement(ChannelInner, _extends({}, this.props, {\n        key: this.props.channel.cid\n      }));\n    }\n  }]);\n\n  return Channel;\n}(PureComponent);\n\n_defineProperty(Channel, \"propTypes\", {\n  /** Which channel to connect to, will initialize the channel if it's not initialized yet */\n  channel: PropTypes.shape({\n    watch: PropTypes.func\n  }).isRequired,\n\n  /** Client is passed automatically via the Chat Context */\n  client: PropTypes.object.isRequired,\n\n  /** The loading indicator to use */\n  LoadingIndicator: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n  Message: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n  Attachment: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n});\n\n_defineProperty(Channel, \"defaultProps\", {\n  LoadingIndicator: LoadingIndicator,\n  Message: MessageSimple,\n  Attachment: Attachment\n});\n\nvar ChannelInner =\n/*#__PURE__*/\nfunction (_PureComponent2) {\n  _inherits(ChannelInner, _PureComponent2);\n\n  function ChannelInner(props) {\n    var _this2;\n\n    _classCallCheck(this, ChannelInner);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(ChannelInner).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"renderLoading\", function () {\n      var Loader = _this2.props.LoadingIndicator;\n      return React.createElement(Loader, {\n        isLoading: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"openThread\", function (message, e) {\n      if (e && e.preventDefault) {\n        e.preventDefault();\n      }\n\n      var channel = _this2.props.channel;\n      var threadMessages = channel.state.threads[message.id] || [];\n\n      _this2.setState({\n        thread: message,\n        threadMessages: threadMessages\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"loadMoreThread\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var channel, parentID, oldMessages, oldestMessageID, limit, queryResponse, hasMore, threadMessages;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!_this2.state.threadLoadingMore) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              _this2.setState({\n                threadLoadingMore: true\n              });\n\n              channel = _this2.props.channel;\n              parentID = _this2.state.thread.id;\n              oldMessages = channel.state.threads[parentID] || [];\n              oldestMessageID = oldMessages[0] ? oldMessages[0].id : null;\n              limit = 50;\n              _context.next = 10;\n              return channel.getReplies(parentID, {\n                limit: limit,\n                id_lt: oldestMessageID\n              });\n\n            case 10:\n              queryResponse = _context.sent;\n              hasMore = queryResponse.messages.length === limit;\n              threadMessages = channel.state.threads[parentID] || []; // next set loadingMore to false so we can start asking for more data...\n\n              _this2._loadMoreThreadFinishedDebounced(hasMore, threadMessages);\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    })));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"loadMoreThreadFinished\", function (threadHasMore, threadMessages) {\n      _this2.setState({\n        threadLoadingMore: false,\n        threadHasMore: threadHasMore,\n        threadMessages: threadMessages\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"closeThread\", function (e) {\n      if (e && e.preventDefault) {\n        e.preventDefault();\n      }\n\n      _this2.setState({\n        thread: null,\n        threadMessages: []\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"updateMessage\", function (updatedMessage, extraState) {\n      var channel = _this2.props.channel;\n      extraState = extraState || {}; // adds the message to the local channel state..\n      // this adds to both the main channel state as well as any reply threads\n\n      channel.state.addMessageSorted(updatedMessage); // update the Channel component state\n\n      if (_this2.state.thread && updatedMessage.parent_id) {\n        extraState.threadMessages = channel.state.threads[updatedMessage.parent_id] || [];\n      }\n\n      _this2.setState(_objectSpread({\n        messages: channel.state.messages\n      }, extraState));\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"removeMessage\", function (message) {\n      var channel = _this2.props.channel;\n      channel.state.removeMessage(message);\n\n      _this2.setState({\n        messages: channel.state.messages\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"createMessagePreview\", function (text, attachments, parent) {\n      // create a preview of the message\n      var clientSideID = \"\".concat(_this2.props.client.userID, \"-\") + uuidv4();\n      var message = {\n        text: text,\n        html: text,\n        __html: text,\n        //id: tmpID,\n        id: clientSideID,\n        type: 'regular',\n        status: 'sending',\n        user: _objectSpread({\n          id: _this2.props.client.userID\n        }, _this2.props.client.user),\n        created_at: new Date(),\n        attachments: attachments,\n        reactions: []\n      };\n\n      if (parent && parent.id) {\n        message.parent_id = parent.id;\n      }\n\n      return message;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"_sendMessage\",\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(message) {\n        var text, attachments, id, parent_id, messageData, messageResponse;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                text = message.text, attachments = message.attachments, id = message.id, parent_id = message.parent_id;\n                messageData = {\n                  text: text,\n                  attachments: attachments,\n                  id: id,\n                  parent_id: parent_id\n                };\n                _context2.prev = 2;\n                _context2.next = 5;\n                return _this2.props.channel.sendMessage(messageData);\n\n              case 5:\n                messageResponse = _context2.sent; // replace it after send is completed\n\n                if (messageResponse.message) {\n                  messageResponse.message.status = 'received';\n\n                  _this2.updateMessage(messageResponse.message);\n                }\n\n                _context2.next = 13;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](2); // set the message to failed..\n\n                message.status = 'failed';\n\n                _this2.updateMessage(message);\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[2, 9]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"sendMessage\",\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(_ref3) {\n        var text, _ref3$attachments, attachments, parent, messagePreview;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                text = _ref3.text, _ref3$attachments = _ref3.attachments, attachments = _ref3$attachments === void 0 ? [] : _ref3$attachments, parent = _ref3.parent; // remove error messages upon submit\n\n                _this2.props.channel.state.filterErrorMessages(); // create a local preview message to show in the UI\n\n\n                messagePreview = _this2.createMessagePreview(text, attachments, parent); // first we add the message to the UI\n\n                _this2.updateMessage(messagePreview, {\n                  messageInput: '',\n                  commands: [],\n                  userAutocomplete: []\n                });\n\n                _context3.next = 6;\n                return _this2._sendMessage(messagePreview);\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x2) {\n        return _ref4.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"retrySendMessage\",\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(message) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                // set the message status to sending\n                message = message.asMutable();\n                message.status = 'sending';\n\n                _this2.updateMessage(message); // actually try to send the message...\n\n\n                _context4.next = 5;\n                return _this2._sendMessage(message);\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      return function (_x3) {\n        return _ref5.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"handleEvent\", function (e) {\n      var channel = _this2.props.channel;\n      var threadMessages = [];\n      var threadState = {};\n\n      if (_this2.state.thread) {\n        threadMessages = channel.state.threads[_this2.state.thread.id] || [];\n        threadState['threadMessages'] = threadMessages;\n      }\n\n      if (_this2.state.thread && e.message && e.message.id === _this2.state.thread.id) {\n        threadState['thread'] = channel.state.messageToImmutable(e.message);\n      }\n\n      if (Object.keys(threadState).length > 0) {\n        // TODO: in theory we should do 1 setState call not 2,\n        // However the setStateThrottled doesn't support this\n        _this2.setState(threadState);\n      }\n\n      if (e.type === 'message.new') {\n        var mainChannelUpdated = true;\n\n        if (e.message.parent_id && !e.message.show_in_channel) {\n          mainChannelUpdated = false;\n        }\n\n        if (mainChannelUpdated) {\n          if (Visibility.state() === 'visible') {\n            _this2._markReadThrottled(channel);\n          } else {\n            var unread = channel.countUnread(_this2.lastRead);\n            document.title = \"(\".concat(unread, \") \").concat(_this2.originalTitle);\n          }\n        }\n      }\n\n      _this2._setStateThrottled({\n        messages: channel.state.messages,\n        watchers: channel.state.watchers,\n        read: channel.state.read,\n        typing: channel.state.typing,\n        watcher_count: channel.state.watcher_count\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"markRead\", function (channel) {\n      if (!channel.getConfig().read_events) {\n        return;\n      }\n\n      _this2.lastRead = new Date();\n      logChatPromiseExecution(channel.markRead(), 'mark read');\n\n      if (_this2.originalTitle) {\n        document.title = _this2.originalTitle;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"loadMore\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee5() {\n      var oldestID, perPage, queryResponse, hasMore;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              if (!_this2.state.loadingMore) {\n                _context5.next = 2;\n                break;\n              }\n\n              return _context5.abrupt(\"return\");\n\n            case 2:\n              _this2.setState({\n                loadingMore: true\n              });\n\n              oldestID = _this2.state.messages[0] ? _this2.state.messages[0].id : null;\n              perPage = 100;\n              _context5.prev = 5;\n              _context5.next = 8;\n              return _this2.props.channel.query({\n                messages: {\n                  limit: perPage,\n                  id_lt: oldestID\n                }\n              });\n\n            case 8:\n              queryResponse = _context5.sent;\n              _context5.next = 16;\n              break;\n\n            case 11:\n              _context5.prev = 11;\n              _context5.t0 = _context5[\"catch\"](5);\n              console.warn('message pagination request failed with error', _context5.t0);\n\n              _this2.setState({\n                loadingMore: false\n              });\n\n              return _context5.abrupt(\"return\");\n\n            case 16:\n              hasMore = queryResponse.messages.length === perPage;\n\n              _this2._loadMoreFinishedDebounced(hasMore, _this2.props.channel.state.messages);\n\n            case 18:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this, [[5, 11]]);\n    })));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"loadMoreFinished\", function (hasMore, messages) {\n      _this2.setState({\n        loadingMore: false,\n        hasMore: hasMore,\n        messages: messages\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"getContext\", function () {\n      return _objectSpread({}, _this2.state, {\n        channels: _this2.props.channels,\n        client: _this2.props.client,\n        channel: _this2.props.channel,\n        Message: _this2.props.Message,\n        Attachment: _this2.props.Attachment,\n        updateMessage: _this2.updateMessage,\n        removeMessage: _this2.removeMessage,\n        sendMessage: _this2.sendMessage,\n        retrySendMessage: _this2.retrySendMessage,\n        resetNotification: _this2.resetNotification,\n        loadMore: _this2.loadMore,\n        listenToScroll: _this2.listenToScroll,\n        // thread related\n        openThread: _this2.openThread,\n        closeThread: _this2.closeThread,\n        loadMoreThread: _this2.loadMoreThread\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this2)), \"renderComponent\", function () {\n      return _this2.props.children;\n    });\n\n    _this2.state = {\n      error: false,\n      // Loading the intial content of the channel\n      loading: true,\n      // Loading more messages\n      loadingMore: false,\n      hasMore: true,\n      messages: Immutable([]),\n      online: true,\n      typing: Immutable({}),\n      watchers: Immutable({}),\n      members: Immutable({}),\n      read: Immutable({}),\n      thread: false,\n      threadMessages: [],\n      threadLoadingMore: false,\n      threadHasMore: true\n    }; // hard limit to prevent you from scrolling faster than 1 page per 2 seconds\n\n    _this2._loadMoreFinishedDebounced = debounce(_this2.loadMoreFinished, 2000, {\n      leading: true,\n      trailing: true\n    }); // hard limit to prevent you from scrolling faster than 1 page per 2 seconds\n\n    _this2._loadMoreThreadFinishedDebounced = debounce(_this2.loadMoreThreadFinished, 2000, {\n      leading: true,\n      trailing: true\n    });\n    _this2._markReadThrottled = throttle(_this2.markRead, 500, {\n      leading: true,\n      trailing: true\n    });\n    _this2._setStateThrottled = throttle(_this2.setState, 500, {\n      leading: true,\n      trailing: true\n    });\n    return _this2;\n  }\n\n  _createClass(ChannelInner, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6() {\n        var channel, errored;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                channel = this.props.channel;\n                errored = false;\n\n                if (channel.initialized) {\n                  _context6.next = 12;\n                  break;\n                }\n\n                _context6.prev = 3;\n                _context6.next = 6;\n                return channel.watch();\n\n              case 6:\n                _context6.next = 12;\n                break;\n\n              case 8:\n                _context6.prev = 8;\n                _context6.t0 = _context6[\"catch\"](3);\n                this.setState({\n                  error: true\n                });\n                errored = true;\n\n              case 12:\n                this.originalTitle = document.title;\n                this.lastRead = new Date();\n\n                if (!errored) {\n                  this.copyChannelState();\n                  this.listenToChanges();\n                }\n\n              case 15:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[3, 8]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.channel.off(this.handleEvent);\n\n      if (this.visibilityListener) {\n        Visibility.unbind(this.visibilityListener);\n      }\n    }\n  }, {\n    key: \"copyChannelState\",\n    value: function copyChannelState() {\n      var channel = this.props.channel;\n      console.log('channel.state', channel.state);\n      this.setState({\n        messages: channel.state.messages,\n        read: channel.state.read,\n        watchers: channel.state.watchers,\n        members: channel.state.members,\n        watcher_count: channel.state.watcher_count,\n        loading: false,\n        typing: {}\n      });\n      channel.markRead();\n    }\n  }, {\n    key: \"removeEphemeralMessages\",\n    value: function removeEphemeralMessages() {\n      var c = this.props.channel;\n      c.state.selectRegularMessages();\n      this.setState({\n        messages: c.state.messages\n      });\n    }\n  }, {\n    key: \"listenToChanges\",\n    value: function listenToChanges() {\n      var _this3 = this; // The more complex sync logic is done in chat.js\n      // listen to client.connection.recovered and all channel events\n\n\n      this.props.client.on('connection.recovered', this.handleEvent);\n      var channel = this.props.channel;\n      channel.on(this.handleEvent);\n      this.boundMarkRead = this.markRead.bind(this, channel);\n      this.visibilityListener = Visibility.change(function (e, state) {\n        if (state === 'visible') {\n          _this3.boundMarkRead();\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var core;\n\n      if (this.state.error) {\n        core = React.createElement(\"div\", null, \"Error: \", this.state.error.message);\n      } else if (this.state.loading) {\n        core = React.createElement(LoadingIndicator, {\n          size: 25,\n          isLoading: true\n        });\n      } else if (!this.props.channel || !this.props.channel.watch) {\n        core = React.createElement(\"div\", null, \"Channel Missing\");\n      } else {\n        core = React.createElement(ChannelContext.Provider, {\n          value: this.getContext()\n        }, React.createElement(\"div\", {\n          className: \"str-chat__container\"\n        }, this.renderComponent()));\n      }\n\n      return React.createElement(\"div\", {\n        className: \"str-chat str-chat-channel \".concat(this.props.theme)\n      }, core);\n    }\n  }]);\n\n  return ChannelInner;\n}(PureComponent);\n\n_defineProperty(ChannelInner, \"propTypes\", {\n  /** Which channel to connect to */\n  channel: PropTypes.shape({\n    watch: PropTypes.func\n  }).isRequired,\n\n  /** Client is passed via the Chat Context */\n  client: PropTypes.object.isRequired,\n\n  /** The loading indicator to use */\n  LoadingIndicator: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n});\n\nChannel = withChatContext(Channel);\n/**\n * ChannelHeader - Render some basic information about this channel\n *\n * @example ./docs/ChannelHeader.md\n * @extends PureComponent\n */\n\nvar ChannelHeader =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ChannelHeader, _PureComponent);\n\n  function ChannelHeader() {\n    _classCallCheck(this, ChannelHeader);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ChannelHeader).apply(this, arguments));\n  }\n\n  _createClass(ChannelHeader, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"str-chat__header-livestream\"\n      }, this.props.channel.data.image && React.createElement(Avatar, {\n        image: this.props.channel.data.image,\n        shape: \"rounded\",\n        size: this.props.channel.type === 'commerce' ? 60 : 40\n      }), React.createElement(\"div\", {\n        className: \"str-chat__header-livestream-left\"\n      }, React.createElement(\"p\", {\n        className: \"str-chat__header-livestream-left--title\"\n      }, this.props.title || this.props.channel.data.name, ' ', this.props.live && React.createElement(\"span\", {\n        className: \"str-chat__header-livestream-left--livelabel\"\n      }, \"live\")), this.props.channel.data.subtitle && React.createElement(\"p\", {\n        className: \"str-chat__header-livestream-left--subtitle\"\n      }, this.props.channel.data.subtitle), React.createElement(\"p\", {\n        className: \"str-chat__header-livestream-left--members\"\n      }, !this.props.live && this.props.channel.data.member_count > 0 && React.createElement(React.Fragment, null, this.props.channel.data.member_count, \" members, \"), this.props.watcher_count, \" online\")), React.createElement(\"div\", {\n        className: \"str-chat__header-livestream-right\"\n      }, React.createElement(\"div\", {\n        className: \"str-chat__header-livestream-right-button-wrapper\"\n      }, React.createElement(\"a\", {\n        href: \"https://getstream.io/chat/\",\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        className: \"str-chat__square-button str-chat__header-livestream-right-button--info\"\n      }, React.createElement(\"svg\", {\n        width: \"4\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M3 13h1v.5H0V13h1V5.5H0V5h3v8zM1.994 3.516A1.507 1.507 0 1 1 1.995.502a1.507 1.507 0 0 1-.001 3.014z\",\n        fillRule: \"evenodd\"\n      }))))));\n    }\n  }]);\n\n  return ChannelHeader;\n}(PureComponent);\n\n_defineProperty(ChannelHeader, \"propTypes\", {\n  /** Via Context: the channel to render */\n  channel: PropTypes.object.isRequired,\n\n  /** Set title manually */\n  title: PropTypes.string,\n\n  /** Via Context: the number of users watching users */\n  watcher_count: PropTypes.number,\n\n  /** Show a little indicator that the channel is live right now */\n  live: PropTypes.bool\n});\n\nChannelHeader = withChannelContext(ChannelHeader);\n/**\n * MessageInputFlat - Large Message Input to be used for the MessageInput.\n * @example ./docs/MessageInputFlat.md\n */\n\nvar MessageInputFlat =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(MessageInputFlat, _PureComponent);\n\n  function MessageInputFlat() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MessageInputFlat);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MessageInputFlat)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderUploads\", function () {\n      return React.createElement(React.Fragment, null, _this.props.imageOrder.length > 0 && React.createElement(ImagePreviewer, {\n        imageUploads: _this.props.imageOrder.map(function (id) {\n          return _this.props.imageUploads[id];\n        }),\n        handleRemove: _this.props.removeImage,\n        handleRetry: _this.props.uploadImage,\n        handleFiles: _this.props.uploadNewFiles\n      }), _this.props.fileOrder.length > 0 && React.createElement(\"div\", {\n        className: \"str-chat__file-uploads\"\n      }, React.createElement(FilePreviewer, {\n        uploads: _this.props.fileOrder.map(function (id) {\n          return _this.props.fileUploads[id];\n        }),\n        handleRemove: _this.props.removeFile,\n        handleRetry: _this.props.uploadFile,\n        handleFiles: _this.props.uploadNewFiles\n      })));\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderEmojiPicker\", function () {\n      if (_this.props.emojiPickerIsOpen) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__input-flat--emojipicker\",\n          ref: _this.props.emojiPickerRef\n        }, React.createElement(Picker, {\n          emoji: \"point_up\",\n          title: \"Pick your emoji\\u2026\",\n          onSelect: _this.props.onSelectEmoji,\n          color: \"#006CFF\",\n          showPreview: false\n        }));\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(MessageInputFlat, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        className: \"str-chat__input-flat\",\n        style: {\n          position: 'relative',\n          zIndex: 100,\n          width: '100%'\n        }\n      }, React.createElement(ImageDropzone, {\n        handleFiles: this.props.uploadNewFiles\n      }, React.createElement(\"div\", {\n        className: \"str-chat__input-flat-wrapper\"\n      }, this.renderUploads(), this.renderEmojiPicker(), React.createElement(ChatAutoComplete, {\n        users: this.props.getUsers(),\n        commands: this.props.getCommands(),\n        innerRef: this.props.textareaRef,\n        handleSubmit: function handleSubmit(e) {\n          return _this2.props.handleSubmit(e);\n        },\n        onChange: this.props.handleChange,\n        value: this.props.text,\n        rows: 1,\n        placeholder: \"Type your message\",\n        onPaste: this.props.onPaste,\n        grow: this.props.grow,\n        onFocus: this.props.onFocus,\n        disabled: this.props.disabled\n      }), React.createElement(\"span\", {\n        className: \"str-chat__input-flat-emojiselect\",\n        onClick: this.props.openEmojiPicker\n      }, React.createElement(\"svg\", {\n        width: \"28\",\n        height: \"28\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M22.217 16.1c.483.25.674.849.423 1.334C21.163 20.294 17.771 22 14 22c-3.867 0-7.347-1.765-8.66-4.605a.994.994 0 0 1 .9-1.407c.385 0 .739.225.9.575C8.135 18.715 10.892 20 14 20c3.038 0 5.738-1.267 6.879-3.476a.99.99 0 0 1 1.338-.424zm1.583-3.652c.341.443.235 1.064-.237 1.384a1.082 1.082 0 0 1-.62.168c-.338 0-.659-.132-.858-.389-.212-.276-.476-.611-1.076-.611-.598 0-.864.337-1.08.614-.197.254-.517.386-.854.386-.224 0-.438-.045-.62-.167-.517-.349-.578-.947-.235-1.388.66-.847 1.483-1.445 2.789-1.445 1.305 0 2.136.6 2.79 1.448zm-14 0c.341.443.235 1.064-.237 1.384a1.082 1.082 0 0 1-.62.168c-.339 0-.659-.132-.858-.389C7.873 13.335 7.61 13 7.01 13c-.598 0-.864.337-1.08.614-.197.254-.517.386-.854.386-.224 0-.438-.045-.62-.167-.518-.349-.579-.947-.235-1.388C4.88 11.598 5.703 11 7.01 11c1.305 0 2.136.6 2.79 1.448zM14 0c7.732 0 14 6.268 14 14s-6.268 14-14 14S0 21.732 0 14 6.268 0 14 0zm8.485 22.485A11.922 11.922 0 0 0 26 14c0-3.205-1.248-6.219-3.515-8.485A11.922 11.922 0 0 0 14 2a11.922 11.922 0 0 0-8.485 3.515A11.922 11.922 0 0 0 2 14c0 3.205 1.248 6.219 3.515 8.485A11.922 11.922 0 0 0 14 26c3.205 0 6.219-1.248 8.485-3.515z\",\n        fillRule: \"evenodd\"\n      }))), React.createElement(FileUploadButton, {\n        multiple: true,\n        handleFiles: this.props.uploadNewFiles\n      }, React.createElement(\"span\", {\n        className: \"str-chat__input-flat-fileupload\"\n      }, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M1.667.333h10.666c.737 0 1.334.597 1.334 1.334v10.666c0 .737-.597 1.334-1.334 1.334H1.667a1.333 1.333 0 0 1-1.334-1.334V1.667C.333.93.93.333 1.667.333zm2 1.334a1.667 1.667 0 1 0 0 3.333 1.667 1.667 0 0 0 0-3.333zm-2 9.333v1.333h10.666v-4l-2-2-4 4-2-2L1.667 11z\",\n        fillRule: \"nonzero\"\n      })))))));\n    }\n  }]);\n\n  return MessageInputFlat;\n}(PureComponent);\n\n_defineProperty(MessageInputFlat, \"propTypes\", {\n  /** Set focus to the text input if this is enabled */\n  focus: PropTypes.bool,\n\n  /** Grow the textarea while you're typing */\n  grow: PropTypes.bool,\n\n  /** Disable the textarea */\n  disabled: PropTypes.bool\n});\n\n_defineProperty(MessageInputFlat, \"defaultProps\", {\n  grow: true,\n  disabled: false\n});\n/**\n * MessageInputSmall - compact design to be used for the MessageInput. It has all the features of MessageInput minus the typing indicator.\n * @example ./docs/MessageInputSmall.md\n */\n\n\nvar MessageInputSmall =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(MessageInputSmall, _PureComponent);\n\n  function MessageInputSmall() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MessageInputSmall);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MessageInputSmall)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderUploads\", function () {\n      return React.createElement(React.Fragment, null, _this.props.imageOrder.length > 0 && React.createElement(ImagePreviewer, {\n        imageUploads: _this.props.imageOrder.map(function (id) {\n          return _this.props.imageUploads[id];\n        }),\n        handleRemove: _this.props.removeImage,\n        handleRetry: _this.props.uploadImage,\n        handleFiles: _this.props.uploadNewFiles\n      }), _this.props.fileOrder.length > 0 && React.createElement(FilePreviewer, {\n        uploads: _this.props.fileOrder.map(function (id) {\n          return _this.props.fileUploads[id];\n        }),\n        handleRemove: _this.props.removeFile,\n        handleRetry: _this.props.uploadFile,\n        handleFiles: _this.props.uploadNewFiles\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderEmojiPicker\", function () {\n      if (_this.props.emojiPickerIsOpen) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__small-message-input-emojipicker\",\n          ref: _this.props.emojiPickerRef\n        }, React.createElement(Picker, {\n          emoji: \"point_up\",\n          title: \"Pick your emoji\\u2026\",\n          onSelect: _this.props.onSelectEmoji,\n          color: \"#006CFF\",\n          showPreview: false\n        }));\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(MessageInputSmall, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        style: {\n          position: 'relative',\n          zIndex: 0,\n          width: '100%'\n        }\n      }, React.createElement(ImageDropzone, {\n        handleFiles: this.props.uploadNewFiles\n      }, React.createElement(\"div\", {\n        className: \"str-chat__small-message-input\"\n      }, this.renderUploads(), this.renderEmojiPicker(), React.createElement(ChatAutoComplete, {\n        users: this.props.getUsers(),\n        commands: this.props.getCommands(),\n        innerRef: this.props.textareaRef,\n        handleSubmit: this.props.handleSubmit,\n        onChange: this.props.handleChange,\n        value: this.props.text,\n        rows: 1,\n        placeholder: \"Type your message\",\n        onPaste: this.props.onPaste,\n        grow: this.props.grow,\n        disabled: this.props.disabled\n      }), React.createElement(\"span\", {\n        className: \"str-chat__small-message-input-emojiselect\",\n        onClick: this.props.openEmojiPicker\n      }, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\",\n        fillRule: \"evenodd\"\n      }))), React.createElement(FileUploadButton, {\n        multiple: true,\n        handleFiles: this.props.uploadNewFiles\n      }, React.createElement(\"span\", {\n        className: \"str-chat__small-message-input-fileupload\",\n        onClick: this.props.openFilePanel\n      }, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M7 .5c3.59 0 6.5 2.91 6.5 6.5s-2.91 6.5-6.5 6.5S.5 10.59.5 7 3.41.5 7 .5zm0 12c3.031 0 5.5-2.469 5.5-5.5S10.031 1.5 7 1.5A5.506 5.506 0 0 0 1.5 7c0 3.034 2.469 5.5 5.5 5.5zM7.506 3v3.494H11v1.05H7.506V11h-1.05V7.544H3v-1.05h3.456V3h1.05z\",\n        fillRule: \"nonzero\"\n      })))))));\n    }\n  }]);\n\n  return MessageInputSmall;\n}(PureComponent);\n\n_defineProperty(MessageInputSmall, \"propTypes\", {\n  /** Set focus to the text input if this is enabled */\n  focus: PropTypes.bool.isRequired,\n\n  /** Grow the textarea while you're typing */\n  grow: PropTypes.bool.isRequired,\n\n  /** Make the textarea disabled */\n  disabled: PropTypes.bool\n});\n\nvar ChannelPreviewLastMessage =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ChannelPreviewLastMessage, _PureComponent);\n\n  function ChannelPreviewLastMessage() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ChannelPreviewLastMessage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ChannelPreviewLastMessage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"channelPreviewButton\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onSelectChannel\", function () {\n      _this.props.setActiveChannel(_this.props.channel);\n\n      _this.channelPreviewButton.current.blur();\n    });\n\n    return _this;\n  }\n\n  _createClass(ChannelPreviewLastMessage, [{\n    key: \"render\",\n    value: function render() {\n      var unreadClass = this.props.unread_count >= 1 ? 'str-chat__channel-preview--unread' : '';\n      var activeClass = this.props.active ? 'str-chat__channel-preview--active' : '';\n      var name = this.props.channel.data.name || this.props.channel.cid;\n      return React.createElement(\"div\", {\n        className: \"str-chat__channel-preview \".concat(unreadClass, \" \").concat(activeClass)\n      }, React.createElement(\"button\", {\n        onClick: this.onSelectChannel,\n        ref: this.channelPreviewButton\n      }, this.props.unread_count >= 1 && React.createElement(\"div\", {\n        className: \"str-chat__channel-preview--dot\"\n      }), React.createElement(Avatar, {\n        image: this.props.channel.data.image\n      }), React.createElement(\"div\", {\n        className: \"str-chat__channel-preview-info\"\n      }, React.createElement(\"span\", {\n        className: \"str-chat__channel-preview-title\"\n      }, name), React.createElement(\"span\", {\n        className: \"str-chat__channel-preview-last-message\"\n      }, !this.props.channel.state.messages[0] ? 'Nothing yet...' : this.props.latestMessage), this.props.unread_count >= 1 && React.createElement(\"span\", {\n        className: \"str-chat__channel-preview-unread-count\"\n      }, this.props.unread_count))));\n    }\n  }]);\n\n  return ChannelPreviewLastMessage;\n}(PureComponent);\n\nvar ChannelPreviewCountOnly =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ChannelPreviewCountOnly, _PureComponent);\n\n  function ChannelPreviewCountOnly() {\n    _classCallCheck(this, ChannelPreviewCountOnly);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ChannelPreviewCountOnly).apply(this, arguments));\n  }\n\n  _createClass(ChannelPreviewCountOnly, [{\n    key: \"render\",\n    value: function render() {\n      var unreadClass = this.props.unread_count >= 1 ? 'unread' : '';\n      var name = this.props.channel.data.name || this.props.channel.cid;\n      return React.createElement(\"div\", {\n        className: unreadClass\n      }, React.createElement(\"button\", {\n        onClick: this.props.setActiveChannel.bind(this, this.props.channel)\n      }, ' ', name, \" \", React.createElement(\"span\", null, this.props.unread_count)));\n    }\n  }]);\n\n  return ChannelPreviewCountOnly;\n}(PureComponent);\n\nvar ChannelPreview =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ChannelPreview, _PureComponent);\n\n  function ChannelPreview(props) {\n    var _this;\n\n    _classCallCheck(this, ChannelPreview);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ChannelPreview).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleEvent\", function (event) {\n      var channel = _this.props.channel;\n      var isActive = _this.props.activeChannel.cid === channel.cid;\n\n      if (!isActive) {\n        var unread = channel.countUnread(_this.state.lastRead);\n\n        _this.setState({\n          lastMessage: event.message,\n          unread: unread\n        });\n      } else {\n        _this.setState({\n          lastMessage: event.message,\n          unread: 0\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getLatestMessage\", function () {\n      var channel = _this.props.channel;\n      var latestMessage = channel.state.messages[channel.state.messages.length - 1];\n\n      if (!latestMessage) {\n        return 'Nothing yet...';\n      }\n\n      if (latestMessage.deleted_at) {\n        return 'Message deleted';\n      }\n\n      if (latestMessage.text) {\n        return latestMessage.text;\n      } else {\n        if (latestMessage.command) {\n          return '/' + latestMessage.command;\n        }\n\n        if (latestMessage.attachments.length) {\n          return ' Attachment...';\n        }\n\n        return 'Empty message...';\n      }\n    });\n\n    _this.state = {\n      unread: 0,\n      lastMessage: {},\n      lastRead: new Date()\n    };\n    return _this;\n  }\n\n  _createClass(ChannelPreview, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // listen to change...\n      var channel = this.props.channel;\n      channel.on('message.new', this.handleEvent);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var channel = this.props.channel;\n      channel.off('message.new', this.handleEvent);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.activeChannel.cid !== prevProps.activeChannel.cid) {\n        var isActive = this.props.activeChannel.cid === this.props.channel.cid;\n\n        if (isActive) {\n          this.setState({\n            unread: 0,\n            lastRead: new Date()\n          });\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = _objectSpread({}, this.state, this.props);\n\n      var Preview = this.props.Preview;\n      return React.createElement(Preview, _extends({}, props, {\n        latestMessage: this.getLatestMessage(),\n        active: this.props.activeChannel.cid === this.props.channel.cid\n      }));\n    }\n  }]);\n\n  return ChannelPreview;\n}(PureComponent);\n\n_defineProperty(ChannelPreview, \"propTypes\", {\n  channel: PropTypes.object.isRequired,\n  client: PropTypes.object.isRequired,\n  activeChannel: PropTypes.object.isRequired,\n  setActiveChannel: PropTypes.func.isRequired,\n  Preview: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n});\n\n_defineProperty(ChannelPreview, \"defaultProps\", {\n  Preview: ChannelPreviewCountOnly\n});\n/**\n * LoadingChannels - Fancy loading indicator for the channel list\n *\n * @example ./docs/LoadingChannels.md\n */\n\n\nvar LoadingChannels = function LoadingChannels() {\n  return React.createElement(\"div\", {\n    className: \"str-chat__loading-channels\"\n  }, React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-item\"\n  }, React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-avatar\"\n  }), React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-meta\"\n  }, React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-username\"\n  }), React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-status\"\n  }))), React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-item\"\n  }, React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-avatar\"\n  }), React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-meta\"\n  }, React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-username\"\n  }), React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-status\"\n  }))), React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-item\"\n  }, React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-avatar\"\n  }), React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-meta\"\n  }, React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-username\"\n  }), React.createElement(\"div\", {\n    className: \"str-chat__loading-channels-status\"\n  }))));\n};\n\nvar placeholder = \"data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3Csvg%20width%3D%2278px%22%20height%3D%2278px%22%20viewBox%3D%220%200%2078%2078%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%20%20%20%20%20%20%20%20%3Ctitle%3ECombined%20Shape%3C%2Ftitle%3E%20%20%20%20%3Cdesc%3ECreated%20with%20Sketch.%3C%2Fdesc%3E%20%20%20%20%3Cg%20id%3D%22Interactions%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%20%20%20%20%20%20%20%20%3Cg%20id%3D%22Connection-Error-_-Connectivity%22%20transform%3D%22translate%28-270.000000%2C%20-30.000000%29%22%20fill%3D%22%23CF1F25%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cg%20id%3D%22109-network-connection%22%20transform%3D%22translate%28270.000000%2C%2030.000000%29%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M66.4609744%2C11.414231%20C81.6225232%2C26.5757798%2081.6225232%2C51.157545%2066.4609744%2C66.3188467%20C51.2994256%2C81.4803954%2026.7176604%2C81.4803954%2011.5563587%2C66.3188467%20C-3.60519004%2C51.1572979%20-3.60519004%2C26.5755327%2011.5563587%2C11.414231%20C26.7179075%2C-3.74731776%2051.2996727%2C-3.74731776%2066.4609744%2C11.414231%20Z%20M54.7853215%2C45.8823776%20L54.7853215%2C40.5882574%20C54.7853215%2C39.613638%2053.9952341%2C38.8235506%2053.0206147%2C38.8235506%20L44.9576695%2C38.8235506%20L41.428256%2C42.3529641%20L51.255555%2C42.3529641%20L51.255555%2C45.8823776%20L54.7853215%2C45.8823776%20Z%20M40.6659027%2C43.1153174%20L37.8988425%2C45.8823776%20L40.6659027%2C45.8823776%20L40.6659027%2C43.1153174%20Z%20M51.1764962%2C56.4702653%20L58.2353232%2C56.4702653%20C59.2099355%2C56.4702653%2060.00003%2C55.6801708%2060.00003%2C54.7055585%20L60.00003%2C51.176145%20C60.00003%2C50.2015327%2059.2099355%2C49.4114382%2058.2353232%2C49.4114382%20L51.1764962%2C49.4114382%20C50.2018839%2C49.4114382%2049.4117894%2C50.2015327%2049.4117894%2C51.176145%20L49.4117894%2C54.7055585%20C49.4117894%2C55.6801708%2050.2018839%2C56.4702653%2051.1764962%2C56.4702653%20Z%20M35.2941353%2C56.4702653%20L42.3529624%2C56.4702653%20C43.3275746%2C56.4702653%2044.1176691%2C55.6801708%2044.1176691%2C54.7055585%20L44.1176691%2C51.176145%20C44.1176691%2C50.2015327%2043.3275746%2C49.4114382%2042.3529624%2C49.4114382%20L35.2941353%2C49.4114382%20C34.319523%2C49.4114382%2033.5294285%2C50.2015327%2033.5294285%2C51.176145%20L33.5294285%2C54.7055585%20C33.5294285%2C55.6801708%2034.319523%2C56.4702653%2035.2941353%2C56.4702653%20Z%20M56.6964989%2C19.0874231%20C56.007381%2C18.3985134%2054.8903216%2C18.3985134%2054.2012036%2C19.087423%20L45.882376%2C27.4062507%20L45.882376%2C19.4117761%20C45.882376%2C18.4371568%2045.0922885%2C17.6470693%2044.1176692%2C17.6470693%20L33.5294286%2C17.6470693%20C32.5548092%2C17.6470694%2031.7647218%2C18.4371568%2031.7647218%2C19.4117761%20L31.7647218%2C30.0000167%20C31.7647219%2C30.9746363%2032.5548092%2C31.7647237%2033.5294285%2C31.7647237%20L41.5239031%2C31.7647237%20L34.4650761%2C38.8235508%20L24.7058947%2C38.8235508%20C23.7312753%2C38.8235508%2022.9411879%2C39.6136382%2022.9411879%2C40.5882575%20L22.9411879%2C45.8823778%20L26.4706014%2C45.8823778%20L26.4706014%2C42.3529643%20L30.9356624%2C42.3529643%20L23.8768354%2C49.4117914%20L19.4117743%2C49.4117914%20C18.4371549%2C49.4117914%2017.6470675%2C50.2018788%2017.6470675%2C51.1764981%20L17.6470675%2C54.7059117%20C17.6504049%2C54.9674302%2017.7129076%2C55.2248042%2017.8298886%2C55.4587302%20L16.4456526%2C56.8429662%20C15.7446193%2C57.5200453%2015.7252005%2C58.6372282%2016.4022825%2C59.3382615%20C17.0793616%2C60.0392948%2018.1965445%2C60.0587136%2018.8975778%2C59.3816316%20C18.9122847%2C59.3674273%2018.9267436%2C59.3529684%2018.940948%2C59.3382615%20L56.6964963%2C21.5830662%20C57.3856425%2C20.8939094%2057.3856425%2C19.7765747%2056.6964963%2C19.0874179%20Z%22%20id%3D%22Combined-Shape%22%3E%3C%2Fpath%3E%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%3C%2Fg%3E%3C%2Fsvg%3E\";\n/**\n * ChatDown - Indicator that chat is down or your network isn't working\n *\n * @example ./docs/ChatDown.md\n * @extends PureComponent\n */\n\nvar ChatDown =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(ChatDown, _React$PureComponent);\n\n  function ChatDown() {\n    _classCallCheck(this, ChatDown);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ChatDown).apply(this, arguments));\n  }\n\n  _createClass(ChatDown, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          image = _this$props.image,\n          type = _this$props.type,\n          text = _this$props.text;\n      return React.createElement(\"div\", {\n        className: \"str-chat__down\"\n      }, React.createElement(LoadingChannels, null), React.createElement(\"div\", {\n        className: \"str-chat__down-main\"\n      }, React.createElement(\"img\", {\n        src: image\n      }), React.createElement(\"h1\", null, type), React.createElement(\"h3\", null, text)));\n    }\n  }]);\n\n  return ChatDown;\n}(React.PureComponent);\n\n_defineProperty(ChatDown, \"propTypes\", {\n  /** The image url for this error */\n  image: PropTypes.string,\n\n  /** The type of error */\n  type: PropTypes.string,\n\n  /** The error message to show */\n  text: PropTypes.string\n});\n\n_defineProperty(ChatDown, \"defaultProps\", {\n  image: placeholder,\n  type: 'Error',\n  text: 'Error connecting to chat, refresh the page to try again.'\n});\n\nvar chevrondown = \"data:image/svg+xml,%3Csvg%20width%3D%228%22%20height%3D%225%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cdefs%3E%3Cpath%20id%3D%22b%22%20d%3D%22M.667.667L4%204%207.333.667z%22%2F%3E%3Cfilter%20x%3D%22-7.5%25%22%20y%3D%22-15%25%22%20width%3D%22115%25%22%20height%3D%22160%25%22%20filterUnits%3D%22objectBoundingBox%22%20id%3D%22a%22%3E%3CfeOffset%20dy%3D%221%22%20in%3D%22SourceAlpha%22%20result%3D%22shadowOffsetOuter1%22%2F%3E%3CfeComposite%20in%3D%22shadowOffsetOuter1%22%20in2%3D%22SourceAlpha%22%20operator%3D%22out%22%20result%3D%22shadowOffsetOuter1%22%2F%3E%3CfeColorMatrix%20values%3D%220%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.685858243%200%22%20in%3D%22shadowOffsetOuter1%22%2F%3E%3C%2Ffilter%3E%3C%2Fdefs%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cuse%20fill%3D%22%23000%22%20filter%3D%22url%28%23a%29%22%20xlink%3Ahref%3D%22%23b%22%2F%3E%3Cuse%20fill-opacity%3D%22.7%22%20fill%3D%22%23FFF%22%20xlink%3Ahref%3D%22%23b%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\";\n/**\n * ChannelList - A preview list of channels, allowing you to select the channel you want to open\n * @example ./examples/ChannelList.md\n */\n\nvar ChannelListTeam =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ChannelListTeam, _PureComponent);\n\n  function ChannelListTeam() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ChannelListTeam);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ChannelListTeam)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderLoading\", function () {\n      var Loader = _this.props.LoadingIndicator;\n      return React.createElement(Loader, {\n        isLoading: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderChannels\", function () {\n      return _this.props.channels.map(function (c) {\n        return React.createElement(ChannelPreview, _extends({}, _this.props, {\n          activeChannel: _this.props.channel,\n          key: c.cid,\n          channel: c,\n          Preview: _this.props.Preview\n        }));\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(ChannelListTeam, [{\n    key: \"render\",\n    value: function render() {\n      var showSidebar = this.props.showSidebar;\n\n      if (this.props.error) {\n        return React.createElement(ChatDown, {\n          type: \"Connection Error\"\n        });\n      } else if (this.props.loading) {\n        return React.createElement(LoadingChannels, null);\n      } else {\n        return React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team\"\n        }, showSidebar && React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team__sidebar\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team__sidebar--top\"\n        }, React.createElement(Avatar, {\n          image: \"https://cdn.dribbble.com/users/610788/screenshots/5157282/spacex.png\",\n          size: 50\n        }))), React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team__main\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team__header\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team__header--left\"\n        }, React.createElement(Avatar, {\n          source: this.props.client.user.image,\n          name: this.props.client.user.name || this.props.client.user.id,\n          size: 40\n        })), React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team__header--middle\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team__header--title\"\n        }, this.props.client.user.name || this.props.client.user.id), React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team__header--status \".concat(this.props.client.user.status)\n        }, this.props.client.user.status)), React.createElement(\"div\", {\n          className: \"str-chat__channel-list-team__header--right\"\n        }, React.createElement(\"button\", {\n          className: \"str-chat__channel-list-team__header--button\"\n        }, React.createElement(\"img\", {\n          src: chevrondown\n        })))), this.renderChannels()));\n      }\n    }\n  }]);\n\n  return ChannelListTeam;\n}(PureComponent);\n\n_defineProperty(ChannelListTeam, \"propTypes\", {\n  /** Channels can be either an array of channels or a promise which resolves to an array of channels */\n  channels: PropTypes.oneOfType([PropTypes.array, PropTypes.objectOf({\n    then: PropTypes.func\n  }), PropTypes.object]).isRequired,\n\n  /** The Preview to use, defaults to ChannelPreviewLastMessage */\n  Preview: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** The loading indicator to use */\n  LoadingIndicator: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n});\n\n_defineProperty(ChannelListTeam, \"defaultProps\", {\n  Preview: ChannelPreviewLastMessage,\n  LoadingIndicator: LoadingChannels\n});\n\nChannelListTeam = withChatContext(ChannelListTeam);\n/**\n * ChannelList - A preview list of channels, allowing you to select the channel you want to open\n * @extends PureComponent\n * @example ./docs/ChannelList.md\n */\n\nvar ChannelList =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ChannelList, _PureComponent);\n\n  function ChannelList(props) {\n    var _this;\n\n    _classCallCheck(this, ChannelList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ChannelList).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"clickCreateChannel\", function (e) {\n      _this.props.setChannelStart();\n\n      e.target.blur();\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"closeMenu\", function () {\n      _this.menuButton.current.checked = false;\n    });\n\n    _this.state = {\n      error: false,\n      loading: true,\n      channels: []\n    };\n    _this.menuButton = React.createRef();\n    return _this;\n  }\n\n  _createClass(ChannelList, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var channelQueryResponse;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                channelQueryResponse = this.props.channels;\n\n                if (!isPromise(channelQueryResponse)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.next = 5;\n                return this.props.channels;\n\n              case 5:\n                channelQueryResponse = _context.sent;\n\n                if (channelQueryResponse.length >= 1) {\n                  this.props.setActiveChannel(channelQueryResponse[0]);\n                }\n\n              case 7:\n                this.setState({\n                  loading: false,\n                  channels: channelQueryResponse\n                });\n                _context.next = 14;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](0);\n                console.log(_context.t0);\n                this.setState({\n                  error: true\n                });\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 10]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"componentDidCatch\",\n    value: function componentDidCatch(error, info) {\n      console.warn(error, info);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var context = {\n        clickCreateChannel: this.clickCreateChannel,\n        closeMenu: this.closeMenu\n      };\n      var List = this.props.List;\n      return React.createElement(React.Fragment, null, React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"str-chat-channel-checkbox\",\n        ref: this.menuButton,\n        className: \"str-chat-channel-checkbox\"\n      }), React.createElement(\"label\", {\n        htmlFor: \"str-chat-channel-checkbox\",\n        className: \"str-chat-channel-list-burger\"\n      }, React.createElement(\"div\", null)), React.createElement(\"div\", {\n        className: \"str-chat str-chat-channel-list \".concat(this.props.theme, \" \").concat(this.props.open ? 'str-chat-channel-list--open' : ''),\n        ref: this.channelList\n      }, React.createElement(List, _extends({}, this.props, this.state, context))));\n    }\n  }], [{\n    key: \"getDerivedStateFromError\",\n    value: function getDerivedStateFromError() {\n      return {\n        error: true\n      };\n    }\n  }]);\n\n  return ChannelList;\n}(PureComponent);\n\n_defineProperty(ChannelList, \"propTypes\", {\n  /** Channels can be either an array of channels or a promise which resolves to an array of channels */\n  channels: PropTypes.oneOfType([PropTypes.array, PropTypes.objectOf({\n    then: PropTypes.func\n  }), PropTypes.object]).isRequired,\n\n  /** The Preview to use, defaults to ChannelPreviewLastMessage */\n  Preview: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** The loading indicator to use */\n  LoadingIndicator: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n  List: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n});\n\n_defineProperty(ChannelList, \"defaultProps\", {\n  Preview: ChannelPreviewLastMessage,\n  LoadingIndicator: LoadingIndicator,\n  List: ChannelListTeam\n});\n\nChannelList = withChatContext(ChannelList);\n\nvar ChannelPreviewMessenger =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ChannelPreviewMessenger, _PureComponent);\n\n  function ChannelPreviewMessenger() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ChannelPreviewMessenger);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ChannelPreviewMessenger)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"channelPreviewButton\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onSelectChannel\", function () {\n      _this.props.setActiveChannel(_this.props.channel);\n\n      _this.channelPreviewButton.current.blur();\n\n      _this.props.closeMenu();\n    });\n\n    return _this;\n  }\n\n  _createClass(ChannelPreviewMessenger, [{\n    key: \"render\",\n    value: function render() {\n      var unreadClass = this.props.unread_count >= 1 ? 'str-chat__channel-preview-messenger--unread' : '';\n      var activeClass = this.props.active ? 'str-chat__channel-preview-messenger--active' : '';\n      var channel = this.props.channel;\n      return React.createElement(\"button\", {\n        onClick: this.onSelectChannel,\n        ref: this.channelPreviewButton,\n        className: \"str-chat__channel-preview-messenger \".concat(unreadClass, \" \").concat(activeClass)\n      }, React.createElement(\"div\", {\n        className: \"str-chat__channel-preview-messenger--left\"\n      }, React.createElement(Avatar, {\n        image: channel.data.image,\n        size: 40\n      })), React.createElement(\"div\", {\n        className: \"str-chat__channel-preview-messenger--right\"\n      }, React.createElement(\"div\", {\n        className: \"str-chat__channel-preview-messenger--name\"\n      }, channel.data.name), React.createElement(\"div\", {\n        className: \"str-chat__channel-preview-messenger--last-message\"\n      }, !channel.state.messages[0] ? 'Nothing yet...' : truncate(this.props.latestMessage, 14))));\n    }\n  }]);\n\n  return ChannelPreviewMessenger;\n}(PureComponent);\n/**\n * ChannelList - A preview list of channels, allowing you to select the channel you want to open\n * @example ./examples/ChannelList.md\n */\n\n\nvar ChannelListMessenger =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(ChannelListMessenger, _PureComponent);\n\n  function ChannelListMessenger() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ChannelListMessenger);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ChannelListMessenger)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderLoading\", function () {\n      var Loader = _this.props.LoadingIndicator;\n      return React.createElement(Loader, {\n        isLoading: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderChannels\", function () {\n      return _this.props.channels.map(function (c) {\n        return React.createElement(ChannelPreview, _extends({}, _this.props, {\n          activeChannel: _this.props.channel,\n          key: c.cid,\n          channel: c,\n          closeMenu: _this.props.closeMenu,\n          Preview: _this.props.Preview\n        }));\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(ChannelListMessenger, [{\n    key: \"render\",\n    value: function render() {\n      if (this.props.error) {\n        return React.createElement(ChatDown, {\n          type: \"Connection Error\"\n        });\n      } else if (this.props.loading) {\n        return React.createElement(LoadingChannels, null);\n      } else {\n        return React.createElement(\"div\", {\n          className: \"str-chat__channel-list-messenger\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__channel-list-messenger__main\"\n        }, this.renderChannels()));\n      }\n    }\n  }]);\n\n  return ChannelListMessenger;\n}(PureComponent);\n\n_defineProperty(ChannelListMessenger, \"propTypes\", {\n  /** Channels can be either an array of channels or a promise which resolves to an array of channels */\n  channels: PropTypes.oneOfType([PropTypes.array, PropTypes.objectOf({\n    then: PropTypes.func\n  }), PropTypes.object]).isRequired,\n\n  /** The Preview to use, defaults to ChannelPreviewMessenger */\n  Preview: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** The loading indicator to use */\n  LoadingIndicator: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n});\n\n_defineProperty(ChannelListMessenger, \"defaultProps\", {\n  Preview: ChannelPreviewMessenger,\n  LoadingIndicator: LoadingChannels\n});\n\nChannelListMessenger = withChatContext(ChannelListMessenger);\n\nvar ChannelPreviewCompact =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(ChannelPreviewCompact, _React$PureComponent);\n\n  function ChannelPreviewCompact() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ChannelPreviewCompact);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ChannelPreviewCompact)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"channelPreviewButton\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onSelectChannel\", function () {\n      _this.props.setActiveChannel(_this.props.channel);\n\n      _this.channelPreviewButton.current.blur();\n    });\n\n    return _this;\n  }\n\n  _createClass(ChannelPreviewCompact, [{\n    key: \"render\",\n    value: function render() {\n      var unreadClass = this.props.unread_count >= 1 ? 'str-chat__channel-preview-compact--unread' : '';\n      var activeClass = this.props.active ? 'str-chat__channel-preview-compact--active' : '';\n      var name = this.props.channel.data.name || this.props.channel.cid;\n      return React.createElement(\"button\", {\n        onClick: this.onSelectChannel,\n        ref: this.channelPreviewButton,\n        className: \"str-chat__channel-preview-compact \".concat(unreadClass, \" \").concat(activeClass)\n      }, React.createElement(\"div\", {\n        className: \"str-chat__channel-preview-compact--left\"\n      }, React.createElement(Avatar, {\n        image: this.props.channel.data.image,\n        size: 20\n      })), React.createElement(\"div\", {\n        className: \"str-chat__channel-preview-compact--right\"\n      }, name));\n    }\n  }]);\n\n  return ChannelPreviewCompact;\n}(React.PureComponent);\n/**\n * MessageCommerce - Render component, should be used together with the Message component\n *\n * @example ./docs/MessageSimple.md\n * @extends PureComponent\n */\n\n\nvar MessageCommerce =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(MessageCommerce, _PureComponent);\n\n  function MessageCommerce() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MessageCommerce);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MessageCommerce)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      isFocused: false,\n      actionsBoxOpen: false,\n      showDetailedReactions: false\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"messageActionsRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"reactionSelectorRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_onClickOptionsAction\", function () {\n      _this.setState({\n        actionsBoxOpen: true\n      }, function () {\n        return document.addEventListener('click', _this.hideOptions, false);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_hideOptions\", function () {\n      _this.setState({\n        actionsBoxOpen: false\n      });\n\n      document.removeEventListener('click', _this.hideOptions, false);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_clickReactionList\", function () {\n      _this.setState(function () {\n        return {\n          showDetailedReactions: true\n        };\n      }, function () {\n        document.addEventListener('click', _this._closeDetailedReactions);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_closeDetailedReactions\", function (e) {\n      if (!_this.reactionSelectorRef.current.reactionSelector.current.contains(e.target)) {\n        _this.setState(function () {\n          return {\n            showDetailedReactions: false\n          };\n        }, function () {\n          document.removeEventListener('click', _this._closeDetailedReactions);\n        });\n      } else {\n        return {};\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(MessageCommerce, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (!this.props.message.deleted_at) {\n        document.removeEventListener('click', this._closeDetailedReactions);\n      }\n    }\n  }, {\n    key: \"isMine\",\n    value: function isMine() {\n      return this.props.Message.isMyMessage(this.props.message);\n    }\n  }, {\n    key: \"renderOptions\",\n    value: function renderOptions() {\n      if (this.props.message.type === 'error' || this.props.initialMessage) {\n        return;\n      }\n\n      if (this.isMine()) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__message-commerce__actions\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__message-commerce__actions__action str-chat__message-commerce__actions__action--reactions\",\n          onClick: this._clickReactionList\n        }, React.createElement(\"svg\", {\n          width: \"14\",\n          height: \"14\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\",\n          fillRule: \"evenodd\"\n        }))));\n      } else {\n        return React.createElement(\"div\", {\n          className: \"str-chat__message-commerce__actions\"\n        }, React.createElement(\"div\", {\n          className: \"str-chat__message-commerce__actions__action str-chat__message-commerce__actions__action--reactions\",\n          onClick: this._clickReactionList\n        }, React.createElement(\"svg\", {\n          width: \"14\",\n          height: \"14\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\",\n          fillRule: \"evenodd\"\n        }))));\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          message = _this$props.message,\n          groupStyles = _this$props.groupStyles;\n      var Attachment$$1 = this.props.Attachment;\n      var when = moment(message.created_at).format('LT');\n      var messageClasses = this.isMine() ? 'str-chat__message-commerce str-chat__message-commerce--left' : 'str-chat__message-commerce str-chat__message-commerce--right';\n      var hasAttachment = Boolean(message.attachments && message.attachments.length);\n      var images = hasAttachment && message.attachments.filter(function (item) {\n        return item.type === 'image';\n      });\n      var hasReactions = Boolean(message.latest_reactions && message.latest_reactions.length);\n\n      if (message.type === 'message.read' || message.deleted_at || message.type === 'message.date') {\n        return null;\n      }\n\n      if (message.deleted_at) {\n        return React.createElement(React.Fragment, null, React.createElement(\"span\", {\n          key: message.id,\n          className: \"\".concat(messageClasses, \" str-chat__message--deleted \").concat(message.type, \" \")\n        }, message.user.id === this.props.client.user.id ? 'You' : message.user.name || message.user.id, ' ', \"deleted this message...\"), React.createElement(\"div\", {\n          className: \"clearfix\"\n        }));\n      }\n\n      return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        key: message.id,\n        className: \"\\n\\t\\t\\t\\t\\t\\t\".concat(messageClasses, \"\\n\\t\\t\\t\\t\\t\\tstr-chat__message-commerce--\").concat(message.type, \"\\n\\t\\t\\t\\t\\t\\t\").concat(message.text ? 'str-chat__message-commerce--has-text' : 'str-chat__message-commerce--has-no-text', \"\\n\\t\\t\\t\\t\\t\\t\").concat(hasAttachment ? 'str-chat__message-commerce--has-attachment' : '', \"\\n\\t\\t\\t\\t\\t\\t\").concat(hasReactions ? 'str-chat__message-commerce--with-reactions' : '', \"\\n\\t\\t\\t\\t\\t\\t\", \"str-chat__message-commerce--\".concat(groupStyles[0]), \"\\n\\t\\t\\t\\t\\t\").trim(),\n        onMouseLeave: this._hideOptions,\n        ref: this.messageRef\n      }, (groupStyles[0] === 'bottom' || groupStyles[0] === 'single') && React.createElement(Avatar, {\n        image: message.user.image,\n        size: 32,\n        name: message.user.name || message.user.id\n      }), React.createElement(\"div\", {\n        className: \"str-chat__message-commerce-inner\"\n      }, !message.text && React.createElement(React.Fragment, null, this.renderOptions(), hasReactions > 0 && !this.state.showDetailedReactions && React.createElement(ReactionsList, {\n        mine: !this.isMine(),\n        messageList: this.props.messageListRect,\n        reactions: message.latest_reactions,\n        reaction_counts: message.reaction_counts,\n        onClick: this._clickReactionList\n      }), this.state.showDetailedReactions && React.createElement(ReactionSelector, {\n        reverse: false,\n        handleReaction: this.props.handleReaction,\n        actionsEnabled: this.props.actionsEnabled,\n        detailedView: true,\n        reaction_counts: message.reaction_counts,\n        latest_reactions: message.latest_reactions,\n        messageList: this.props.messageListRect,\n        ref: this.reactionSelectorRef\n      })), hasAttachment && images.length <= 1 && message.attachments.map(function (attachment, index) {\n        return React.createElement(Attachment$$1, {\n          key: \"\".concat(message.id, \"-\").concat(index),\n          attachment: attachment,\n          actionHandler: _this2.props.handleAction\n        });\n      }), images.length > 1 && React.createElement(Gallery, {\n        images: images\n      }), message.text && React.createElement(\"div\", {\n        className: \"str-chat__message-commerce-text\"\n      }, React.createElement(\"div\", {\n        className: \"str-chat__message-commerce-text-inner\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\".concat(this.state.isFocused ? 'str-chat__message-commerce-text-inner--focused' : '', \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\").concat(hasAttachment ? 'str-chat__message-commerce-text-inner--has-attachment' : '', \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\").concat(isOnlyEmojis(message.text) ? 'str-chat__message-commerce-text-inner--is-emoji' : '', \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\").trim()\n      }, message.type === 'error' && React.createElement(\"div\", {\n        className: \"str-chat__commerce-message--error-message\"\n      }, \"Error \\xB7 Unsent\"), renderText(message.text), hasReactions > 0 && !this.state.showDetailedReactions && React.createElement(ReactionsList, {\n        mine: !this.isMine(),\n        messageList: this.props.messageListRect,\n        reactions: message.latest_reactions,\n        reaction_counts: message.reaction_counts,\n        onClick: this._clickReactionList\n      }), this.state.showDetailedReactions && React.createElement(ReactionSelector, {\n        reverse: false,\n        handleReaction: this.props.handleReaction,\n        actionsEnabled: this.props.actionsEnabled,\n        detailedView: true,\n        reaction_counts: message.reaction_counts,\n        latest_reactions: message.latest_reactions,\n        messageList: this.props.messageListRect,\n        ref: this.reactionSelectorRef\n      })), message.text && this.renderOptions()), !this.props.threadList && React.createElement(\"div\", {\n        className: \"str-chat__message-commerce-reply-button\"\n      }, React.createElement(MessageRepliesCountButton, {\n        onClick: this.props.openThread,\n        reply_count: message.reply_count\n      })), React.createElement(\"div\", {\n        className: \"str-chat__message-commerce-data\"\n      }, this.isMine() ? React.createElement(\"span\", {\n        className: \"str-chat__message-commerce-name\"\n      }, message.user.name || message.user.id) : null, React.createElement(\"span\", {\n        className: \"str-chat__message-commerce-timestamp\"\n      }, when)))));\n    }\n  }]);\n\n  return MessageCommerce;\n}(PureComponent);\n\n_defineProperty(MessageCommerce, \"propTypes\", {\n  /** The message object */\n  message: PropTypes.object,\n\n  /** The attachment component */\n  Attachment: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n});\n\n_defineProperty(MessageCommerce, \"defaultProps\", {\n  Attachment: Attachment\n});\n\nvar SimpleReactionsList =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(SimpleReactionsList, _React$PureComponent);\n\n  function SimpleReactionsList() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, SimpleReactionsList);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(SimpleReactionsList)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      showTooltip: false,\n      users: []\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"showTooltip\", function () {\n      _this.setState({\n        showTooltip: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"hideTooltip\", function () {\n      _this.setState({\n        showTooltip: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleReaction\", function (e, type) {\n      if (e !== undefined && e.preventDefault) {\n        e.preventDefault();\n      }\n\n      _this.props.handleReaction(type);\n\n      _this.setUsernames(type);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getReactionCount\", function () {\n      var reaction_counts = _this.props.reaction_counts;\n      var count = null;\n\n      if (reaction_counts !== null && reaction_counts !== undefined && Object.keys(reaction_counts).length > 0) {\n        count = 0;\n        Object.keys(reaction_counts).map(function (key) {\n          return count += reaction_counts[key];\n        });\n      }\n\n      return count;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderUsers\", function (users) {\n      return users.map(function (user, i) {\n        var text = user;\n\n        if (i + 1 < users.length) {\n          text += ', ';\n        }\n\n        return React.createElement(\"span\", {\n          className: \"latest-user-username\",\n          key: \"key-\".concat(i, \"-\").concat(user)\n        }, text);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getReactionsByType\", function (reactions) {\n      var reactionsByType = {};\n      reactions.map(function (item) {\n        if (reactionsByType[item.type] === undefined) {\n          return reactionsByType[item.type] = [item];\n        } else {\n          return reactionsByType[item.type] = [].concat(_toConsumableArray(reactionsByType[item.type]), [item]);\n        }\n      });\n      return reactionsByType;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderReactions\", function (reactions) {\n      var reactionsByType = _this.getReactionsByType(reactions);\n\n      var reactionsEmojis = _this.props.reactionOptions.reduce(function (acc, cur) {\n        return _objectSpread({}, acc, _defineProperty({}, cur.id, cur));\n      }, {});\n\n      return Object.keys(reactionsByType).map(function (type, i) {\n        return React.createElement(\"li\", {\n          className: \"str-chat__simple-reactions-list-item\",\n          key: \"\".concat(reactionsByType[type][0].id, \"-\").concat(i),\n          onClick: function onClick(e) {\n            return _this.handleReaction(e, type);\n          }\n        }, React.createElement(\"span\", {\n          onMouseEnter: function onMouseEnter() {\n            return _this.setUsernames(type);\n          }\n        }, React.createElement(NimbleEmoji, _extends({\n          emoji: reactionsEmojis[type]\n        }, emojiSetDef, {\n          size: 13,\n          data: emojiData\n        })), \"\\xA0\"));\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getUsernames\", function (reactions) {\n      var usernames = reactions.map(function (item) {\n        return item.user !== null ? item.user.name || item.user.id : 'null';\n      });\n      return usernames;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"setUsernames\", function (type) {\n      var reactionsByType = _this.getReactionsByType(_this.props.reactions);\n\n      var reactions = reactionsByType[type];\n\n      var users = _this.getUsernames(reactions);\n\n      _this.setState({\n        users: users\n      }, function () {\n        return _this.showTooltip();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderUsernames\", function (users) {\n      var str = users.join(', ');\n      return str;\n    });\n\n    return _this;\n  }\n\n  _createClass(SimpleReactionsList, [{\n    key: \"render\",\n    value: function render() {\n      var reactions = this.props.reactions;\n\n      if (!reactions || reactions.length === 0) {\n        return null;\n      }\n\n      return React.createElement(\"ul\", {\n        className: \"str-chat__simple-reactions-list\",\n        onMouseLeave: this.hideTooltip\n      }, this.state.showTooltip && React.createElement(\"div\", {\n        className: \"str-chat__simple-reactions-list-tooltip\",\n        ref: this.reactionSelectorTooltip\n      }, React.createElement(\"div\", {\n        className: \"arrow\"\n      }), this.renderUsernames(this.state.users)), this.renderReactions(reactions), reactions.length !== 0 && React.createElement(\"li\", {\n        className: \"str-chat__simple-reactions-list-item--last-number\"\n      }, this.getReactionCount()));\n    }\n  }]);\n\n  return SimpleReactionsList;\n}(React.PureComponent);\n\n_defineProperty(SimpleReactionsList, \"propTypes\", {\n  reactions: PropTypes.array,\n  reaction_coutns: PropTypes.object,\n  renderReactions: PropTypes.func,\n  showTooltip: PropTypes.bool,\n\n  /** Provide a list of reaction options [{name: 'angry', emoji: 'angry'}] */\n  reactionOptions: PropTypes.array\n});\n\n_defineProperty(SimpleReactionsList, \"defaultProps\", {\n  showTooltip: true,\n  reactionOptions: defaultMinimalEmojis,\n  emojiSetDef: emojiSetDef\n});\n\nvar reactionSvg = '<svg width=\"14\" height=\"14\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\" fillRule=\"evenodd\"/></svg>';\nvar threadSvg = '<svg width=\"14\" height=\"10\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M8.516 3c4.78 0 4.972 6.5 4.972 6.5-1.6-2.906-2.847-3.184-4.972-3.184v2.872L3.772 4.994 8.516.5V3zM.484 5l4.5-4.237v1.78L2.416 5l2.568 2.125v1.828L.484 5z\" fillRule=\"evenodd\" /></svg>';\nvar optionsSvg = '<svg width=\"11\" height=\"3\" viewBox=\"0 0 11 3\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z\" fillRule=\"nonzero\" /></svg>';\n/**\n * MessageLivestream - Render component, should be used together with the Message component\n * Implements the look and feel for a livestream use case.\n *\n * @example ./docs/MessageLivestream.md\n * @extends PureComponent\n */\n\nvar MessageLivestream =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(MessageLivestream, _React$PureComponent);\n\n  function MessageLivestream() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MessageLivestream);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MessageLivestream)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      actionsBoxOpen: false,\n      reactionSelectorOpen: false\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"reactionSelectorRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"editMessageFormRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onClickReactionsAction\", function () {\n      _this.setState({\n        reactionSelectorOpen: true\n      }, function () {\n        return document.addEventListener('click', _this.hideReactions, false);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onClickOptionsAction\", function () {\n      _this.setState({\n        actionsBoxOpen: true\n      }, function () {\n        return document.addEventListener('click', _this.hideOptions, false);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"hideOptions\", function () {\n      _this.setState({\n        actionsBoxOpen: false\n      });\n\n      document.removeEventListener('click', _this.hideOptions, false);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"hideReactions\", function (e) {\n      if (!_this.reactionSelectorRef.current.reactionSelector.current.contains(e.target)) {\n        _this.setState({\n          reactionSelectorOpen: false\n        });\n\n        document.removeEventListener('click', _this.hideReactions, false);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onMouseLeaveMessage\", function () {\n      _this.hideOptions();\n\n      _this.setState({\n        reactionSelectorOpen: false\n      }, function () {\n        return document.removeEventListener('click', _this.hideReactions, false);\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(MessageLivestream, [{\n    key: \"isMine\",\n    value: function isMine() {\n      return this.props.Message.isMyMessage(this.props.message);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener('click', this.hideOptions, false);\n      document.removeEventListener('click', this.hideReactions, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          Attachment$$1 = _this$props.Attachment,\n          message = _this$props.message,\n          groupStyles = _this$props.groupStyles;\n      var hasAttachment = Boolean(message.attachments && message.attachments.length);\n      var galleryImages = message.attachments.filter(function (item) {\n        return item.type === 'image';\n      });\n      var attachments = message.attachments;\n\n      if (galleryImages.length > 1) {\n        attachments = message.attachments.filter(function (item) {\n          return item.type !== 'image';\n        });\n      } else {\n        galleryImages = [];\n      }\n\n      if (message.type === 'message.read') {\n        return null;\n      }\n\n      if (message.type === 'message.date') {\n        return null;\n      }\n\n      if (message.deleted_at) {\n        return null;\n      }\n\n      if (this.props.editing) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__message-team str-chat__message-team--\".concat(groupStyles[0], \" str-chat__message-team--editing\"),\n          onMouseLeave: this.onMouseLeaveMessage\n        }, (groupStyles[0] === 'top' || groupStyles[0] === 'single') && React.createElement(\"div\", {\n          className: \"str-chat__message-team-meta\"\n        }, React.createElement(Avatar, {\n          image: message.user.image,\n          name: message.user.name || message.user.id,\n          size: 40\n        })), React.createElement(MessageInput, {\n          Input: EditMessageForm,\n          message: this.props.message,\n          clearEditingState: this.props.clearEditingState,\n          updateMessage: this.props.updateMessage\n        }));\n      }\n\n      return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        className: \"str-chat__message-livestream str-chat__message-livestream--\".concat(groupStyles[0], \" str-chat__message-livestream--\").concat(message.type, \" str-chat__message-livestream--\").concat(message.status, \" \").concat(this.props.initialMessage ? 'str-chat__message-livestream--initial-message' : ''),\n        onMouseLeave: this.onMouseLeaveMessage\n      }, this.state.reactionSelectorOpen && React.createElement(ReactionSelector, {\n        mine: this.props.mine,\n        reverse: false,\n        handleReaction: this.props.handleReaction,\n        actionsEnabled: this.props.actionsEnabled,\n        detailedView: true,\n        latest_reactions: message.latest_reactions,\n        reaction_counts: message.reaction_counts,\n        messageList: this.props.messageListRect,\n        ref: this.reactionSelectorRef\n      }), !this.props.initialMessage && message.type !== 'error' && React.createElement(\"div\", {\n        className: \"str-chat__message-livestream-actions\"\n      }, React.createElement(\"span\", {\n        className: \"str-chat__message-livestream-time\"\n      }, moment(message.created_at).format('h:mmA')), React.createElement(\"span\", {\n        onClick: this.onClickReactionsAction\n      }, React.createElement(\"span\", {\n        dangerouslySetInnerHTML: {\n          __html: reactionSvg\n        }\n      })), !this.props.threadList && React.createElement(\"span\", {\n        dangerouslySetInnerHTML: {\n          __html: threadSvg\n        },\n        onClick: function onClick(e) {\n          return _this2.props.openThread(e, message);\n        }\n      }), React.createElement(\"span\", {\n        onClick: this.onClickOptionsAction\n      }, React.createElement(\"span\", {\n        dangerouslySetInnerHTML: {\n          __html: optionsSvg\n        }\n      }), React.createElement(MessageActionsBox, {\n        open: this.state.actionsBoxOpen,\n        Message: this.props.Message,\n        message: this.props.message,\n        messageListRect: this.props.messageListRect,\n        mine: this.props.Message.isMyMessage(this.props.message)\n      }))), React.createElement(\"div\", {\n        className: \"str-chat__message-livestream-left\"\n      }, React.createElement(Avatar, {\n        image: message.user.image,\n        name: message.user.name || message.user.id,\n        size: 30\n      })), React.createElement(\"div\", {\n        className: \"str-chat__message-livestream-right\"\n      }, React.createElement(\"div\", {\n        className: \"str-chat__message-livestream-content\"\n      }, React.createElement(\"div\", {\n        className: \"str-chat__message-livestream-author\"\n      }, React.createElement(\"strong\", null, message.user.name || message.user.id), message.type === 'error' && React.createElement(\"div\", {\n        className: \"str-chat__message-team-error-header\"\n      }, \"Only visible to you\")), React.createElement(\"div\", {\n        className: isOnlyEmojis(message.text) ? 'str-chat__message-livestream-text--is-emoji' : ''\n      }, message.type !== 'error' && message.status !== 'failed' && renderText(message.text), message.type === 'error' && !message.command && React.createElement(\"p\", null, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M7 0a7 7 0 1 0 0 14A7 7 0 0 0 7 0zm.875 10.938a.438.438 0 0 1-.438.437h-.875a.438.438 0 0 1-.437-.438v-.874c0-.242.196-.438.438-.438h.875c.241 0 .437.196.437.438v.874zm0-2.626a.438.438 0 0 1-.438.438h-.875a.438.438 0 0 1-.437-.438v-5.25c0-.241.196-.437.438-.437h.875c.241 0 .437.196.437.438v5.25z\",\n        fill: \"#EA152F\",\n        fillRule: \"evenodd\"\n      })), message.text), message.type === 'error' && message.command && React.createElement(\"p\", null, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M7 0a7 7 0 1 0 0 14A7 7 0 0 0 7 0zm.875 10.938a.438.438 0 0 1-.438.437h-.875a.438.438 0 0 1-.437-.438v-.874c0-.242.196-.438.438-.438h.875c.241 0 .437.196.437.438v.874zm0-2.626a.438.438 0 0 1-.438.438h-.875a.438.438 0 0 1-.437-.438v-5.25c0-.241.196-.437.438-.437h.875c.241 0 .437.196.437.438v5.25z\",\n        fill: \"#EA152F\",\n        fillRule: \"evenodd\"\n      })), React.createElement(\"strong\", null, \"/\", message.command), \" is not a valid command\"), message.status === 'failed' && React.createElement(\"p\", {\n        onClick: this.props.handleRetry.bind(this, this.props.message)\n      }, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M7 0a7 7 0 1 0 0 14A7 7 0 0 0 7 0zm.875 10.938a.438.438 0 0 1-.438.437h-.875a.438.438 0 0 1-.437-.438v-.874c0-.242.196-.438.438-.438h.875c.241 0 .437.196.437.438v.874zm0-2.626a.438.438 0 0 1-.438.438h-.875a.438.438 0 0 1-.437-.438v-5.25c0-.241.196-.437.438-.437h.875c.241 0 .437.196.437.438v5.25z\",\n        fill: \"#EA152F\",\n        fillRule: \"evenodd\"\n      })), \"Message failed. Click to try again.\")), hasAttachment && attachments.map(function (attachment, index) {\n        return React.createElement(Attachment$$1, {\n          key: \"\".concat(message.id, \"-\").concat(index),\n          attachment: attachment,\n          actionHandler: _this2.props.handleAction\n        });\n      }), galleryImages.length !== 0 && React.createElement(Gallery, {\n        images: galleryImages\n      }), React.createElement(SimpleReactionsList, {\n        reaction_counts: message.reaction_counts,\n        reactions: this.props.message.latest_reactions,\n        handleReaction: this.props.handleReaction\n      }), !this.props.initialMessage && React.createElement(MessageRepliesCountButton, {\n        onClick: this.props.openThread,\n        reply_count: message.reply_count\n      })))));\n    }\n  }]);\n\n  return MessageLivestream;\n}(React.PureComponent);\n\n_defineProperty(MessageLivestream, \"propTypes\", {\n  /** The message object */\n  message: PropTypes.object,\n\n  /** The attachment component */\n  Attachment: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** The message component, most logic is delegated to this component */\n  Message: PropTypes.oneOfType([PropTypes.node, PropTypes.func, PropTypes.object]).isRequired\n});\n\n_defineProperty(MessageLivestream, \"defaultProps\", {\n  Attachment: Attachment\n});\n\nvar reactionSvg$1 = '<svg width=\"14\" height=\"14\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.108 8.05a.496.496 0 0 1 .212.667C10.581 10.147 8.886 11 7 11c-1.933 0-3.673-.882-4.33-2.302a.497.497 0 0 1 .9-.417C4.068 9.357 5.446 10 7 10c1.519 0 2.869-.633 3.44-1.738a.495.495 0 0 1 .668-.212zm.792-1.826a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.298 0-.431.168-.54.307A.534.534 0 0 1 9.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zm-7 0a.477.477 0 0 1-.119.692.541.541 0 0 1-.31.084.534.534 0 0 1-.428-.194c-.106-.138-.238-.306-.539-.306-.299 0-.432.168-.54.307A.533.533 0 0 1 2.538 7a.544.544 0 0 1-.31-.084.463.463 0 0 1-.117-.694c.33-.423.742-.722 1.394-.722.653 0 1.068.3 1.396.724zM7 0a7 7 0 1 1 0 14A7 7 0 0 1 7 0zm4.243 11.243A5.96 5.96 0 0 0 13 7a5.96 5.96 0 0 0-1.757-4.243A5.96 5.96 0 0 0 7 1a5.96 5.96 0 0 0-4.243 1.757A5.96 5.96 0 0 0 1 7a5.96 5.96 0 0 0 1.757 4.243A5.96 5.96 0 0 0 7 13a5.96 5.96 0 0 0 4.243-1.757z\" fillRule=\"evenodd\"/></svg>';\nvar threadSvg$1 = '<svg width=\"14\" height=\"10\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M8.516 3c4.78 0 4.972 6.5 4.972 6.5-1.6-2.906-2.847-3.184-4.972-3.184v2.872L3.772 4.994 8.516.5V3zM.484 5l4.5-4.237v1.78L2.416 5l2.568 2.125v1.828L.484 5z\" fillRule=\"evenodd\" /></svg>';\nvar optionsSvg$1 = '<svg width=\"11\" height=\"3\" viewBox=\"0 0 11 3\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z\" fillRule=\"nonzero\" /></svg>';\n/**\n * MessageTeam - Render component, should be used together with the Message component\n * Implements the look and feel for a team style collaboration environment\n *\n * @example ./docs/MessageTeam.md\n * @extends PureComponent\n */\n\nvar MessageTeam =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(MessageTeam, _PureComponent);\n\n  function MessageTeam() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MessageTeam);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MessageTeam)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      actionsBoxOpen: false,\n      reactionSelectorOpen: false\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"reactionSelectorRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"editMessageFormRef\", React.createRef());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onClickReactionsAction\", function () {\n      _this.setState({\n        reactionSelectorOpen: true\n      }, function () {\n        return document.addEventListener('click', _this.hideReactions, false);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onClickOptionsAction\", function () {\n      _this.setState({\n        actionsBoxOpen: true\n      }, function () {\n        return document.addEventListener('click', _this.hideOptions, false);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"hideOptions\", function () {\n      _this.setState({\n        actionsBoxOpen: false\n      });\n\n      document.removeEventListener('click', _this.hideOptions, false);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"hideReactions\", function (e) {\n      if (!_this.reactionSelectorRef.current.reactionSelector.current.contains(e.target)) {\n        _this.setState({\n          reactionSelectorOpen: false\n        });\n\n        document.removeEventListener('click', _this.hideReactions, false);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onMouseLeaveMessage\", function () {\n      _this.hideOptions();\n\n      _this.setState({\n        reactionSelectorOpen: false\n      }, function () {\n        return document.removeEventListener('click', _this.hideReactions, false);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"formatArray\", function (arr) {\n      var outStr = '';\n      var slicedArr = arr.map(function (item) {\n        return item.name || item.id;\n      }).slice(0, 5);\n      var restLength = arr.length - slicedArr.length;\n      var lastStr = restLength > 0 ? ' and ' + restLength + ' more' : '';\n\n      if (slicedArr.length === 1) {\n        outStr = slicedArr[0] + ' ';\n      } else if (slicedArr.length === 2) {\n        //joins all with \"and\" but =no commas\n        //example: \"bob and sam\"\n        outStr = slicedArr.join(' and ') + ' ';\n      } else if (slicedArr.length > 2) {\n        //joins all with commas, but last one gets \", and\" (oxford comma!)\n        //example: \"bob, joe, and sam\"\n        outStr = slicedArr.join(', ') + lastStr;\n      }\n\n      return outStr;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderStatus\", function () {\n      var message = _this.props;\n\n      if (!_this.isMine() || message.type === 'error') {\n        return null;\n      }\n\n      var justReadByMe = message.readBy.length === 1 && message.readBy[0].id === _this.props.client.user.id;\n\n      if (_this.props.message.status === 'sending') {\n        return React.createElement(\"span\", {\n          className: \"str-chat__message-team-status\"\n        }, React.createElement(Tooltip, null, \"Sending...\"), React.createElement(LoadingIndicator, {\n          isLoading: true\n        }));\n      } else if (message.readBy.length !== 0 && !_this.props.threadList && !justReadByMe) {\n        return React.createElement(\"span\", {\n          className: \"str-chat__message-team-status\"\n        }, React.createElement(Tooltip, null, _this.formatArray(message.readBy)), React.createElement(Avatar, {\n          name: _this.props.readBy[0].id,\n          image: _this.props.readBy[0].image,\n          size: 15\n        }), message.readBy.length > 1 && React.createElement(\"span\", {\n          className: \"str-chat__message-team-status-number\"\n        }, message.readBy.length));\n      } else if (_this.props.message.status === 'received' && _this.props.message.id === _this.props.lastReceivedId && !_this.props.threadList) {\n        return React.createElement(\"span\", {\n          className: \"str-chat__message-team-status\"\n        }, React.createElement(Tooltip, null, \"Delivered\"), React.createElement(\"svg\", {\n          width: \"16\",\n          height: \"16\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"path\", {\n          d: \"M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm3.72 6.633a.955.955 0 1 0-1.352-1.352L6.986 8.663 5.633 7.31A.956.956 0 1 0 4.28 8.663l2.029 2.028a.956.956 0 0 0 1.353 0l4.058-4.058z\",\n          fill: \"#006CFF\",\n          fillRule: \"evenodd\"\n        })));\n      } else {\n        return null;\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(MessageTeam, [{\n    key: \"isMine\",\n    value: function isMine() {\n      return this.props.Message.isMyMessage(this.props.message);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener('click', this.hideOptions, false);\n      document.removeEventListener('click', this.hideReactions, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          message = _this$props.message,\n          groupStyles = _this$props.groupStyles;\n\n      if (message.type === 'message.read') {\n        return null;\n      }\n\n      var hasAttachment = Boolean(message.attachments && message.attachments.length);\n      var Attachment$$1 = this.props.Attachment;\n\n      if (message.deleted_at) {\n        return null;\n      }\n\n      var galleryImages = message.attachments && message.attachments.filter(function (item) {\n        return item.type === 'image';\n      });\n      var attachments = message.attachments;\n\n      if (galleryImages && galleryImages.length > 1) {\n        attachments = message.attachments.filter(function (item) {\n          return item.type !== 'image';\n        });\n      } else {\n        galleryImages = [];\n      } // determine reaction selector alignment\n\n\n      var reactionDirection = 'left';\n\n      if (this.props.editing) {\n        return React.createElement(\"div\", {\n          className: \"str-chat__message-team str-chat__message-team--\".concat(groupStyles[0], \" str-chat__message-team--editing\"),\n          onMouseLeave: this.onMouseLeaveMessage\n        }, (groupStyles[0] === 'top' || groupStyles[0] === 'single') && React.createElement(\"div\", {\n          className: \"str-chat__message-team-meta\"\n        }, React.createElement(Avatar, {\n          image: message.user.image,\n          name: message.user.name || message.user.id,\n          size: 40\n        })), React.createElement(MessageInput, {\n          Input: EditMessageForm,\n          message: this.props.message,\n          clearEditingState: this.props.clearEditingState,\n          updateMessage: this.props.updateMessage\n        }));\n      }\n\n      return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        className: \"str-chat__message-team str-chat__message-team--\".concat(groupStyles[0], \" str-chat__message-team--\").concat(message.type, \" \").concat(this.props.threadList ? 'thread-list' : '', \" str-chat__message-team--\").concat(message.status),\n        onMouseLeave: this.onMouseLeaveMessage\n      }, React.createElement(\"div\", {\n        className: \"str-chat__message-team-meta\"\n      }, groupStyles[0] === 'top' || groupStyles[0] === 'single' || this.props.initialMessage ? React.createElement(Avatar, {\n        image: message.user.image,\n        name: message.user.name || message.user.id,\n        size: 40\n      }) : React.createElement(\"div\", {\n        style: {\n          width: 40,\n          marginRight: 0\n        }\n      }), React.createElement(\"time\", {\n        dateTime: message.created_at,\n        title: message.created_at\n      }, Boolean(Date.parse(message.created_at)) && moment(message.created_at).format('h:mmA'))), React.createElement(\"div\", {\n        className: \"str-chat__message-team-group\"\n      }, (groupStyles[0] === 'top' || groupStyles[0] === 'single' || this.props.initialMessage) && React.createElement(\"div\", {\n        className: \"str-chat__message-team-author\"\n      }, React.createElement(\"strong\", null, message.user.name || message.user.id), message.type === 'error' && React.createElement(\"div\", {\n        className: \"str-chat__message-team-error-header\"\n      }, \"Only visible to you\")), React.createElement(\"div\", {\n        className: \"str-chat__message-team-content str-chat__message-team-content--\".concat(groupStyles[0], \" str-chat__message-team-content--\").concat(message.text === '' ? 'image' : 'text')\n      }, !this.props.initialMessage && message.status !== 'sending' && message.status !== 'failed' && message.type !== 'error' && React.createElement(\"div\", {\n        className: \"str-chat__message-team-actions\"\n      }, this.state.reactionSelectorOpen && React.createElement(ReactionSelector, {\n        handleReaction: this.props.handleReaction,\n        latest_reactions: message.latest_reactions,\n        reaction_counts: message.reaction_counts,\n        detailedView: true,\n        direction: reactionDirection,\n        ref: this.reactionSelectorRef\n      }), React.createElement(\"span\", {\n        title: \"Reactions\",\n        dangerouslySetInnerHTML: {\n          __html: reactionSvg$1\n        },\n        onClick: this.onClickReactionsAction\n      }), !this.props.threadList && React.createElement(\"span\", {\n        title: \"Start a thread\",\n        dangerouslySetInnerHTML: {\n          __html: threadSvg$1\n        },\n        onClick: function onClick(e) {\n          return _this2.props.openThread(e, message);\n        }\n      }), React.createElement(\"span\", {\n        onClick: this.onClickOptionsAction\n      }, React.createElement(\"span\", {\n        title: \"Message actions\",\n        dangerouslySetInnerHTML: {\n          __html: optionsSvg$1\n        }\n      }), React.createElement(MessageActionsBox, {\n        Message: this.props.Message,\n        open: this.state.actionsBoxOpen,\n        message: this.props.message,\n        messageListRect: this.props.messageListRect,\n        mine: this.props.Message.isMyMessage(this.props.message)\n      }))), React.createElement(\"span\", {\n        className: isOnlyEmojis(message.text) ? 'str-chat__message-team-text--is-emoji' : ''\n      }, renderText(message.text)), galleryImages.length !== 0 && React.createElement(Gallery, {\n        images: galleryImages\n      }), message.text === '' && attachments.map(function (attachment, index) {\n        return React.createElement(Attachment$$1, {\n          key: \"\".concat(message.id, \"-\").concat(index),\n          attachment: attachment,\n          actionHandler: _this2.props.handleAction\n        });\n      }), message.latest_reactions && message.latest_reactions.length !== 0 && message.text !== '' && React.createElement(SimpleReactionsList, {\n        reaction_counts: message.reaction_counts,\n        handleReaction: this.props.handleReaction,\n        reactions: message.latest_reactions\n      }), message.status === 'failed' && React.createElement(\"button\", {\n        className: \"str-chat__message-team-failed\",\n        onClick: this.props.handleRetry.bind(this, this.props.message)\n      }, React.createElement(\"svg\", {\n        width: \"14\",\n        height: \"14\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M7 0a7 7 0 1 0 0 14A7 7 0 0 0 7 0zm.875 10.938a.438.438 0 0 1-.438.437h-.875a.438.438 0 0 1-.437-.438v-.874c0-.242.196-.438.438-.438h.875c.241 0 .437.196.437.438v.874zm0-2.626a.438.438 0 0 1-.438.438h-.875a.438.438 0 0 1-.437-.438v-5.25c0-.241.196-.437.438-.437h.875c.241 0 .437.196.437.438v5.25z\",\n        fill: \"#EA152F\",\n        fillRule: \"evenodd\"\n      })), \"Message failed. Click to try again.\")), this.renderStatus(), message.text !== '' && hasAttachment && attachments.map(function (attachment, index) {\n        return React.createElement(Attachment$$1, {\n          key: \"\".concat(message.id, \"-\").concat(index),\n          attachment: attachment,\n          actionHandler: _this2.props.handleAction\n        });\n      }), message.latest_reactions && message.latest_reactions.length !== 0 && message.text === '' && React.createElement(SimpleReactionsList, {\n        reaction_counts: message.reaction_counts,\n        handleReaction: this.props.handleReaction,\n        reactions: message.latest_reactions\n      }), !this.props.threadList && React.createElement(MessageRepliesCountButton, {\n        onClick: this.props.openThread,\n        reply_count: message.reply_count\n      }))));\n    }\n  }]);\n\n  return MessageTeam;\n}(PureComponent);\n\n_defineProperty(MessageTeam, \"propTypes\", {\n  /** The message object */\n  message: PropTypes.object,\n\n  /** The attachment component */\n  Attachment: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** The message component, most logic is delegated to this component */\n  Message: PropTypes.oneOfType([PropTypes.node, PropTypes.func, PropTypes.object]).isRequired,\n  groupStyles: PropTypes.array\n});\n\n_defineProperty(MessageTeam, \"defaultProps\", {\n  Attachment: Attachment,\n  groupStyles: ['single']\n});\n/**\n * Thread - The Thread renders a parent message with a list of replies. Use the stnadard message list of the main channel's messages.\n * The thread is only used for the list of replies to a message.\n *\n * @example ./docs/Thread.md\n * @extends Component\n */\n\n\nvar Thread =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Thread, _React$PureComponent);\n\n  function Thread() {\n    _classCallCheck(this, Thread);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Thread).apply(this, arguments));\n  }\n\n  _createClass(Thread, [{\n    key: \"render\",\n    value: function render() {\n      if (!this.props.thread) {\n        return null;\n      }\n\n      var parentID = this.props.thread.id;\n      var cid = this.props.channel.cid;\n      var key = \"thread-\".concat(parentID, \"-\").concat(cid); // We use a wrapper to make sure the key variable is set.\n      // this ensures that if you switch thread the component is recreated\n\n      return React.createElement(ThreadInner, _extends({}, this.props, {\n        key: key\n      }));\n    }\n  }]);\n\n  return Thread;\n}(React.PureComponent);\n\n_defineProperty(Thread, \"propTypes\", {\n  /** Channel is passed via the Channel Context */\n  channel: PropTypes.object.isRequired,\n\n  /** the thread (the parent message object) */\n  thread: PropTypes.oneOfType([PropTypes.object, PropTypes.bool]),\n\n  /** The message component to use for rendering messages */\n  Message: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /** The list of messages to render, state is handled by the parent channel component */\n  threadMessages: PropTypes.array.isRequired,\n\n  /** loadMoreThread iss called when infinite scroll wants to load more messages */\n  loadMoreThread: PropTypes.func.isRequired,\n\n  /** If there are more messages available, set to false when the end of pagination is reached */\n  threadHasMore: PropTypes.bool,\n\n  /** If the thread is currently loading more messages */\n  threadLoadingMore: PropTypes.bool,\n\n  /** Display the thread on 100% width of it's container. Useful for mobile style view */\n  fullWidth: PropTypes.bool,\n\n  /** Make input focus on mounting thread */\n  autoFocus: PropTypes.bool\n});\n\n_defineProperty(Thread, \"defaultProps\", {\n  threadHasMore: true,\n  threadLoadingMore: true,\n  fullWidth: false,\n  autoFocus: true\n});\n\nvar ThreadInner =\n/*#__PURE__*/\nfunction (_React$PureComponent2) {\n  _inherits(ThreadInner, _React$PureComponent2);\n\n  function ThreadInner(props) {\n    var _this;\n\n    _classCallCheck(this, ThreadInner);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ThreadInner).call(this, props));\n    _this.messageList = React.createRef();\n    return _this;\n  }\n\n  _createClass(ThreadInner, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var parentID;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                parentID = this.props.thread.id;\n\n                if (!(parentID && this.props.thread.reply_count)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _context.next = 4;\n                return this.props.loadMoreThread();\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"getSnapshotBeforeUpdate\",\n    value: function getSnapshotBeforeUpdate(prevProps) {\n      // Are we adding new items to the list?\n      // Capture the scroll position so we can adjust scroll later.\n      if (prevProps.threadMessages.length < this.props.threadMessages.length) {\n        var list = this.messageList.current;\n        var pos = list.scrollHeight - list.scrollTop;\n        return pos;\n      }\n\n      return null;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      // If we have a snapshot value, we've just added new items.\n      // Adjust scroll so these new items don't push the old ones out of view.\n      // (snapshot here is the value returned from getSnapshotBeforeUpdate)\n      if (snapshot !== null) {\n        var list = this.messageList.current;\n\n        var scrollDown = function scrollDown() {\n          list.scrollTop = list.scrollHeight - snapshot;\n        };\n\n        scrollDown(); // scroll down after images load again\n\n        setTimeout(scrollDown, 100);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (!this.props.thread) {\n        return null;\n      }\n\n      var read = {};\n      return React.createElement(\"div\", {\n        className: \"str-chat__thread \".concat(this.props.fullWidth ? 'str-chat__thread--full' : '')\n      }, React.createElement(\"div\", {\n        className: \"str-chat__thread-header\"\n      }, React.createElement(\"div\", {\n        className: \"str-chat__thread-header-details\"\n      }, React.createElement(\"strong\", null, \"Thread\"), React.createElement(\"small\", null, this.props.thread.reply_count, \" replies\")), React.createElement(\"button\", {\n        onClick: function onClick(e) {\n          return _this2.props.closeThread(e);\n        },\n        className: \"str-chat__square-button\"\n      }, React.createElement(\"svg\", {\n        width: \"10\",\n        height: \"10\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React.createElement(\"path\", {\n        d: \"M9.916 1.027L8.973.084 5 4.058 1.027.084l-.943.943L4.058 5 .084 8.973l.943.943L5 5.942l3.973 3.974.943-.943L5.942 5z\",\n        fillRule: \"evenodd\"\n      })))), React.createElement(\"div\", {\n        className: \"str-chat__thread-list\",\n        ref: this.messageList\n      }, React.createElement(Message, _extends({\n        message: this.props.thread,\n        initialMessage: true,\n        threadList: true,\n        Message: this.props.Message\n      }, this.props)), React.createElement(\"div\", {\n        className: \"str-chat__thread-start\"\n      }, \"Start of a new thread\"), React.createElement(MessageList, {\n        messages: this.props.threadMessages,\n        read: read,\n        threadList: true,\n        loadMore: this.props.loadMoreThread,\n        hasMore: this.props.threadHasMore,\n        loadingMore: this.props.threadLoadingMore,\n        Message: this.props.Message\n      }), React.createElement(MessageInput, {\n        Input: MessageInputSmall,\n        parent: this.props.thread,\n        focus: this.props.autoFocus\n      })));\n    }\n  }]);\n\n  return ThreadInner;\n}(React.PureComponent);\n\n_defineProperty(ThreadInner, \"propTypes\", {\n  /** Channel is passed via the Channel Context */\n  channel: PropTypes.object.isRequired,\n\n  /** the thread (just a message) that we're rendering */\n  thread: PropTypes.object.isRequired\n});\n\nThread = withChannelContext(Thread);\n\nvar TypingIndicator =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(TypingIndicator, _React$PureComponent);\n\n  function TypingIndicator() {\n    _classCallCheck(this, TypingIndicator);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(TypingIndicator).apply(this, arguments));\n  }\n\n  _createClass(TypingIndicator, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this; // if (Object.keys(this.props.typing).length <= 0) {\n      //   return null;\n      // }\n\n\n      var typing = Object.values(this.props.typing);\n      var show;\n\n      if (typing.length === 0 || typing.length === 1 && typing[0].user.id === this.props.client.user.id) {\n        show = false;\n      } else {\n        show = true;\n      }\n\n      return React.createElement(\"div\", {\n        className: \"str-chat__typing-indicator \".concat(show ? 'str-chat__typing-indicator--typing' : '')\n      }, React.createElement(\"div\", {\n        className: \"str-chat__typing-indicator__avatars\"\n      }, typing.filter(function (_ref) {\n        var user = _ref.user;\n        return user.id !== _this.props.client.user.id;\n      }).map(function (_ref2) {\n        var user = _ref2.user;\n        return React.createElement(Avatar, {\n          image: user.image,\n          size: 32,\n          name: user.name || user.id,\n          key: user.id\n        });\n      })), React.createElement(\"div\", {\n        className: \"str-chat__typing-indicator__dots\"\n      }, React.createElement(\"span\", {\n        className: \"str-chat__typing-indicator__dot\"\n      }), React.createElement(\"span\", {\n        className: \"str-chat__typing-indicator__dot\"\n      }), React.createElement(\"span\", {\n        className: \"str-chat__typing-indicator__dot\"\n      })));\n    }\n  }]);\n\n  return TypingIndicator;\n}(React.PureComponent);\n/**\n * Window - A UI component for conditionally displaying thread or channel.\n *\n * @example ./docs/Window.md\n * @extends PureComponent\n */\n\n\nvar Window =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Window, _React$PureComponent);\n\n  function Window() {\n    _classCallCheck(this, Window);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Window).apply(this, arguments));\n  }\n\n  _createClass(Window, [{\n    key: \"render\",\n    value: function render() {\n      // If thread is active and window should hide on thread. Return null\n      if (this.props.thread && this.props.hideOnThread) {\n        return null;\n      }\n\n      return React.createElement(\"div\", {\n        className: \"str-chat__main-panel\"\n      }, this.props.children);\n    }\n  }]);\n\n  return Window;\n}(React.PureComponent);\n\n_defineProperty(Window, \"propTypes\", {\n  /** show or hide the window when a thread is active */\n  hideOnThread: PropTypes.bool,\n\n  /** Flag if thread is open or not */\n  thread: PropTypes.oneOfType([PropTypes.bool, PropTypes.object])\n});\n\n_defineProperty(Window, \"defaultProps\", {\n  hideOnThread: false\n});\n\nWindow = withChannelContext(Window); // Setup\n\nexport { Avatar, MessageList, Chat, Channel, ChannelHeader, MessageInput, MessageInputLarge, MessageInputFlat, MessageInputSmall, Attachment, ChannelList, ChannelListMessenger, ChannelListTeam, ChannelPreviewCompact, ChannelPreviewMessenger, LoadingIndicator, MessageCommerce, MessageLivestream, MessageTeam, MessageSimple, Thread, TypingIndicator, Window, emojiSetDef, commonEmoji, defaultMinimalEmojis, emojiData, isOnlyEmojis, isPromise, byDate, formatArray, renderText, generateRandomId, ChatContext, withChatContext, ChannelContext, withChannelContext };","map":null,"metadata":{},"sourceType":"module"}