/**
 * The MIT License (MIT)
 *
 * Copyright (c) 2017 Jakub Beneš <benes@webscope.io>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):e.ReactTextareaAutocomplete=t(e.React)}(this,function(P){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)})(e)}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}P=P&&P.hasOwnProperty("default")?P.default:P;var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var u,E=(function(e){var u,p,f;u=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],p="undefined"!=typeof window,f=p&&null!=window.mozInnerScreenX,e.exports=function(e,t,n){if(!p)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var r=n&&n.debug||!1;if(r){var o=document.querySelector("#input-textarea-caret-position-mirror-div");o&&o.parentNode.removeChild(o)}var a=document.createElement("div");a.id="input-textarea-caret-position-mirror-div",document.body.appendChild(a);var i=a.style,s=window.getComputedStyle?getComputedStyle(e):e.currentStyle;i.whiteSpace="pre-wrap","INPUT"!==e.nodeName&&(i.wordWrap="break-word"),i.position="absolute",r||(i.visibility="hidden"),u.forEach(function(e){i[e]=s[e]}),f?e.scrollHeight>parseInt(s.height)&&(i.overflowY="scroll"):i.overflow="hidden",a.textContent=e.value.substring(0,t),"INPUT"===e.nodeName&&(a.textContent=a.textContent.replace(/\s/g," "));var l=document.createElement("span");l.textContent=e.value.substring(t)||".",a.appendChild(l);var c={top:l.offsetTop+parseInt(s.borderTopWidth),left:l.offsetLeft+parseInt(s.borderLeftWidth)};return r?l.style.backgroundColor="#aaa":document.body.removeChild(a),c}}(u={exports:{}},u.exports),u.exports),p=e.CustomEvent;var C=function(){try{var e=new p("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(e){}return!1}()?p:"undefined"!=typeof document&&"function"==typeof document.createEvent?function(e,t){var n=document.createEvent("CustomEvent");return t?n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):n.initCustomEvent(e,!1,!1,void 0),n}:function(e,t){var n=document.createEventObject();return n.type=e,n.detail=t?(n.bubbles=Boolean(t.bubbles),n.cancelable=Boolean(t.cancelable),t.detail):(n.bubbles=!1,void(n.cancelable=!1)),n},f={ESC:27,UP:38,DOWN:40,LEFT:37,RIGHT:39,ENTER:13,TAB:9},d=new function e(){var a=this;i(this,e),this.startListen=function(e){e&&e.addEventListener("keydown",a.f)},this.stopListen=function(e){e&&e.removeEventListener("keydown",a.f)},this.add=function(e,t){var n=e;return"object"!=typeof n&&(n=[n]),a.listeners[a.index]={keyCode:n,fn:t},a.index++},this.remove=function(e){delete a.listeners[e]},this.removeAll=function(){a.listeners={},a.index=1},this.index=1,this.listeners={},this.f=function(r){if(r){var o=r.keyCode||r.which;Object.values(a.listeners).forEach(function(e){var t=e.keyCode,n=e.fn;t.includes(o)&&(r.stopPropagation(),r.preventDefault(),n(r))})}}},g=function(e){function a(){var e,n;i(this,a);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(n=s(this,(e=l(a)).call.apply(e,[this].concat(r)))).selectItem=function(){var e=n.props,t=e.item;(0,e.onSelectHandler)(t)},n}return c(a,P.Component),n(a,[{key:"shouldComponentUpdate",value:function(e){return this.props.item!==e.item||this.props.selected!==e.selected||this.props.style!==e.style||this.props.className!==e.className}},{key:"render",value:function(){var t=this,e=this.props,n=e.component,r=e.style,o=e.onClickHandler,a=e.item,i=e.selected,s=e.className,l=e.innerRef;return P.createElement("li",{className:"rta__item ".concat(s||""),style:r},P.createElement("div",{className:"rta__entity ".concat(!0===i?"rta__entity--selected":""),role:"button",tabIndex:0,onClick:o,onFocus:this.selectItem,onMouseEnter:this.selectItem,onTouchStart:function(){t.clicked=!0,t.selectItem()},onTouchEnd:function(e){e.preventDefault(),t.clicked&&o(e)},onTouchMove:function(){t.clicked=!1},onTouchCancel:function(){t.clicked=!1},ref:l},P.createElement(n,{selected:i,entity:a})))}}]),a}(),I=function(e){function o(){var e,a;i(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(a=s(this,(e=l(o)).call.apply(e,[this].concat(n)))).state={selectedItem:null},a.onPressEnter=function(e){void 0!==e&&e.preventDefault();var t=a.props.values;a.modifyText(t[a.getPositionInList()])},a.getPositionInList=function(){var e=a.props.values,t=a.state.selectedItem;return t?e.findIndex(function(e){return a.getId(e)===a.getId(t)}):0},a.getId=function(e){var t=a.props.getTextToReplace(e);if(t){if(t.key)return t.key;if("string"==typeof e||!e.key)return t.text}if(!e.key)throw new Error("Item ".concat(JSON.stringify(e),' has to have defined "key" property'));return e.key},a.listeners=[],a.itemsRef={},a.modifyText=function(e){if(e){var t=a.props;(0,t.onSelect)((0,t.getTextToReplace)(e))}},a.selectItem=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];a.state.selectedItem!==e&&a.setState({selectedItem:e},function(){t&&a.props.dropdownScroll(a.itemsRef[a.getId(e)])})},a.scroll=function(e){e.preventDefault();var t,n=a.props.values,r=e.keyCode||e.which,o=a.getPositionInList();switch(r){case f.DOWN:t=o+1;break;case f.UP:t=o-1;break;default:t=o}t=(t%n.length+n.length)%n.length,a.selectItem(n[t],[f.DOWN,f.UP].includes(r))},a.isSelected=function(e){var t=a.state.selectedItem;return!!t&&a.getId(t)===a.getId(e)},a}return c(o,P.Component),n(o,[{key:"componentDidMount",value:function(){this.listeners.push(d.add([f.DOWN,f.UP],this.scroll),d.add([f.ENTER,f.TAB],this.onPressEnter));var e=this.props.values;e&&e[0]&&this.selectItem(e[0])}},{key:"componentDidUpdate",value:function(e){var t=this,n=e.values,r=this.props.values;n.map(function(e){return t.getId(e)}).join("")!==r.map(function(e){return t.getId(e)}).join("")&&r&&r[0]&&this.selectItem(r[0])}},{key:"componentWillUnmount",value:function(){for(var e;this.listeners.length;)e=this.listeners.pop(),d.remove(e)}},{key:"render",value:function(){var n=this,e=this.props,t=e.values,r=e.component,o=e.style,a=e.itemClassName,i=e.className,s=e.itemStyle;return P.createElement("ul",{className:"rta__list ".concat(i||""),style:o},t.map(function(t){return P.createElement(g,{key:n.getId(t),innerRef:function(e){n.itemsRef[n.getId(t)]=e},selected:n.isSelected(t),item:t,className:a,style:s,onClickHandler:n.onPressEnter,onSelectHandler:n.selectItem,component:r})}))}}]),o}();var h="next",v={LEFT:"rta__autocomplete--left",RIGHT:"rta__autocomplete--right"},y={TOP:"rta__autocomplete--top",BOTTOM:"rta__autocomplete--bottom"},R=function(e){return console.error("RTA: dataProvider fails: ".concat(e,"\n    \nCheck the documentation or create issue if you think it's bug. https://github.com/webscopeio/react-textarea-autocomplete/issues"))},O=function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return c(t,P.Component),n(t,[{key:"componentDidMount",value:function(){var e=this.props.boundariesElement;if("string"==typeof e){var t=document.querySelector(e);if(!t)throw new Error("RTA: Invalid prop boundariesElement: it has to be string or HTMLElement.");this.containerElem=t}else{if(!(e instanceof HTMLElement))throw new Error("RTA: Invalid prop boundariesElement: it has to be string or HTMLElement.");this.containerElem=e}if(!(this.containerElem&&this.containerElem.contains(this.ref)||"test"===process.env.NODE_ENV))throw new Error("RTA: Invalid prop boundariesElement: it has to be one of the parents of the RTA.")}},{key:"componentDidUpdate",value:function(){var e,t,n=this.props.top||0,r=this.props.left||0,o=[],a=[],i=0,s=0,l=this.containerElem.getBoundingClientRect(),c=this.ref.getBoundingClientRect(),u=this.props.textareaRef.getBoundingClientRect(),p=window.getComputedStyle(this.ref),f=parseInt(p.getPropertyValue("margin-top"),10),d=parseInt(p.getPropertyValue("margin-bottom"),10),g=parseInt(p.getPropertyValue("margin-left"),10),h=parseInt(p.getPropertyValue("margin-right"),10),m=f+d+u.top+n+c.height;g+h+u.left+r+c.width>l.right?(s=r-c.width,o.push(v.LEFT),a.push(v.RIGHT)):(s=r,o.push(v.RIGHT),a.push(v.LEFT)),m>l.bottom?(i=n-c.height,o.push(y.TOP),a.push(y.BOTTOM)):(i=n,o.push(y.BOTTOM),a.push(y.TOP)),this.ref.style.top="".concat(i,"px"),this.ref.style.left="".concat(s,"px"),(e=this.ref.classList).remove.apply(e,a),(t=this.ref.classList).add.apply(t,o)}},{key:"render",value:function(){var t=this,e=this.props,n=e.style,r=e.className,o=e.innerRef,a=e.children;return P.createElement("div",{ref:function(e){t.ref=e,o(e)},className:"rta__autocomplete ".concat(r||""),style:n},a)}}]),t}(),m=function(e){function a(e){var x;i(this,a),(x=s(this,l(a).call(this,e))).state={top:null,left:null,currentTrigger:null,actualToken:"",data:null,value:"",dataLoading:!1,selectionEnd:0,component:null,textToReplace:null},x.escListenerInit=function(){x.escListener||(x.escListener=d.add(f.ESC,x._closeAutocomplete))},x.escListenerDestroy=function(){x.escListener&&(d.remove(x.escListener),x.escListener=null)},x.getSelectionPosition=function(){return x.textareaRef?{selectionStart:x.textareaRef.selectionStart,selectionEnd:x.textareaRef.selectionEnd}:null},x.getSelectedText=function(){if(!x.textareaRef)return null;var e=x.textareaRef,t=e.selectionStart,n=e.selectionEnd;return t===n?null:x.state.value.substr(t,n-t)},x.setCaretPosition=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;x.textareaRef&&(x.textareaRef.focus(),x.textareaRef.setSelectionRange(e,e))},x.getCaretPosition=function(){return x.textareaRef?x.textareaRef.selectionEnd:0},x._handleCaretChange=function(e){if("keydown"!==e.type)x.lastTrigger=x.getCaretPosition()-1;else switch(e.keyCode||e.which){case f.UP:case f.DOWN:x._isAutocompleteOpen()||(x.lastTrigger=x.getCaretPosition()-1);break;case f.LEFT:case f.RIGHT:x.lastTrigger=x.getCaretPosition()-1}},x._onSelect=function(e){var t=x.state,n=t.selectionEnd,r=t.currentTrigger,o=t.value,a=x.props.trigger;if(e){if(r){var i=o.slice(0,n),s=i.search(new RegExp("\\".concat(r,"[^\\".concat(r).concat(a[r].allowWhitespace?"":"\\s","]"),"*$"))),l="next"===e.caretPosition?"".concat(e.text," "):e.text,c=function(e,t,n){switch(e){case"start":return n;case"next":case"end":return n+t.length;default:if(!Number.isInteger(e))throw new Error('RTA: caretPosition should be "start", "next", "end" or number.');return e}}(e.caretPosition,l,s),u=i.substring(0,s)+l,p=o.replace(i,u);x.setState({value:p,dataLoading:!1},function(){var e=x.tokenRegExpEnding.exec(l),t=e?e[0].length:1;x.lastTrigger=c-t,x.textareaRef.value=p,x.textareaRef.selectionEnd=c,x._changeHandler();var n=x.textareaRef.scrollTop;x.setCaretPosition(c),window.chrome&&(x.textareaRef.scrollTop=n)})}}else x._closeAutocomplete()},x._getTextToReplace=function(e){var n=e.actualToken,r=e.currentTrigger,t=x.props.trigger[r];if(!r||!t)return null;var o=t.output;return function(e){if("object"==typeof e&&(!o||"function"!=typeof o))throw new Error('Output functor is not defined! If you are using items as object you have to define "output" function. https://github.com/webscopeio/react-textarea-autocomplete#trigger-type');if(o){var t=o(e,r);if(void 0===t||"number"==typeof t)throw new Error('Output functor should return string or object in shape {text: string, caretPosition: string | number}.\nGot "'.concat(String(t),'". Check the implementation for trigger "').concat(r,'" and its token "').concat(n,'"\n\nSee https://github.com/webscopeio/react-textarea-autocomplete#trigger-type for more informations.\n'));if(null===t)return null;if("string"==typeof t)return{text:t,caretPosition:h};if(!t.text)throw new Error('Output "text" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger "'.concat(r,'" and its token "').concat(n,'"\n'));if(!t.caretPosition)throw new Error('Output "caretPosition" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger "'.concat(r,'" and its token "').concat(n,'"\n'));return t}if("string"!=typeof e)throw new Error("Output item should be string\n");return{text:"".concat(r).concat(e).concat(r),caretPosition:h}}},x._getCurrentTriggerSettings=function(){var e=x.state.currentTrigger;return e?x.props.trigger[e]:null},x._getValuesFromProvider=function(){var e=x.state,t=e.currentTrigger,n=e.actualToken,r=x._getCurrentTriggerSettings();if(t&&r){var o=r.dataProvider,a=r.component;if("function"!=typeof o)throw new Error("Trigger provider has to be a function!");x.setState({dataLoading:!0});var i=o(n);i instanceof Promise||(i=Promise.resolve(i)),i.then(function(e){if(!Array.isArray(e))throw new Error("Trigger provider has to provide an array!");if("function"!=typeof a)throw new Error("Component should be defined!");t===x.state.currentTrigger&&(e.length?x.setState({dataLoading:!1,data:e,component:a}):x._closeAutocomplete())}).catch(function(e){return R(e.message)})}},x._getSuggestions=function(){var e=x.state,t=e.currentTrigger,n=e.data;return!t||!n||n&&!n.length?null:n},x._createRegExp=function(){var e=x.props.trigger;x.tokenRegExp=new RegExp("(".concat(Object.keys(e).sort(function(e,t){return e<t?1:t<e?-1:0}).map(function(e){return"\\".concat(e)}).join("|"),")((?:(?!\\1)[^\\s])*$)")),x.tokenRegExpEnding=new RegExp("(".concat(Object.keys(e).sort(function(e,t){return e<t?1:t<e?-1:0}).map(function(e){return"\\".concat(e)}).join("|"),")$"))},x._closeAutocomplete=function(){x.escListenerDestroy(),x.setState({data:null,dataLoading:!1,currentTrigger:null})},x._cleanUpProps=function(){var e=function(o){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},t=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.forEach(function(e){var t,n,r;t=o,r=a[n=e],n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r})}return o}({},x.props),t=["loadingComponent","boundariesElement","containerStyle","minChar","scrollToItem","ref","innerRef","onChange","onCaretPositionChange","className","value","trigger","listStyle","itemStyle","containerStyle","loaderStyle","className","containerClassName","listClassName","itemClassName","loaderClassName","dropdownStyle","dropdownClassName","movePopupAsYouType","textAreaComponent"];for(var n in e)t.includes(n)&&delete e[n];return e},x._changeHandler=function(e){var t=x.props,n=t.trigger,r=t.onChange,o=t.minChar,a=t.onCaretPositionChange,i=t.movePopupAsYouType,s=x.state,l=s.top,c=s.left,u=e;u||(u=new C("change",{bubbles:!0}),x.textareaRef.dispatchEvent(u));var p=u.target,f=p.selectionEnd,d=p.value;(x.lastValueBubbledEvent=d,r&&u&&(u.persist&&u.persist(),r(u)),a)&&a(x.getCaretPosition());x.setState({value:d});var g=function(){var e=E(p,f),t=e.top,n=e.left;x.setState({top:t-x.textareaRef.scrollTop||0,left:n})},h=function(){x.lastTrigger=f-1,x._closeAutocomplete(),g()};f<=x.lastTrigger&&h();var m=d.slice(x.lastTrigger,f),v=x.tokenRegExp.exec(m),y=v&&v[0],b=v&&v[1]||null;if(x.tokenRegExpEnding.exec(m)?h():x._isAutocompleteOpen()||x._closeAutocomplete(),y&&!(y.length<=o)||(!x.state.currentTrigger||n[x.state.currentTrigger].allowWhitespace)&&x.state.currentTrigger)if(b&&n[b].afterWhitespace&&" "!==d[f-y.length-1]&&void 0!==d[f-y.length-1])x._closeAutocomplete();else{if(x.state.currentTrigger&&n[x.state.currentTrigger].allowWhitespace){if(v=new RegExp("\\".concat(x.state.currentTrigger,".*$")).exec(d.slice(0,f)),!(y=v&&v[0]))return void x._closeAutocomplete();b=Object.keys(n).find(function(e){return e===y[0]})||null}var T=y.slice(1);if(b){(i||null===l&&null===c||x.state.currentTrigger!==b)&&g(),x.escListenerInit();var w=x._getTextToReplace({actualToken:T,currentTrigger:b});x.setState({selectionEnd:f,currentTrigger:b,textToReplace:w,actualToken:T},function(){try{x._getValuesFromProvider()}catch(e){R(e.message)}})}}else x._closeAutocomplete()},x._selectHandler=function(e){var t=x.props,n=t.onCaretPositionChange,r=t.onSelect;n&&n(x.getCaretPosition());r&&(e.persist(),r(e))},x._onClickAndBlurHandler=function(e){var t=x.props.onBlur,n=e.relatedTarget;x.dropdownRef&&n instanceof Node&&x.dropdownRef.contains(n)||(x._closeAutocomplete(),t&&(e.persist(),t(e)))},x._onScrollHandler=function(){x._closeAutocomplete()},x._dropdownScroll=function(e){var t=x.props.scrollToItem;if(t){if(!0===t)return n=x.dropdownRef,r=e,o=parseInt(getComputedStyle(r).getPropertyValue("height"),10),a=parseInt(getComputedStyle(n).getPropertyValue("height"),10)-o,i=r.offsetTop,s=n.scrollTop,void(i<s+a&&s<i||(n.scrollTop=i));var n,r,o,a,i,s;if("function"!=typeof t||2!==t.length)throw new Error("`scrollToItem` has to be boolean (true for default implementation) or function with two parameters: container, item.");t(x.dropdownRef,e)}},x._isAutocompleteOpen=function(){var e=x.state,t=e.dataLoading,n=e.currentTrigger,r=x._getSuggestions();return!(!t&&!r||!n)},x._textareaRef=function(e){x.props.innerRef&&x.props.innerRef(e),x.textareaRef=e},x.lastTrigger=0,x.escListener=null;var t=x.props,n=t.loadingComponent,r=t.trigger,o=t.value;if(o&&(x.state.value=o),x._createRegExp(),!n)throw new Error("RTA: loadingComponent is not defined");if(!r)throw new Error("RTA: trigger is not defined");return x}return c(a,P.Component),n(a,[{key:"componentDidMount",value:function(){d.startListen(this.textareaRef),this.textareaRef&&this.textareaRef.addEventListener("focus",this._handleCaretChange),this.textareaRef&&this.textareaRef.addEventListener("click",this._handleCaretChange),this.textareaRef&&this.textareaRef.addEventListener("keydown",this._handleCaretChange)}},{key:"componentDidUpdate",value:function(e){var t=e.trigger,n=e.value,r=this.props,o=r.trigger,a=r.value;Object.keys(o).join("")!==Object.keys(t).join("")&&this._createRegExp(),n!==a&&this.lastValueBubbledEvent!==a&&(this.lastTrigger=0,this._changeHandler())}},{key:"componentWillUnmount",value:function(){this.escListenerDestroy(),d.stopListen(this.textareaRef),this.textareaRef&&this.textareaRef.removeEventListener("focus",this._handleCaretChange),this.textareaRef&&this.textareaRef.removeEventListener("click",this._handleCaretChange),this.textareaRef&&this.textareaRef.removeEventListener("keydown",this._handleCaretChange)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.loadingComponent,o=n.style,a=n.className,i=n.listStyle,s=n.itemStyle,l=n.boundariesElement,c=n.movePopupAsYouType,u=n.listClassName,p=n.itemClassName,f=n.dropdownClassName,d=n.dropdownStyle,g=n.containerStyle,h=n.containerClassName,m=n.loaderStyle,v=n.loaderClassName,y=n.textAreaComponent,b=this.state,T=b.left,w=b.top,x=b.dataLoading,E=b.component,C=b.value,R=b.textToReplace,S=this._isAutocompleteOpen(),_=this._getSuggestions(),k={};return y.component?(e=y.component,k[y.ref]=this._textareaRef):(e=y,k.ref=this._textareaRef),P.createElement("div",{className:"rta ".concat(!0===x?"rta--loading":""," ").concat(h||""),style:g},P.createElement(e,Object.assign({},this._cleanUpProps(),{className:"rta__textarea ".concat(a||""),onChange:this._changeHandler,onSelect:this._selectHandler,onScroll:this._onScrollHandler,onClick:this._onClickAndBlurHandler,onBlur:this._onClickAndBlurHandler,value:C,style:o},k)),S&&P.createElement(O,{innerRef:function(e){t.dropdownRef=e},top:w,left:T,style:d,className:f,movePopupAsYouType:c,boundariesElement:l,textareaRef:this.textareaRef},_&&E&&R&&P.createElement(I,{values:_,component:E,style:i,className:u,itemClassName:p,itemStyle:s,getTextToReplace:R,onSelect:this._onSelect,dropdownScroll:this._dropdownScroll}),x&&P.createElement("div",{className:"rta__loader ".concat(null!==_?"rta__loader--suggestion-data":"rta__loader--empty-suggestion-data"," ").concat(v||""),style:m},P.createElement(r,{data:_}))))}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.value;return null==t?null:{value:t}}}]),a}();return m.defaultProps={movePopupAsYouType:!1,value:null,minChar:1,boundariesElement:"body",scrollToItem:!0,textAreaComponent:"textarea"},m});
